"use strict";(self.webpackChunk_performant_software_storybook=self.webpackChunk_performant_software_storybook||[]).push([[7437],{"../semantic-ui/src/components/DataList.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{II:()=>SORT_DESCENDING,UC:()=>SORT_ASCENDING,ZP:()=>__WEBPACK_DEFAULT_EXPORT__});var _performant_software_shared_components__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../shared/build/index.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/index.js"),react_uuid__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/react-uuid/uuid.js"),react_uuid__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react_uuid__WEBPACK_IMPORTED_MODULE_2__),underscore__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/underscore/modules/index-all.js"),semantic_ui_react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/semantic-ui-react/dist/es/collections/Message/Message.js"),semantic_ui_react__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../node_modules/semantic-ui-react/dist/es/elements/Input/Input.js"),semantic_ui_react__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../node_modules/semantic-ui-react/dist/es/elements/Icon/Icon.js"),_i18n_i18n__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../semantic-ui/src/i18n/i18n.js"),_Toaster__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../semantic-ui/src/components/Toaster.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/react/jsx-runtime.js");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var SORT_ASCENDING="ascending",SORT_DESCENDING="descending";const __WEBPACK_DEFAULT_EXPORT__=function useDataList(WrappedComponent){var _class;return _class=function(_Component){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(_class,_Component);var _super=_createSuper(_class);function _class(props){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,_class),(_this=_super.call(this,props)).state=_this.initializeState(props),_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(_class,[{key:"componentDidMount",value:function componentDidMount(){this.props.polling&&(this.pollingInterval=setInterval(this.fetchData.bind(this),this.props.polling))}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){prevProps.saved!==this.props.saved&&this.props.saved&&this.setState({saved:this.props.saved},this.fetchData.bind(this))}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.pollingInterval&&clearInterval(this.pollingInterval)}},{key:"afterDelete",value:function afterDelete(){return 1===this.state.items.length?this.setState((function(state){return{page:state.page-1>1?state.page-1:1}}),this.fetchData.bind(this)):this.fetchData()}},{key:"afterDeleteAll",value:function afterDeleteAll(){this.setState({page:1},this.fetchData.bind(this))}},{key:"fetchData",value:function fetchData(){var _this2=this;this.setSession(),this.setState({loading:!0},(function(){var _this2$state=_this2.state,page=_this2$state.page,perPage=_this2$state.perPage,search=_this2$state.search,sortColumn=_this2$state.sortColumn,sortDirection=_this2$state.sortDirection,params=_objectSpread(_objectSpread({},_this2.state.filters),{},{page,search,per_page:perPage,sort_by:sortColumn,sort_direction:sortDirection});_this2.props.onLoad(params).then((function(_ref){var data=_ref.data,items=data[_this2.props.collectionName],_data$list=data.list,pages=_data$list.pages,count=_data$list.count;_this2.setState({count,items,page,pages,loading:!1})}))}))}},{key:"getDefaultFilters",value:function getDefaultFilters(props){var _this3=this,filters=[];return props.filters&&props.filters.defaults&&underscore__WEBPACK_IMPORTED_MODULE_3__.default.each(props.filters.defaults.filters,(function(f){var filter=underscore__WEBPACK_IMPORTED_MODULE_3__.default.findWhere(props.filters.props.filters,{key:f.key});filter&&filters.push(_this3.onCreateFilter(_objectSpread(_objectSpread({},filter),f)))})),{filters}}},{key:"getSessionKey",value:function getSessionKey(){return this.props.session?"".concat("DataList",".").concat(this.props.session.key):null}},{key:"initializeState",value:function initializeState(props){var session=this.restoreSession(),filters=session.filters||this.getDefaultFilters(props),page=session.page||1,perPage=session.perPage||props.defaultPerPage||underscore__WEBPACK_IMPORTED_MODULE_3__.default.first(props.perPageOptions),search=session.search||props.defaultSearch||null,sortColumn=session.sortColumn||props.defaultSort||null,sortDirection=session.sortDirection||props.defaultSortDirection||null;return{count:0,error:null,filters,items:[],loading:!1,page,pages:1,perPage,saved:props.saved||!1,search,sortColumn,sortDirection}}},{key:"isFilterActive",value:function isFilterActive(){var isActive=!1;return underscore__WEBPACK_IMPORTED_MODULE_3__.default.each(underscore__WEBPACK_IMPORTED_MODULE_3__.default.values(this.state.filters),(function(value){_performant_software_shared_components__WEBPACK_IMPORTED_MODULE_0__.Object.isEmpty(value)||(isActive=!0)})),isActive}},{key:"onClearSearch",value:function onClearSearch(e){var _this$searchRef;this.onSearchChange(e,{value:""}),null===(_this$searchRef=this.searchRef)||void 0===_this$searchRef||null===(_this$searchRef=_this$searchRef.inputRef)||void 0===_this$searchRef||null===(_this$searchRef=_this$searchRef.current)||void 0===_this$searchRef||_this$searchRef.focus(),this.onSearch()}},{key:"onCreateFilter",value:function onCreateFilter(filter){return _objectSpread(_objectSpread({},filter),{},{uid:react_uuid__WEBPACK_IMPORTED_MODULE_2___default()()})}},{key:"onDelete",value:function onDelete(selectedItem){return this.props.onDelete?this.props.onDelete(selectedItem).then(this.afterDelete.bind(this)).catch(this.onError.bind(this)):Promise.resolve()}},{key:"onDeleteAll",value:function onDeleteAll(){return this.props.onDeleteAll?this.props.onDeleteAll().then(this.afterDeleteAll.bind(this)):Promise.resolve()}},{key:"onError",value:function onError(error){return this.props.resolveErrors&&this.setState({error})}},{key:"onFilterChange",value:function onFilterChange(filters){var _this4=this;return new Promise((function(resolve){_this4.props.filters&&_this4.props.filters.onChange&&_this4.props.filters.onChange(filters),_this4.setState({filters,page:1},(function(){_this4.fetchData(),resolve()}))}))}},{key:"onPageChange",value:function onPageChange(e,_ref2){var activePage=_ref2.activePage;this.setState({page:activePage},this.fetchData.bind(this))}},{key:"onPerPageChange",value:function onPerPageChange(e,_ref3){var value=_ref3.value;this.setState({perPage:value},this.fetchData.bind(this))}},{key:"onSave",value:function onSave(item){var _this5=this;return this.props.onSave?Promise.resolve(this.props.onSave(item)).then((function(){return _this5.setState({saved:!0},_this5.fetchData.bind(_this5))})):Promise.resolve()}},{key:"onSearch",value:function onSearch(){this.setState({page:1},this.fetchData.bind(this))}},{key:"onSearchChange",value:function onSearchChange(e,_ref4){var value=_ref4.value;this.setState({search:value})}},{key:"onSort",value:function onSort(sortColumn,direction){var page=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,sortDirection=direction;sortDirection||(sortDirection=this.state.sortColumn===sortColumn&&this.state.sortDirection===SORT_ASCENDING?SORT_DESCENDING:SORT_ASCENDING),this.setState({sortColumn,sortDirection,page},this.fetchData.bind(this))}},{key:"onInit",value:function onInit(){var page=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.setState({sortColumn:"",sortDirection:"",page},this.fetchData.bind(this))}},{key:"render",value:function render(){var _this6=this,_this$props$filters=this.props.filters,filters=void 0===_this$props$filters?{}:_this$props$filters,component=filters.component,props=filters.props,showLabels=filters.showLabels;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(WrappedComponent,_objectSpread(_objectSpread({},this.props),{},{count:this.state.count,filters:{active:this.isFilterActive(),component,onChange:this.onFilterChange.bind(this),showLabels,props:_objectSpread(_objectSpread({},props),{},{onCreateFilter:this.onCreateFilter.bind(this),item:this.state.filters})},items:this.state.items,loading:this.state.loading,page:this.state.page,pages:this.state.pages,perPage:this.state.perPage,onDelete:this.onDelete.bind(this),onDeleteAll:this.onDeleteAll.bind(this),onPageChange:this.onPageChange.bind(this),onPerPageChange:this.onPerPageChange.bind(this),onSave:this.onSave.bind(this),onSort:this.onSort.bind(this),onInit:this.onInit.bind(this),renderSearch:this.renderSearch.bind(this),sortColumn:this.state.sortColumn,sortDirection:this.state.sortDirection})),this.state.saved&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(_Toaster__WEBPACK_IMPORTED_MODULE_5__.Z,{onDismiss:function onDismiss(){return _this6.setState({saved:!1})},type:_Toaster__WEBPACK_IMPORTED_MODULE_5__.Z.MessageTypes.positive,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(semantic_ui_react__WEBPACK_IMPORTED_MODULE_7__.Z.Header,{content:_i18n_i18n__WEBPACK_IMPORTED_MODULE_4__.Z.t("Common.messages.save.header")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(semantic_ui_react__WEBPACK_IMPORTED_MODULE_7__.Z.Content,{content:_i18n_i18n__WEBPACK_IMPORTED_MODULE_4__.Z.t("Common.messages.save.content")})]}),this.state.error&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(_Toaster__WEBPACK_IMPORTED_MODULE_5__.Z,{onDismiss:function onDismiss(){return _this6.setState({error:!1})},timeout:0,type:_Toaster__WEBPACK_IMPORTED_MODULE_5__.Z.MessageTypes.negative,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(semantic_ui_react__WEBPACK_IMPORTED_MODULE_7__.Z.Header,{content:_i18n_i18n__WEBPACK_IMPORTED_MODULE_4__.Z.t("Common.messages.error.header")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(semantic_ui_react__WEBPACK_IMPORTED_MODULE_7__.Z.List,{items:this.props.resolveErrors&&this.props.resolveErrors(this.state.error)})]})]})}},{key:"renderSearch",value:function renderSearch(){var _this7=this;return this.props.searchable?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(semantic_ui_react__WEBPACK_IMPORTED_MODULE_8__.Z,{"aria-label":"Search",type:"text",icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(semantic_ui_react__WEBPACK_IMPORTED_MODULE_9__.Z,{link:!underscore__WEBPACK_IMPORTED_MODULE_3__.default.isEmpty(this.state.search),name:underscore__WEBPACK_IMPORTED_MODULE_3__.default.isEmpty(this.state.search)?"search":"times",onClick:this.onClearSearch.bind(this)}),input:{"aria-label":"search"},ref:function ref(_ref5){_this7.searchRef=_ref5},loading:this.state.loading,onKeyDown:_performant_software_shared_components__WEBPACK_IMPORTED_MODULE_0__.Timer.clearSearchTimer.bind(this),onKeyUp:_performant_software_shared_components__WEBPACK_IMPORTED_MODULE_0__.Timer.setSearchTimer.bind(this,this.onSearch.bind(this)),onChange:this.onSearchChange.bind(this),size:"small",value:this.state.search}):null}},{key:"restoreSession",value:function restoreSession(){var key=this.getSessionKey();if(!key)return{};var session=sessionStorage.getItem(key)||"{}";return JSON.parse(session)}},{key:"setSession",value:function setSession(){var key=this.getSessionKey();if(key){var _this$state=this.state,filters=_this$state.filters,page=_this$state.page,perPage=_this$state.perPage,search=_this$state.search,sortColumn=_this$state.sortColumn,sortDirection=_this$state.sortDirection;sessionStorage.setItem(key,JSON.stringify({filters,page,perPage,search,sortColumn,sortDirection}))}}}]),_class}(react__WEBPACK_IMPORTED_MODULE_1__.Component),_defineProperty(_class,"defaultProps",{filters:{},searchable:!0}),_class}}}]);