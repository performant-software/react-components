import{R as k,r as i,j as n}from"./iframe-CBVnS_gz.js";import{F as T}from"./Form-Do77273i.js";import{B as R}from"./Button-7qBb4VYW.js";import{I as x}from"./Item-DfbUeK2I.js";import{o as pe}from"./index.es28-Dw5WpxTH.js";import{M as S}from"./Message-B6D94I6f.js";import{L as ne}from"./Loader-BSaShB_1.js";import{D as ue}from"./Dimmer-Dp0zIHSX.js";import{M as W}from"./Modal-HnkfqseB.js";import{_ as m}from"./index-default-C0I3bBxV.js";import{F as fe}from"./FileUpload-Bjyn0dFf.js";import{I as oe}from"./Icon-BZ3eAMfw.js";import{L as ge}from"./Label-U9VHjmjO.js";import{H as J}from"./Header-Dr2ltggj.js";import{_ as he}from"./extends-CCbyfPlC.js";import{_ as ve}from"./inheritsLoose-1HkgTRWY.js";import{ai as Ce,K as ee,i as te,ab as ye,c as be,b as U,j as Ie,g as xe,a as je}from"./getElementType-Bjb0ertt.js";import{t as Se}from"./includes-DZnQI2ww.js";import{a as K}from"./toFinite-B6NhHma2.js";import{i as F}from"./ModernAutoControlledComponent-DVKlBc-y.js";import{i as I}from"./i18n-DkobdbHY.js";import"./Checkbox-C74Tntbd.js";import"./_baseSet-DIcQIHLm.js";import"./_baseAssignValue-8Q0krCXH.js";import"./Portal-BlGvxlD6.js";import"./keyboardKey-o62cP7Iz.js";import"./Dropdown-CPiIg0y1.js";import"./map-DlHA86TE.js";import"./without-CH_BgMvr.js";import"./isArrayLikeObject-CKcKx5N9.js";import"./isEmpty-BYfO-h2O.js";import"./deburr-XG8rtojb.js";import"./index-D9NXjPfP.js";import"./_arrayReduce-CrxnWFSq.js";import"./filter-9DG6Xxvy.js";import"./Input-CxqNqYl_.js";import"./index-BCLYeJHS.js";import"./Trans-8NScRHIi.js";import"./context-e-3OPt86.js";import"./forEach-Bzy9_EBR.js";import"./setPrototypeOf-DgZC2w_0.js";import"./assertThisInitialized-B9jnkVVz.js";import"./i18next-eNuDfwAU.js";function we(e,t,o){return e===e&&(o!==void 0&&(e=e<=o?e:o),t!==void 0&&(e=e>=t?e:t)),e}var Ue=Ce.isFinite,Fe=Math.min;function Pe(e){var t=Math[e];return function(o,a){if(o=K(o),a=a==null?0:Fe(Se(a),292),a&&Ue(o)){var d=(ee(o)+"e").split("e"),h=t(d[0]+"e"+(+d[1]+a));return d=(ee(h)+"e").split("e"),+(d[0]+"e"+(+d[1]-a))}return t(o)}}var Te=Pe("round");function Me(e,t,o){return o===void 0&&(o=t,t=void 0),o!==void 0&&(o=K(o),o=o===o?o:0),t!==void 0&&(t=K(t),t=t===t?t:0),we(K(e),t,o)}var Q=function(e){ve(t,e);function t(){for(var a,d=arguments.length,h=new Array(d),j=0;j<d;j++)h[j]=arguments[j];return a=e.call.apply(e,[this].concat(h))||this,a.calculatePercent=function(){var l=a.props,u=l.percent,f=l.total,g=l.value;if(!F(u))return u;if(!F(f)&&!F(g))return g/f*100},a.computeValueText=function(l){var u=a.props,f=u.progress,g=u.total,v=u.value;return f==="value"?v:f==="ratio"?v+"/"+g:l+"%"},a.getPercent=function(){var l=a.props,u=l.precision,f=l.progress,g=l.total,v=l.value,P=Me(a.calculatePercent(),0,100);return!F(g)&&!F(v)&&f==="value"?v/g*100:f==="value"?v:F(u)?P:Te(P,u)},a.isAutoSuccess=function(){var l=a.props,u=l.autoSuccess,f=l.percent,g=l.total,v=l.value;return u&&(f>=100||v>=g)},a.renderLabel=function(){var l=a.props,u=l.children,f=l.content,g=l.label;return te(u)?te(f)?ye(g,{autoGenerateKey:!1,defaultProps:{className:"label"}}):k.createElement("div",{className:"label"},f):k.createElement("div",{className:"label"},u)},a.renderProgress=function(l){var u=a.props,f=u.precision,g=u.progress;if(!(!g&&F(f)))return k.createElement("div",{className:"progress"},a.computeValueText(l))},a}var o=t.prototype;return o.render=function(){var d=this.props,h=d.active,j=d.attached,l=d.className,u=d.color,f=d.disabled,g=d.error,v=d.indicating,P=d.inverted,B=d.size,$=d.success,G=d.warning,M=be("ui",u,B,U(h||v,"active"),U(f,"disabled"),U(g,"error"),U(v,"indicating"),U(P,"inverted"),U($||this.isAutoSuccess(),"success"),U(G,"warning"),Ie(j,"attached"),"progress",l),H=xe(t,this.props),Y=je(t,this.props),N=this.getPercent()||0;return k.createElement(Y,he({},H,{className:M,"data-percent":Math.floor(N)}),k.createElement("div",{className:"bar",style:{width:N+"%"}},this.renderProgress(N)),this.renderLabel())},t}(i.Component);Q.handledProps=["active","as","attached","autoSuccess","children","className","color","content","disabled","error","indicating","inverted","label","percent","precision","progress","size","success","total","value","warning"];Q.propTypes={};const y={pending:"pending",processing:"processing",complete:"complete",error:"error"},Ne={[y.processing]:"black",[y.complete]:"green",[y.error]:"red"},ke={[y.pending]:"clock outline",[y.complete]:"checkmark",[y.error]:"warning circle"},qe={[y.pending]:"Pending",[y.processing]:"Processing",[y.complete]:"Complete",[y.error]:"Error"},re=({status:e=y.pending})=>{const t=i.useMemo(()=>Ne[e],[e]),o=i.useMemo(()=>ke[e],[e]),a=i.useMemo(()=>qe[e],[e]);return n.jsxs(ge,{className:"file-upload-status",color:t,children:[e===y.processing&&n.jsx(ne,{active:!0,inline:!0,inverted:!0,size:"mini"}),o&&n.jsx(oe,{name:o}),a]})};re.__docgenInfo={description:"",methods:[],displayName:"FileUploadStatus",props:{status:{required:!1,flowType:{name:"string"},description:"",defaultValue:{value:"'pending'",computed:!1}}}};const ae=e=>{const t=i.useMemo(()=>e.completed>0&&e.completed===e.total,[e.completed,e.total]),o=i.useMemo(()=>e.total>0?e.completed/e.total:0,[e.completed,e.total]),a=i.useMemo(()=>Number(o).toLocaleString(void 0,{style:"percent",minimumFractionDigits:0}),[o]);return n.jsxs("div",{className:"file-upload-progress",children:[n.jsx(oe,{color:"blue",name:"cloud upload",size:"big"}),n.jsxs("div",{className:"progress-container",children:[n.jsxs(J,{children:[n.jsx(J.Content,{content:a}),n.jsxs(J.Subheader,{children:[!(e.uploading||t)&&"Getting Started",e.uploading&&"Uploading...",t&&"Completed"]})]}),n.jsx(Q,{color:"blue",percent:o*100})]})]})};ae.__docgenInfo={description:"",methods:[],displayName:"FileUploadProgress",props:{completed:{required:!0,flowType:{name:"number"},description:""},total:{required:!0,flowType:{name:"number"},description:""},uploading:{required:!1,flowType:{name:"boolean"},description:""}}};const q={batch:"batch",single:"single"},z={processing:"processing",complete:"complete",error:"error"},w=e=>{const[t,o]=i.useState([]),[a,d]=i.useState(0),[h,j]=i.useState(!1),[l,u]=i.useState({}),f=i.useMemo(()=>!!m.find(t,r=>!m.isEmpty(r.errors)),[t]),g=i.useMemo(()=>!!m.find(m.values(l),r=>r===z.error),[l]),v=i.useCallback(r=>o(s=>[...s,...m.map(r,e.onAddFile)]),[]),P=i.useCallback((r,s,p,c)=>o(C=>m.map(C,b=>b!==r?b:{...b,[s]:c.id,[p]:c,errors:m.without(r.errors,s)})),[]),B=i.useCallback(()=>e.onSave(t).then(()=>d(1)),[t]),$=i.useCallback(()=>{j(!1),e.onComplete&&e.onComplete(),e.closeOnComplete&&e.onClose()},[e.closeOnComplete,e.onClose]),G=i.useCallback(r=>o(s=>m.filter(s,p=>p!==r)),[]),M=i.useCallback((r,s)=>u(p=>({...p,[r]:s}))),H=i.useCallback(async()=>{for(let r=0;r<t.length;r+=1){const s=t[r];M(r,z.processing);let p;try{await e.onSave(s)}catch(c){p=c}p?M(r,z.error):M(r,z.complete),d(c=>c+1)}return Promise.resolve()},[t,e.onSave]),Y=i.useCallback((r,s)=>o(p=>m.map(p,c=>c!==r?c:{...c,...s,errors:[]})),[]),N=i.useCallback((r,s,p,{value:c})=>o(C=>m.map(C,b=>b!==r?b:{...b,[s]:c,errors:m.without(r.errors,s)})),[]),se=i.useCallback((r,s)=>o(p=>m.map(p,c=>c!==r?c:{...c,...s})),[]),ie=i.useCallback(r=>{const s=[];return m.each(m.keys(e.required),p=>{const c=r[p];let C;e.onValidate?C=e.onValidate(r,p):m.isNumber(c)?C=m.isEmpty(c.toString()):C=m.isEmpty(c),C&&s.push(p)}),{...r,errors:s}},[e.onValidate,e.required]),X=i.useCallback(()=>new Promise((r,s)=>{let p=!1;const c=m.map(t,C=>{const b=ie(C);return m.isEmpty(b.errors)||(p=!0),b});o(c),p?s():r()}),[t]),le=i.useCallback(()=>{j(!0),X().then(()=>e.strategy===q.batch?B():H()).finally($)},[B,$,H,X,e.strategy]),ce=i.useCallback((r,s)=>{if(m.isEmpty(r.errors))return null;const p=m.isEmpty(r.name)?s:r.name,c=m.map(r.errors,C=>e.required[C]).join(", ");return n.jsx(S.Item,{content:I.t("FileUploadModal.errors.required",{filename:p,fields:c})},s)},[]),de=i.useCallback(r=>e.strategy!==q.single?null:n.jsx(re,{status:l[r]}),[l,e.strategy]),Z=i.useMemo(()=>e.headerComponent,[e.headerComponent]),me=i.useMemo(()=>e.itemComponent,[e.itemComponent]);return n.jsx(pe.Consumer,{children:r=>n.jsxs(W,{centered:!1,className:"serial-upload-modal",mountNode:r,open:!0,children:[e.showPageLoader&&n.jsx(ue,{active:h,inverted:!0,children:n.jsx(ne,{content:I.t("FileUploadModal.loader")})}),n.jsxs(W.Header,{children:[e.strategy===q.batch&&I.t("FileUploadModal.title"),e.strategy===q.single&&n.jsx(ae,{completed:a,total:t.length,uploading:h})]}),n.jsxs(W.Content,{scrolling:!0,children:[f&&n.jsxs(S,{error:!0,children:[n.jsx(S.Header,{content:I.t("FileUploadModal.errors.header")}),n.jsx(S.List,{children:m.map(t,ce)})]}),!m.isEmpty(e.errors)&&n.jsxs(S,{error:!0,children:[n.jsx(S.Header,{content:I.t("FileUploadModal.errors.header")}),n.jsx(S.List,{items:e.errors})]}),g&&n.jsx(S,{content:I.t("FileUploadModal.errors.upload.content"),header:I.t("FileUploadModal.errors.upload.header"),error:!0}),n.jsx(fe,{onFilesAdded:v}),Z&&n.jsx(Z,{items:t,onSetItems:o,uploading:h}),n.jsx(x.Group,{as:T,divided:!0,noValidate:!0,relaxed:"very",children:m.map(t,(s,p)=>i.createElement(me,{...e.itemComponentProps,isError:c=>m.contains(s.errors,c),isRequired:c=>!!(e.required&&e.required[c]),item:s,key:p,onAssociationInputChange:P.bind(void 0,s),onDelete:G.bind(void 0,s),onSetState:Y.bind(void 0,s),onTextInputChange:N.bind(void 0,s),onUpdate:se.bind(void 0,s),renderStatus:de.bind(void 0,p)}))})]}),n.jsxs(W.Actions,{children:[n.jsx(R,{content:I.t("Common.buttons.upload"),disabled:h||a>0||m.isEmpty(t),icon:"cloud upload",loading:h&&!e.showPageLoader,onClick:le,primary:!0}),n.jsx(R,{content:a>0?I.t("Common.buttons.close"):I.t("Common.buttons.cancel"),disabled:h,onClick:e.onClose})]})]})})};w.defaultProps={closeOnComplete:!0,itemComponentProps:{},strategy:q.batch,showPageLoader:!0};w.__docgenInfo={description:`The <code>FileUploadModal</code> is a convenience wrapper for the <code>FileUpload</code> component, allowing
it to render in a modal.`,methods:[],displayName:"FileUploadModal",props:{closeOnComplete:{required:!1,flowType:{name:"boolean"},description:"If <code>true</code>, the modal will close once the upload has completed.",defaultValue:{value:"true",computed:!1}},errors:{required:!1,flowType:{name:"string"},description:"An error message to display at the top of the modal."},headerComponent:{required:!1,flowType:{name:"ComponentType",elements:[{name:"any"}],raw:"ComponentType<any>"},description:"Component to render at top of modal."},itemComponent:{required:!0,flowType:{name:"ComponentType",elements:[{name:"any"}],raw:"ComponentType<any>"},description:"Component to render within the modal."},itemComponentProps:{required:!1,flowType:{name:"any"},description:'Additional props to provide to the "itemComponent".',defaultValue:{value:"{}",computed:!1}},onAddFile:{required:!0,flowType:{name:"signature",type:"function",raw:"(file: File) => any",signature:{arguments:[{name:"file",type:{name:"File"}}],return:{name:"any"}}},description:"Callback fired when a file is added."},onClose:{required:!0,flowType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback fired when the close button is clicked."},onComplete:{required:!0,flowType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback fired when the upload has completed."},onSave:{required:!0,flowType:{name:"signature",type:"function",raw:"(items: Array<any>) => Promise<any>",signature:{arguments:[{name:"items",type:{name:"Array",elements:[{name:"any"}],raw:"Array<any>"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}}},description:"Callback fired when the save button is clicked. See <code>strategy</code> prop."},onValidate:{required:!1,flowType:{name:"signature",type:"function",raw:"(item: any, key: string) => boolean",signature:{arguments:[{name:"item",type:{name:"any"}},{name:"key",type:{name:"string"}}],return:{name:"boolean"}}},description:`Callback fired when an item is validated. If the return value is \`true\`, the item will pass validation.

@param item
@param key`},required:{required:!1,flowType:{name:"signature",type:"object",raw:"{ [key: string]: string }",signature:{properties:[{key:{name:"string"},value:{name:"string",required:!0}}]}},description:"An object with keys containing the names of properties that are required."},showPageLoader:{required:!1,flowType:{name:"boolean"},description:"If <code>true</code>, a full page loader will display while uploading is in progress.",defaultValue:{value:"true",computed:!1}},strategy:{required:!1,flowType:{name:"string"},description:`The upload strategy to use. If <code>batch</code>, we'll execute one <code>onSave</code> request with each item
as an array in the body. If <code>single</code>, we'll execute an <code>onSave</code> request for each item.`,defaultValue:{value:"'batch'",computed:!1}}}};const{action:V}=__STORYBOOK_MODULE_ACTIONS__,jt={title:"Components/Semantic UI/FileUploadModal",component:w},D=e=>t=>{const[o,a]=i.useState(!1);return n.jsxs(n.Fragment,{children:[n.jsx(R,{content:"Open",primary:!0,onClick:()=>a(!0)}),o&&n.jsx(e,{...t,onClose:()=>a(!1)})]})},_=D(e=>n.jsx(w,{itemComponent:({item:t})=>n.jsx(T.Input,{label:"Name",value:t.name||""}),onAddFile:t=>({name:t.name,content:t,type:t.type}),onClose:e.onClose,onSave:()=>(V("save")(),Promise.resolve())})),E=D(e=>n.jsx(w,{closeOnComplete:!1,itemComponent:({item:t,isError:o,isRequired:a,onDelete:d,onTextInputChange:h})=>n.jsxs(x,{children:[n.jsx(x.Image,{src:URL.createObjectURL(t.content)}),n.jsxs(x.Content,{children:[n.jsx(T.Input,{error:o("name"),label:"Name",onChange:h.bind(void 0,"name"),required:a("name"),value:t.name||""}),n.jsx(R,{basic:!0,color:"red",icon:"trash",onClick:d})]})]}),onAddFile:t=>({name:t.name,content:t,content_type:t.type}),onClose:e.onClose,onSave:()=>(V("save")(),Promise.resolve()),required:{name:"Name"}})),L=D(e=>n.jsx(w,{errors:["File too large."],itemComponent:({item:t})=>n.jsx(T.Input,{label:"Name",value:t.name||""}),onAddFile:t=>({name:t.name,content:t,type:t.type}),onClose:e.onClose,onSave:()=>(V("save")(),Promise.resolve())})),A=D(e=>n.jsx(w,{itemComponent:({item:t,onTextInputChange:o})=>n.jsxs(x,{children:[n.jsx(x.Image,{src:URL.createObjectURL(t.content)}),n.jsx(x.Content,{children:n.jsx(T.Input,{label:"Name",onChange:o.bind(void 0,"name"),value:t.name})})]}),onAddFile:t=>({name:t.name,content:t,type:t.type}),onClose:e.onClose,onSave:()=>(V("save")(),Promise.resolve())})),O=D(e=>n.jsx(w,{closeOnComplete:!1,itemComponent:({item:t,onDelete:o,onTextInputChange:a,renderStatus:d})=>n.jsxs(x,{children:[n.jsx(x.Image,{src:URL.createObjectURL(t.content)}),n.jsxs(x.Content,{children:[n.jsx(T.Input,{label:"Name",onChange:a.bind(void 0,"name"),value:t.name}),n.jsx(R,{basic:!0,color:"red",icon:"trash",onClick:o}),d()]})]}),onAddFile:t=>({name:t.name,content:t,type:t.type}),onClose:e.onClose,onSave:()=>(V("save")(),Promise.resolve()),showPageLoader:!1,strategy:"single"}));_.__docgenInfo={description:"",methods:[],displayName:"Default"};E.__docgenInfo={description:"",methods:[],displayName:"InputErrors"};L.__docgenInfo={description:"",methods:[],displayName:"UploadErrors"};A.__docgenInfo={description:"",methods:[],displayName:"Images"};O.__docgenInfo={description:"",methods:[],displayName:"SingleUpload"};_.parameters={..._.parameters,docs:{..._.parameters?.docs,source:{originalSource:`withWrapper(props => <FileUploadModal itemComponent={({
  item
}) => <Form.Input label='Name' value={item.name || ''} />} onAddFile={file => ({
  name: file.name,
  content: file,
  type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} />)`,..._.parameters?.docs?.source}}};E.parameters={...E.parameters,docs:{...E.parameters?.docs,source:{originalSource:`withWrapper(props => <FileUploadModal closeOnComplete={false} itemComponent={({
  item,
  isError,
  isRequired,
  onDelete,
  onTextInputChange
}) => <Item>
        <Item.Image src={URL.createObjectURL(item.content)} />
        <Item.Content>
          <Form.Input error={isError('name')} label='Name' onChange={onTextInputChange.bind(this, 'name')} required={isRequired('name')} value={item.name || ''} />
          <Button basic color='red' icon='trash' onClick={onDelete} />
        </Item.Content>
      </Item>} onAddFile={file => ({
  name: file.name,
  content: file,
  content_type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} required={{
  name: 'Name'
}} />)`,...E.parameters?.docs?.source}}};L.parameters={...L.parameters,docs:{...L.parameters?.docs,source:{originalSource:`withWrapper(props => <FileUploadModal errors={['File too large.']} itemComponent={({
  item
}) => <Form.Input label='Name' value={item.name || ''} />} onAddFile={file => ({
  name: file.name,
  content: file,
  type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} />)`,...L.parameters?.docs?.source}}};A.parameters={...A.parameters,docs:{...A.parameters?.docs,source:{originalSource:`withWrapper(props => <FileUploadModal itemComponent={({
  item,
  onTextInputChange
}) => <Item>
        <Item.Image src={URL.createObjectURL(item.content)} />
        <Item.Content>
          <Form.Input label='Name' onChange={onTextInputChange.bind(this, 'name')} value={item.name} />
        </Item.Content>
      </Item>} onAddFile={file => ({
  name: file.name,
  content: file,
  type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} />)`,...A.parameters?.docs?.source}}};O.parameters={...O.parameters,docs:{...O.parameters?.docs,source:{originalSource:`withWrapper(props => <FileUploadModal closeOnComplete={false} itemComponent={({
  item,
  onDelete,
  onTextInputChange,
  renderStatus
}) => <Item>
        <Item.Image src={URL.createObjectURL(item.content)} />
        <Item.Content>
          <Form.Input label='Name' onChange={onTextInputChange.bind(this, 'name')} value={item.name} />
          <Button basic color='red' icon='trash' onClick={onDelete} />
          {renderStatus()}
        </Item.Content>
      </Item>} onAddFile={file => ({
  name: file.name,
  content: file,
  type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} showPageLoader={false} strategy='single' />)`,...O.parameters?.docs?.source}}};const St=["Default","InputErrors","UploadErrors","Images","SingleUpload"];export{_ as Default,A as Images,E as InputErrors,O as SingleUpload,L as UploadErrors,St as __namedExportsOrder,jt as default};
