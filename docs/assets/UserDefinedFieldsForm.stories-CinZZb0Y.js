import{j as o}from"./jsx-runtime-D9TvR9R2.js";import{r as y}from"./index-C0dDX-lL.js";import{d as F}from"./index-DcYp3xR7.js";import{F as d}from"./Form-cOZUQdvM.js";import{v as w,b as j}from"./index.es99-CpMUW1kE.js";import{d as T}from"./index.es34-D-zeZtkc.js";import"./index-DOYXiIEK.js";import{_ as b}from"./index-default-C_maRo4o.js";import{U as E}from"./UserDefinedFields-CcepyLk8.js";import"./_commonjsHelpers-BosuxZz1.js";import"./mapValues-BQxZ7nrE.js";import"./pickBy-JNbKYqv1.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./isPlainObject-BoCILj_Q.js";import"./index-Cw1G72V2.js";import"./index-CKJfshIT.js";import"./tiny-invariant.cjs-DxxScMW_.js";import"./___vite-browser-external_commonjs-proxy-DRaEfepn.js";import"./preview-errors-CzpZmerH.js";import"./debounce-DmjZtjd2.js";import"./extends-CCbyfPlC.js";import"./inheritsLoose-1HkgTRWY.js";import"./setPrototypeOf-DgZC2w_0.js";import"./getElementType-C_4y_n4F.js";import"./Button-Dcib8V--.js";import"./Icon-BGzIEILD.js";import"./Label-BqnFaqey.js";import"./ModernAutoControlledComponent-CBEnGjal.js";import"./assertThisInitialized-B9jnkVVz.js";import"./includes-BAV9TYTx.js";import"./toFinite-DWd2HYc9.js";import"./forEach-Bj9nU5MO.js";import"./Dimmer-kmE_IUk6.js";import"./Portal-CKYxdKwP.js";import"./keyboardKey-OMDgGVm3.js";import"./objectWithoutPropertiesLoose-1QL-frMM.js";import"./map-Dr4OE-Ab.js";import"./Checkbox-Bi1MrC0t.js";import"./_baseSet-N8oZ1kqS.js";import"./_baseAssignValue-oMV-Qdk1.js";import"./Dropdown-CChVlGq2.js";import"./without-5b9zAUWg.js";import"./isArrayLikeObject-BDKOwBZt.js";import"./isEmpty-D4udnfVx.js";import"./deburr-ClVont3z.js";import"./index-C2Sldg7a.js";import"./_arrayReduce-CrxnWFSq.js";import"./filter-BXgalVMq.js";import"./Input-CEHVpxQU.js";import"./index.es32-C8df4TxC.js";import"./index.es2-Cs0UMmWM.js";import"./index.es28-DQCJ81LM.js";import"./index.es12-CDIfCsDR.js";import"./useDrop-Bls-awrw.js";import"./DndContext-BcAF8WvB.js";import"./redux-CpmcZR8k.js";import"./objectSpread2-Cl-ctlOG.js";import"./defineProperty-DcNpp85p.js";import"./toPropertyKey-BcUJYDQU.js";import"./index.es3-BDp463eK.js";import"./index.es25-xvj8T6Jl.js";import"./iframe-CJwiHJCV.js";import"../sb-preview/runtime.js";import"./index.es15-MOTpzHO3.js";class v{toData(r){return{id:r.id,accuracy:r.accuracy,description:r.description,end_date:r.endDate,range:r.range,start_date:r.startDate,_destroy:r._destroy}}toFuzzyDate(r){return r?{id:r.id,accuracy:r.accuracy,description:r.description,endDate:r.end_date,range:r.range,startDate:r.start_date,_destroy:r._destroy}:null}toPayload(r,_){const c=r[_];return c?{[_]:this.toData(c)}:null}}const h=new v,k={boolean:"Boolean",date:"Date",fuzzyDate:"FuzzyDate",number:"Number",richText:"RichText",select:"Select",string:"String",text:"Text"},I={DataTypes:k},{DataTypes:l}=I,C=t=>{const[r,_]=y.useState(t.fields||[]),c=y.useCallback(e=>`user_defined[${e.uuid}]`,[]),s=y.useCallback(e=>t.isError(c(e)),[c,t.isError]),m=y.useCallback((e,n)=>{t.onChange({...t.data,[e.uuid]:n}),t.onClearValidationError&&t.onClearValidationError(c(e))},[c,t.data,t.onChange,t.onClearValidationError]),x=y.useCallback((e,n)=>{let u;const i=t.data&&t.data[e.uuid];return e.data_type===l.string&&(u=o.jsx(d.Input,{error:s(e),label:e.column_name,required:e.required,onChange:(a,{value:p})=>m(e,p),value:i||""},n)),e.data_type===l.number&&(u=o.jsx(d.Input,{error:s(e),label:e.column_name,required:e.required,onChange:(a,{value:p})=>m(e,p),value:i||0,type:"number"},n)),e.data_type===l.select&&(u=o.jsx(d.Dropdown,{clearable:!0,error:s(e),label:e.column_name,multiple:e.allow_multiple,required:e.required,options:b.map(e.options,a=>({key:a,value:a,text:a})),onChange:(a,{value:p})=>m(e,p),selectOnBlur:!1,selection:!0,value:e.allow_multiple?i||[]:i||""},n)),e.data_type===l.text&&(u=o.jsx(d.TextArea,{error:s(e),label:e.column_name,required:e.required,onChange:(a,{value:p})=>m(e,p),value:i||""},n)),e.data_type===l.date&&(u=o.jsx(d.Input,{error:s(e),label:e.column_name,required:e.required,children:o.jsx(w,{onChange:a=>m(e,a&&a.toISOString()),value:i&&new Date(i)})},n)),e.data_type===l.fuzzyDate&&(u=o.jsx(d.Input,{error:s(e),label:e.column_name,required:e.required,children:o.jsx(j,{centered:!1,date:h.toFuzzyDate(i)||{},onChange:a=>m(e,h.toData(a)),title:e.column_name})},n)),e.data_type===l.boolean&&(u=o.jsx(d.Checkbox,{checked:!!i,error:s(e),label:e.column_name,onChange:(a,{checked:p})=>m(e,p)},n)),e.data_type===l.richText&&(u=o.jsx(d.Input,{error:s(e),label:e.column_name,required:e.required,children:o.jsx(T,{onChange:a=>m(e,a),value:i})},n)),u},[t.data,s,m]);return y.useEffect(()=>{if(!b.isEmpty(r))return;const e={defineable_id:t.defineableId,defineable_type:t.defineableType,per_page:0,required:t.required,sort_by:"order",table_name:t.tableName};E.fetchAll(e).then(({data:n})=>_(n.user_defined_fields))},[]),o.jsx(o.Fragment,{children:b.map(r,x.bind(void 0))})};C.__docgenInfo={description:"",methods:[],displayName:"UserDefinedFieldsForm",props:{data:{required:!0,flowType:{name:"any"},description:""},defineableId:{required:!1,flowType:{name:"number"},description:""},defineableType:{required:!1,flowType:{name:"string"},description:""},fields:{required:!1,flowType:{name:"Array"},description:""},isError:{required:!0,flowType:{name:"signature",type:"function",raw:"(key: string) => boolean",signature:{arguments:[{name:"key",type:{name:"string"}}],return:{name:"boolean"}}},description:""},onChange:{required:!0,flowType:{name:"signature",type:"function",raw:"(obj: any) => void",signature:{arguments:[{name:"obj",type:{name:"any"}}],return:{name:"void"}}},description:""},onClearValidationError:{required:!0,flowType:{name:"signature",type:"function",raw:"(...keys: Array<string>) => void",signature:{arguments:[{name:"keys",type:{name:"Array",elements:[{name:"string"}],raw:"Array<string>"},rest:!0}],return:{name:"void"}}},description:""},required:{required:!1,flowType:{name:"boolean"},description:""},tableName:{required:!1,flowType:{name:"string"},description:""}}};const Pe={title:"Components/User Defined Fields/UserDefinedFieldsForm",decorators:[F.withKnobs]},g=()=>{const[t,r]=y.useState({});return o.jsx(d,{children:o.jsx(C,{data:t,isError:()=>!1,onChange:r})})};g.__docgenInfo={description:"",methods:[],displayName:"Default"};var D,f,q;g.parameters={...g.parameters,docs:{...(D=g.parameters)==null?void 0:D.docs,source:{originalSource:`() => {
  const [data, setData] = useState({});
  return <Form>
      <UserDefinedFieldsForm data={data} isError={() => false} onChange={setData} />
    </Form>;
}`,...(q=(f=g.parameters)==null?void 0:f.docs)==null?void 0:q.source}}};const $e=["Default"];export{g as Default,$e as __namedExportsOrder,Pe as default};
