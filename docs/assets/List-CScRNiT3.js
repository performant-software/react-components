var L=Object.defineProperty;var N=(s,d,e)=>d in s?L(s,d,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[d]=e;var E=(s,d,e)=>(N(s,typeof d!="symbol"?d+"":d,e),e);import{j as n}from"./jsx-runtime-D9TvR9R2.js";import{r as f}from"./index-C0dDX-lL.js";import{C as A}from"./Confirm-BUdp95GX.js";import{P as Q}from"./Pagination-CRHbXf2X.js";import{G as m}from"./Grid-CpdbEkBf.js";import{M as q}from"./Menu-C3RUPz9h.js";import{B as g}from"./Button-CJhT71wt.js";import{H as x}from"./Header-BHdMo175.js";import{I as C}from"./Icon-C_3d7-zE.js";import{_ as l}from"./index-default-C_maRo4o.js";import{i as u}from"./i18n-CM1tepcX.js";import{D as F}from"./DropdownButton-BOdm4mkS.js";import{E as S}from"./EditModal-Daayu7rJ.js";import{L as w}from"./Label-aEFd48OX.js";import"./index.es30-Cot0rGUw.js";import{F as T}from"./Form-WfNl3YLh.js";import{I as M}from"./Input-Bwh_HEb3.js";import{C as I}from"./Checkbox-B3tsCUtI.js";import{D as B}from"./Dropdown-DwNow7wJ.js";import{M as j}from"./Modal-BWgkEMr1.js";import{A as _}from"./AssociatedDropdown-D9lViqdw.js";import{F as R}from"./FuzzyDate-BlT_dpT4.js";import{M as $}from"./ModalContext-CLCyDZFr.js";import{T as H}from"./Trans-BYRLofKo.js";const c={boolean:"boolean",date:"date",integer:"integer",relationship:"relationship",select:"select",string:"string",text:"text"},a={equal:"equal",notEqual:"not_equal",contain:"contain",notContain:"not_contain",empty:"empty",notEmpty:"not_empty",greaterThan:"greater_than",lessThan:"less_than"},O=[{key:a.equal,value:a.equal,text:u.t("ListFilters.operators.equal")},{key:a.notEqual,value:a.notEqual,text:u.t("ListFilters.operators.notEqual")},{key:a.contain,value:a.contain,text:u.t("ListFilters.operators.contain")},{key:a.notContain,value:a.notContain,text:u.t("ListFilters.operators.notContain")},{key:a.empty,value:a.empty,text:u.t("ListFilters.operators.empty")},{key:a.notEmpty,value:a.notEmpty,text:u.t("ListFilters.operators.notEmpty")},{key:a.greaterThan,value:a.greaterThan,text:u.t("ListFilters.operators.greaterThan")},{key:a.lessThan,value:a.lessThan,text:u.t("ListFilters.operators.lessThan")}],z={[c.boolean]:[a.equal],[c.date]:[a.equal],[c.relationship]:[a.equal,a.notEqual,a.empty,a.notEmpty],[c.select]:[a.equal,a.notEqual,a.empty,a.notEmpty],[c.string]:[a.equal,a.notEqual,a.contain,a.notContain,a.empty,a.notEmpty],[c.text]:[a.contain,a.notContain,a.empty,a.notEmpty]},K=s=>{const d=f.useCallback(t=>{const i=z[t];return l.filter(O,y=>!i||l.contains(i,y.key))},[]),e=t=>t.label,r=f.useCallback(t=>{if(t.operator===a.empty||t.operator===a.notEmpty)return null;if(t.type===c.boolean)return n.jsx(I,{onChange:()=>s.onSaveChildAssociation("filters",{...t,value:!t.value}),checked:t.value});if(t.type===c.string||t.type===c.text||t.type===c.integer)return n.jsx(M,{onChange:(i,{value:y})=>s.onSaveChildAssociation("filters",{...t,value:y}),value:t.value});if(t.type===c.date)return n.jsx(R,{date:t.value||{},description:!1,onChange:i=>{s.onSaveChildAssociation("filters",{...t,value:i})},title:t.label});if(t.type===c.select)return n.jsx(B,{onChange:(i,{value:y})=>s.onSaveChildAssociation("filters",{...t,value:y}),options:t.options,selectOnBlur:!1,selection:!0,value:t.value});if(t.type===c.relationship){const{collectionName:i,onSearch:y,renderOption:p,renderSearchQuery:h,searchQuery:v,value:k}=t;return i&&y&&p?n.jsx(_,{collectionName:i,onSearch:y,onSelection:b=>{s.onSaveChildAssociation("filters",{...t,searchQuery:h&&h(b),value:b.id})},renderOption:p,required:!0,searchQuery:v||"",value:k||null}):null}return null},[s.item.filters,s.onSaveChildAssociation]),o=f.useMemo(()=>l.sortBy(s.filters,s.item.onSort||e),[s.filters,s.item.onSort]);return f.useEffect(()=>{l.each(s.item.filters,t=>{const i=l.findWhere(s.filters,{key:t.key});t.type===c.boolean&&(i.value=!1),s.onSaveChildAssociation("filters",l.defaults(t,i))})},[]),n.jsx($.Consumer,{children:t=>n.jsxs(j,{as:T,centered:!1,className:"list-filters-modal",mountNode:t,noValidate:!0,open:!0,size:"small",children:[n.jsx(j.Header,{children:n.jsxs(m,{columns:2,children:[n.jsx(m.Column,{verticalAlign:"middle",children:n.jsx(x,{content:u.t("ListFilters.title")})}),n.jsxs(m.Column,{textAlign:"right",children:[n.jsx(F,{color:"green",icon:"plus",options:l.map(o,i=>({key:i.key,value:i.key,text:i.label})),onChange:(i,{value:y})=>{const p=l.findWhere(s.filters,{key:y});s.onSaveChildAssociation("filters",s.onCreateFilter({...p,operator:a.equal}))},scrolling:!0,text:u.t("ListFilters.buttons.add"),value:""}),n.jsx(g,{color:"red",content:u.t("ListFilters.buttons.reset"),icon:"repeat",onClick:()=>s.onReset(),style:{marginLeft:"1em"}})]})]})}),n.jsx(j.Content,{children:!l.isEmpty(s.item.filters)&&n.jsx(m,{children:l.map(s.item.filters,i=>n.jsxs(m.Row,{columns:4,verticalAlign:"middle",children:[n.jsx(m.Column,{children:n.jsx(x,{content:i.label})}),n.jsx(m.Column,{width:5,children:n.jsx(B,{options:d(i.type),onChange:(y,{value:p})=>s.onSaveChildAssociation("filters",{...l.omit(i,"value"),operator:p}),selection:!0,value:i.operator})}),n.jsx(m.Column,{width:5,children:r(i)}),n.jsx(m.Column,{width:1,children:n.jsx(g,{basic:!0,icon:"times",onClick:()=>s.onDeleteChildAssociation("filters",i)})})]},i.key))})}),s.children]})})};K.__docgenInfo={description:"",methods:[],displayName:"ListFilters",props:{filters:{required:!0,flowType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  collectionName?: 'string',
  key: string,
  label: string,
  onSearch?: (search: string) => Promise<any>,
  operator: ?string,
  options?: Array<Option>,
  renderOption?: (item: any) => Option,
  renderSearchQuery?: (item: any) => Element<any> | string,
  searchQuery?: string,
  type: string,
  value: ?any
}`,signature:{properties:[{key:"collectionName",value:{name:"literal",value:"'string'",required:!1}},{key:"key",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"onSearch",value:{name:"signature",type:"function",raw:"(search: string) => Promise<any>",signature:{arguments:[{name:"search",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}},required:!1}},{key:"operator",value:{name:"string",nullable:!0,required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}],raw:"Array<Option>",required:!1}},{key:"renderOption",value:{name:"signature",type:"function",raw:"(item: any) => Option",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}},required:!1}},{key:"renderSearchQuery",value:{name:"signature",type:"function",raw:"(item: any) => Element<any> | string",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"union",raw:"Element<any> | string",elements:[{name:"Element",elements:[{name:"any"}],raw:"Element<any>"},{name:"string"}]}},required:!1}},{key:"searchQuery",value:{name:"string",required:!1}},{key:"type",value:{name:"string",required:!0}},{key:"value",value:{name:"any",nullable:!0,required:!0}}]}}],raw:"Array<Filter>"},description:""},item:{required:!0,flowType:{name:"signature",type:"object",raw:`{
  filters: Array<Filter>,
  onSort: (filter: Filter) => any
}`,signature:{properties:[{key:"filters",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  collectionName?: 'string',
  key: string,
  label: string,
  onSearch?: (search: string) => Promise<any>,
  operator: ?string,
  options?: Array<Option>,
  renderOption?: (item: any) => Option,
  renderSearchQuery?: (item: any) => Element<any> | string,
  searchQuery?: string,
  type: string,
  value: ?any
}`,signature:{properties:[{key:"collectionName",value:{name:"literal",value:"'string'",required:!1}},{key:"key",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"onSearch",value:{name:"signature",type:"function",raw:"(search: string) => Promise<any>",signature:{arguments:[{name:"search",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}},required:!1}},{key:"operator",value:{name:"string",nullable:!0,required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}],raw:"Array<Option>",required:!1}},{key:"renderOption",value:{name:"signature",type:"function",raw:"(item: any) => Option",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}},required:!1}},{key:"renderSearchQuery",value:{name:"signature",type:"function",raw:"(item: any) => Element<any> | string",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"union",raw:"Element<any> | string",elements:[{name:"Element",elements:[{name:"any"}],raw:"Element<any>"},{name:"string"}]}},required:!1}},{key:"searchQuery",value:{name:"string",required:!1}},{key:"type",value:{name:"string",required:!0}},{key:"value",value:{name:"any",nullable:!0,required:!0}}]}}],raw:"Array<Filter>",required:!0}},{key:"onSort",value:{name:"signature",type:"function",raw:"(filter: Filter) => any",signature:{arguments:[{name:"filter",type:{name:"signature",type:"object",raw:`{
  collectionName?: 'string',
  key: string,
  label: string,
  onSearch?: (search: string) => Promise<any>,
  operator: ?string,
  options?: Array<Option>,
  renderOption?: (item: any) => Option,
  renderSearchQuery?: (item: any) => Element<any> | string,
  searchQuery?: string,
  type: string,
  value: ?any
}`,signature:{properties:[{key:"collectionName",value:{name:"literal",value:"'string'",required:!1}},{key:"key",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"onSearch",value:{name:"signature",type:"function",raw:"(search: string) => Promise<any>",signature:{arguments:[{name:"search",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}},required:!1}},{key:"operator",value:{name:"string",nullable:!0,required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}],raw:"Array<Option>",required:!1}},{key:"renderOption",value:{name:"signature",type:"function",raw:"(item: any) => Option",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}},required:!1}},{key:"renderSearchQuery",value:{name:"signature",type:"function",raw:"(item: any) => Element<any> | string",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"union",raw:"Element<any> | string",elements:[{name:"Element",elements:[{name:"any"}],raw:"Element<any>"},{name:"string"}]}},required:!1}},{key:"searchQuery",value:{name:"string",required:!1}},{key:"type",value:{name:"string",required:!0}},{key:"value",value:{name:"any",nullable:!0,required:!0}}]}}}],return:{name:"any"}},required:!0}}]}},description:""},onCreateFilter:{required:!0,flowType:{name:"signature",type:"function",raw:"(filter: Filter) => any",signature:{arguments:[{name:"filter",type:{name:"signature",type:"object",raw:`{
  collectionName?: 'string',
  key: string,
  label: string,
  onSearch?: (search: string) => Promise<any>,
  operator: ?string,
  options?: Array<Option>,
  renderOption?: (item: any) => Option,
  renderSearchQuery?: (item: any) => Element<any> | string,
  searchQuery?: string,
  type: string,
  value: ?any
}`,signature:{properties:[{key:"collectionName",value:{name:"literal",value:"'string'",required:!1}},{key:"key",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"onSearch",value:{name:"signature",type:"function",raw:"(search: string) => Promise<any>",signature:{arguments:[{name:"search",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}},required:!1}},{key:"operator",value:{name:"string",nullable:!0,required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}],raw:"Array<Option>",required:!1}},{key:"renderOption",value:{name:"signature",type:"function",raw:"(item: any) => Option",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}},required:!1}},{key:"renderSearchQuery",value:{name:"signature",type:"function",raw:"(item: any) => Element<any> | string",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"union",raw:"Element<any> | string",elements:[{name:"Element",elements:[{name:"any"}],raw:"Element<any>"},{name:"string"}]}},required:!1}},{key:"searchQuery",value:{name:"string",required:!1}},{key:"type",value:{name:"string",required:!0}},{key:"value",value:{name:"any",nullable:!0,required:!0}}]}}}],return:{name:"any"}}},description:""}}};const P=s=>{const d=f.useCallback(e=>{const r=[e.label],o=l.findWhere(O,{key:e.operator});return o&&r.push(o.text),e.value&&r.push(`"${e.value}"`),r.join(" ")},[]);return n.jsxs(w.Group,{className:"filter-labels",children:[l.map(s.filters,e=>n.jsx(w,{basic:!0,content:d(e),onRemove:()=>s.onClick(e)})),s.onClear&&n.jsx(w,{as:g,color:"red",content:u.t("FilterLabels.buttons.clear"),icon:"times",onClick:s.onClear})]})};P.__docgenInfo={description:"",methods:[],displayName:"FilterLabels",props:{filters:{required:!0,flowType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  collectionName?: 'string',
  key: string,
  label: string,
  onSearch?: (search: string) => Promise<any>,
  operator: ?string,
  options?: Array<Option>,
  renderOption?: (item: any) => Option,
  renderSearchQuery?: (item: any) => Element<any> | string,
  searchQuery?: string,
  type: string,
  value: ?any
}`,signature:{properties:[{key:"collectionName",value:{name:"literal",value:"'string'",required:!1}},{key:"key",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"onSearch",value:{name:"signature",type:"function",raw:"(search: string) => Promise<any>",signature:{arguments:[{name:"search",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}},required:!1}},{key:"operator",value:{name:"string",nullable:!0,required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}],raw:"Array<Option>",required:!1}},{key:"renderOption",value:{name:"signature",type:"function",raw:"(item: any) => Option",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}},required:!1}},{key:"renderSearchQuery",value:{name:"signature",type:"function",raw:"(item: any) => Element<any> | string",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"union",raw:"Element<any> | string",elements:[{name:"Element",elements:[{name:"any"}],raw:"Element<any>"},{name:"string"}]}},required:!1}},{key:"searchQuery",value:{name:"string",required:!1}},{key:"type",value:{name:"string",required:!0}},{key:"value",value:{name:"any",nullable:!0,required:!0}}]}}],raw:"Array<Filter>"},description:""},onClear:{required:!1,flowType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onClick:{required:!0,flowType:{name:"signature",type:"function",raw:"(filter: Filter) => void",signature:{arguments:[{name:"filter",type:{name:"signature",type:"object",raw:`{
  collectionName?: 'string',
  key: string,
  label: string,
  onSearch?: (search: string) => Promise<any>,
  operator: ?string,
  options?: Array<Option>,
  renderOption?: (item: any) => Option,
  renderSearchQuery?: (item: any) => Element<any> | string,
  searchQuery?: string,
  type: string,
  value: ?any
}`,signature:{properties:[{key:"collectionName",value:{name:"literal",value:"'string'",required:!1}},{key:"key",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"onSearch",value:{name:"signature",type:"function",raw:"(search: string) => Promise<any>",signature:{arguments:[{name:"search",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}},required:!1}},{key:"operator",value:{name:"string",nullable:!0,required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}],raw:"Array<Option>",required:!1}},{key:"renderOption",value:{name:"signature",type:"function",raw:"(item: any) => Option",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}},required:!1}},{key:"renderSearchQuery",value:{name:"signature",type:"function",raw:"(item: any) => Element<any> | string",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"union",raw:"Element<any> | string",elements:[{name:"Element",elements:[{name:"any"}],raw:"Element<any>"},{name:"string"}]}},required:!1}},{key:"searchQuery",value:{name:"string",required:!1}},{key:"type",value:{name:"string",required:!0}},{key:"value",value:{name:"any",nullable:!0,required:!0}}]}}}],return:{name:"void"}}},description:""}}};const U="add",Y="csv-export",G="delete-all",be=s=>{var d;return d=class extends f.Component{constructor(e){super(e),this.state={modalDelete:!1,modalDeleteAll:!1,modalEdit:!1,modalFilter:!1,selectedItem:null}}getButtons(e){const r=[],{addButton:o={},csvExportButton:t={},deleteButton:i={},modal:y,selectable:p}=this.props;return o.location===e&&(o.onClick||y)&&!p&&r.push({render:this.renderAddButton.bind(this)}),i.location===e&&this.props.onDeleteAll&&!p&&r.push({render:this.renderDeleteAllButton.bind(this)}),t.location===e&&!p&&r.push({render:this.renderCsvExportButton.bind(this)}),r.push(...l.filter(this.props.buttons,h=>{let v=!1;return((h.location||"top")===e||!h.location&&o&&o.location===e)&&(v=!0),v})),r}onAddButton(){return this.props.addButton&&this.props.addButton.onClick?this.props.addButton.onClick():this.setState({modalEdit:!0})}onCopyButton(e){const r=this.props.onCopy?this.props.onCopy(e):l.omit(e,"id","uid");this.setState({selectedItem:r,modalEdit:!0})}onCsvExportButton(){const e=l.filter(this.props.columns,t=>!t.hidden);let r=`${l.map(e,t=>`"${t.label}"`).join(",")}
`;l.each(this.props.items,t=>{r=r.concat(`${e.map(i=>i.resolve?`"${i.resolve(t)}"`:t[i.name]?`"${t[i.name]}"`:"").join(",")}
`)});const o=document.createElement("a");o.setAttribute("href",`data:text/plain;charset=utf-8,${encodeURIComponent(r)}`),o.setAttribute("download",`${this.props.collectionName||"table"}.csv`),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}onDelete(){const{selectedItem:e}=this.state;return this.setState({selectedItem:null,modalDelete:!1}),this.props.onDelete(e)}onDeleteAll(){return this.setState({modalDeleteAll:!1}),this.props.onDeleteAll&&this.props.onDeleteAll()}onDeleteAllButton(){this.setState({modalDeleteAll:!0})}onDeleteButton(e){this.setState({selectedItem:e,modalDelete:!0})}onEditButton(e){this.setState({selectedItem:e,modalEdit:!0})}onFilterButton(){this.setState({modalFilter:!0})}onRemoveFilter(e){const{onChange:r,props:{item:o}}=this.props.filters;return r({filters:l.filter(o.filters,t=>t.uid!==e.uid)})}onSave(e){return this.props.onSave(e).then(()=>this.setState({modalEdit:!1,selectedItem:null}))}onSaveFilter(e){return this.props.filters?this.props.filters.onChange(e).then(()=>this.setState({modalFilter:!1})):null}render(){return n.jsxs("div",{className:`list ${this.props.className}`,children:[this.renderHeader(),n.jsx(s,{...this.props,actions:this.getActions(),renderEmptyMessage:this.renderEmptyMessage.bind(this)}),this.renderFooter(),this.renderEditModal(),this.renderDeleteModal(),this.renderDeleteAllModal(),this.renderFilterModal()]})}getActions(){return l.map(this.props.actions,e=>{let r={};return e.name==="edit"?r={icon:"edit outline",onClick:this.onEditButton.bind(this)}:e.name==="copy"?r={icon:"copy outline",onClick:this.onCopyButton.bind(this)}:e.name==="delete"&&(r={icon:"times circle outline",onClick:this.onDeleteButton.bind(this)}),l.defaults(e,r)})}renderAddButton(){return this.props.addButton?n.jsxs(g,{basic:this.props.addButton.basic!==!1,color:this.props.addButton.color,inverted:this.props.addButton.inverted,onClick:this.onAddButton.bind(this),secondary:this.props.addButton.secondary,children:[n.jsx(C,{name:"plus"}),this.props.addButton.content||u.t("List.buttons.add")]},U):null}renderButton(e,r){return e.render?e.render(r):e.accept&&!e.accept()?null:n.jsx(g,{...e},r)}renderCsvExportButton(){return this.props.csvExportButton?n.jsxs(g,{basic:this.props.csvExportButton.basic,color:this.props.csvExportButton.color,onClick:this.onCsvExportButton.bind(this),children:[n.jsx(C,{name:"download"}),u.t("List.buttons.csvExport")]},Y):null}renderDeleteAllButton(){return this.props.deleteButton?n.jsxs(g,{basic:!0,color:this.props.deleteButton.color,onClick:this.onDeleteAllButton.bind(this),children:[n.jsx(C,{name:"times"}),u.t("List.buttons.deleteAll")]},G):null}renderDeleteAllModal(){return this.state.modalDeleteAll?n.jsx(A,{content:u.t("List.deleteAllContent"),header:n.jsx(x,{icon:"trash alternate outline",content:u.t("List.deleteAllHeader")}),onCancel:()=>this.setState({modalDeleteAll:!1}),onConfirm:this.onDeleteAll.bind(this),open:!0}):null}renderDeleteModal(){if(!this.state.modalDelete)return null;const{selectedItem:e}=this.state,r=()=>this.setState({selectedItem:null,modalDelete:!1}),o=this.onDelete.bind(this);return this.props.renderDeleteModal?this.props.renderDeleteModal({selectedItem:e,onConfirm:o,onCancel:r}):n.jsx(A,{content:u.t("List.deleteContent"),header:n.jsx(x,{icon:"trash alternate outline",content:u.t("List.deleteHeader")}),onCancel:r,onConfirm:o,open:!0})}renderEditModal(){if(!this.props.modal||!this.state.modalEdit)return null;const{component:e,props:r}=this.props.modal;return n.jsx(S,{component:e,onClose:()=>this.setState({selectedItem:null,modalEdit:!1}),onSave:this.onSave.bind(this),item:this.state.selectedItem,...r})}renderEmptyMessage(){const{addButton:e={},modal:r}=this.props;return e.onClick||r?n.jsxs(H,{i18nKey:"List.emptyListAdd",children:["You haven't added any yet. Click",n.jsx("div",{className:"empty-button",children:this.renderAddButton()}),"to get started."]}):u.t("List.emptyList")}renderFilterButton(){return this.props.filters&&this.props.filters.component?n.jsx(g,{active:this.props.filters.active,"aria-label":"Filter",basic:!0,icon:"filter",onClick:this.onFilterButton.bind(this)}):null}renderFilterModal(){if(!this.props.filters||!this.state.modalFilter)return null;const{component:e,props:r}=this.props.filters;return n.jsx(S,{...r,component:e,onClose:()=>this.setState({modalFilter:!1}),onSave:this.onSaveFilter.bind(this)})}renderFooter(){let e=!1;const r=this.getButtons("bottom");r&&r.length&&(e=!0);const o=this.props.pages&&this.props.pages>1;o&&(e=!0);const t=this.props.count&&this.props.showRecordCount;return t&&(e=!0),e?n.jsx("div",{className:"footer",children:n.jsxs(m,{columns:2,children:[n.jsxs(m.Column,{textAlign:"left",children:[t?this.renderRecordCount():"",l.map(r,i=>i.render())]}),n.jsx(m.Column,{textAlign:"right",children:o?this.renderPagination():""})]})}):null}renderHeader(){let e=!1;const r=this.getButtons("top");r&&r.length&&(e=!0);const{filters:o,perPageOptions:t,renderListHeader:i,renderSearch:y,searchable:p}=this.props,h=o&&o.component,v=p&&y,k=i&&i();(h||t||k||v)&&(e=!0);const b=o&&o.showLabels&&!l.isEmpty(o.props.item.filters);return e?n.jsx("div",{className:"header",children:n.jsxs(m,{className:b?"filter-labels":void 0,verticalAlign:"top",children:[n.jsxs(m.Row,{columns:2,children:[n.jsx(m.Column,{textAlign:"left",children:l.map(r,this.renderButton.bind(this))}),n.jsx(m.Column,{textAlign:"right",children:n.jsxs(q,{compact:!0,borderless:!0,secondary:!0,className:"flex-end-menu",children:[k&&n.jsx(q.Menu,{className:"list-header-menu",children:k}),n.jsx(q.Menu,{children:o&&this.renderFilterButton()}),t&&n.jsx(q.Menu,{className:"per-page-menu",children:this.renderPerPage()}),n.jsx(q.Menu,{children:y&&y()})]})})]}),b&&n.jsx(m.Row,{columns:1,children:n.jsx(m.Column,{children:n.jsx(P,{filters:o.props.item.filters,onClear:()=>o.onChange({filters:[]}),onClick:D=>this.onRemoveFilter(D)})})})]})}):null}renderPagination(){return n.jsx(Q,{activePage:this.props.page,firstItem:null,lastItem:null,onPageChange:this.props.onPageChange.bind(this),size:"mini",totalPages:this.props.pages})}renderPerPage(){const{perPage:e}=this.props;return n.jsx(F,{basic:!0,icon:"list",onChange:this.props.onPerPageChange.bind(this),options:l.map(this.props.perPageOptions,r=>({key:r,value:r,text:r})),text:u.t("List.labels.perPage",{perPage:e}),value:e})}renderRecordCount(){const{count:e}=this.props;return n.jsx("p",{className:"record-count",children:`${Number(e).toLocaleString()} ${u.t("List.record",{count:e})}`})}},E(d,"defaultProps",{actions:[],addButton:{basic:!0,color:"green",location:"top"},buttons:[],className:"",csvExportButton:void 0,filters:void 0,modal:void 0,page:1,pages:1,onColumnClick:()=>{},onCopy:void 0,onPageChange:()=>{},renderDeleteModal:void 0,renderSearch:void 0,sortColumn:void 0,sortDirection:void 0}),d};export{c as F,K as L,a,be as u};
