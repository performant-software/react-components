var es=Object.defineProperty;var ns=(D,a,j)=>a in D?es(D,a,{enumerable:!0,configurable:!0,writable:!0,value:j}):D[a]=j;var ne=(D,a,j)=>(ns(D,typeof a!="symbol"?a+"":a,j),j),Be=(D,a,j)=>{if(!a.has(D))throw TypeError("Cannot "+j)};var t=(D,a,j)=>(Be(D,a,"read from private field"),j?j.call(D):a.get(D)),H=(D,a,j)=>{if(a.has(D))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(D):a.set(D,j)},rt=(D,a,j,i)=>(Be(D,a,"write to private field"),i?i.call(D,j):a.set(D,j),j);var me=(D,a,j,i)=>({set _(p){rt(D,a,p,j)},get _(){return t(D,a,i)}}),q=(D,a,j)=>(Be(D,a,"access private method"),j);import{j as jsxRuntimeExports}from"./jsx-runtime-D9TvR9R2.js";import{r as reactExports,R as React}from"./index-C0dDX-lL.js";import{g as getDefaultExportFromCjs}from"./_commonjsHelpers-BosuxZz1.js";import{c as commonjsRequire}from"./_commonjs-dynamic-modules-TDtrdbi3.js";import{r as require$$5}from"./___vite-browser-external_commonjs-proxy-DRaEfepn.js";import{r as requireDist,i as invariant}from"./tiny-invariant.cjs-DxxScMW_.js";import{V as Visibility,L as LazyLoader}from"./LazyLoader-DWAGao17.js";import{I as Icon}from"./Icon-C_3d7-zE.js";import{I as Image$1}from"./Label-aEFd48OX.js";import{L as Loader}from"./Loader-lqR_Ikjg.js";import{S as Segment}from"./Segment-BqjJDZFO.js";import{D as Dimmer}from"./Dimmer-DP3fvqlo.js";import{T as Transition}from"./Transition-HA1Bivu3.js";import{D as DownloadButton}from"./DownloadButton-CmhJFbem.js";import{P as PropTypes}from"./index-D3ylJrlI.js";function _mergeNamespaces(D,a){for(var j=0;j<a.length;j++){const i=a[j];if(typeof i!="string"&&!Array.isArray(i)){for(const p in i)if(p!=="default"&&!(p in D)){const V=Object.getOwnPropertyDescriptor(i,p);V&&Object.defineProperty(D,p,V.get?V:{enumerable:!0,get:()=>i[p]})}}}return Object.freeze(Object.defineProperty(D,Symbol.toStringTag,{value:"Module"}))}var warning=function(){},warning_1=warning;const warning$1=getDefaultExportFromCjs(warning_1);var pdf$1={exports:{}};(function(module,exports){(function(a,j){module.exports=a.pdfjsLib=j()})(globalThis,()=>(()=>{var __webpack_modules__=[,(D,a)=>{var Xt;Object.defineProperty(a,"__esModule",{value:!0}),a.VerbosityLevel=a.Util=a.UnknownErrorException=a.UnexpectedResponseException=a.TextRenderingMode=a.RenderingIntentFlag=a.PromiseCapability=a.PermissionFlag=a.PasswordResponses=a.PasswordException=a.PageActionEventType=a.OPS=a.MissingPDFException=a.MAX_IMAGE_SIZE_TO_CACHE=a.LINE_FACTOR=a.LINE_DESCENT_FACTOR=a.InvalidPDFException=a.ImageKind=a.IDENTITY_MATRIX=a.FormatError=a.FeatureTest=a.FONT_IDENTITY_MATRIX=a.DocumentActionEventType=a.CMapCompressionType=a.BaseException=a.BASELINE_FACTOR=a.AnnotationType=a.AnnotationReplyType=a.AnnotationPrefix=a.AnnotationMode=a.AnnotationFlag=a.AnnotationFieldFlag=a.AnnotationEditorType=a.AnnotationEditorPrefix=a.AnnotationEditorParamsType=a.AnnotationBorderStyleType=a.AnnotationActionEventType=a.AbortException=void 0,a.assert=ht,a.bytesToString=U,a.createValidAbsoluteUrl=St,a.getModificationDate=Ct,a.getUuid=$t,a.getVerbosityLevel=Y,a.info=it,a.isArrayBuffer=pt,a.isArrayEqual=Pt,a.isNodeJS=void 0,a.normalizeUnicode=zt,a.objectFromMap=ut,a.objectSize=at,a.setVerbosityLevel=T,a.shadow=wt,a.string32=tt,a.stringToBytes=st,a.stringToPDFString=mt,a.stringToUTF8String=et,a.unreachable=$,a.utf8StringToString=nt,a.warn=lt;const j=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");a.isNodeJS=j;const i=[1,0,0,1,0,0];a.IDENTITY_MATRIX=i;const p=[.001,0,0,.001,0,0];a.FONT_IDENTITY_MATRIX=p;const V=1e7;a.MAX_IMAGE_SIZE_TO_CACHE=V;const W=1.35;a.LINE_FACTOR=W;const dt=.35;a.LINE_DESCENT_FACTOR=dt;const F=dt/W;a.BASELINE_FACTOR=F;const C={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};a.RenderingIntentFlag=C;const m={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};a.AnnotationMode=m;const I="pdfjs_internal_editor_";a.AnnotationEditorPrefix=I;const O={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};a.AnnotationEditorType=O;const x={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};a.AnnotationEditorParamsType=x;const E={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};a.PermissionFlag=E;const v={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};a.TextRenderingMode=v;const f={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};a.ImageKind=f;const _={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};a.AnnotationType=_;const P={GROUP:"Group",REPLY:"R"};a.AnnotationReplyType=P;const w={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};a.AnnotationFlag=w;const A={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};a.AnnotationFieldFlag=A;const l={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};a.AnnotationBorderStyleType=l;const d={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};a.AnnotationActionEventType=d;const M={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};a.DocumentActionEventType=M;const b={O:"PageOpen",C:"PageClose"};a.PageActionEventType=b;const c={ERRORS:0,WARNINGS:1,INFOS:5};a.VerbosityLevel=c;const k={NONE:0,BINARY:1};a.CMapCompressionType=k;const g={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};a.OPS=g;const G={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};a.PasswordResponses=G;let z=c.WARNINGS;function T(ft){Number.isInteger(ft)&&(z=ft)}function Y(){return z}function it(ft){z>=c.INFOS&&console.log(`Info: ${ft}`)}function lt(ft){z>=c.WARNINGS&&console.log(`Warning: ${ft}`)}function $(ft){throw new Error(ft)}function ht(ft,Z){ft||$(Z)}function bt(ft){switch(ft==null?void 0:ft.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function St(ft,Z=null,K=null){if(!ft)return null;try{if(K&&typeof ft=="string"){if(K.addDefaultProtocol&&ft.startsWith("www.")){const vt=ft.match(/\./g);(vt==null?void 0:vt.length)>=2&&(ft=`http://${ft}`)}if(K.tryConvertEncoding)try{ft=et(ft)}catch{}}const _t=Z?new URL(ft,Z):new URL(ft);if(bt(_t))return _t}catch{}return null}function wt(ft,Z,K,_t=!1){return Object.defineProperty(ft,Z,{value:K,enumerable:!_t,configurable:!0,writable:!1}),K}const R=function(){function Z(K,_t){this.constructor===Z&&$("Cannot initialize BaseException."),this.message=K,this.name=_t}return Z.prototype=new Error,Z.constructor=Z,Z}();a.BaseException=R;class n extends R{constructor(Z,K){super(Z,"PasswordException"),this.code=K}}a.PasswordException=n;class o extends R{constructor(Z,K){super(Z,"UnknownErrorException"),this.details=K}}a.UnknownErrorException=o;class s extends R{constructor(Z){super(Z,"InvalidPDFException")}}a.InvalidPDFException=s;class h extends R{constructor(Z){super(Z,"MissingPDFException")}}a.MissingPDFException=h;class u extends R{constructor(Z,K){super(Z,"UnexpectedResponseException"),this.status=K}}a.UnexpectedResponseException=u;class S extends R{constructor(Z){super(Z,"FormatError")}}a.FormatError=S;class L extends R{constructor(Z){super(Z,"AbortException")}}a.AbortException=L;function U(ft){(typeof ft!="object"||(ft==null?void 0:ft.length)===void 0)&&$("Invalid argument for bytesToString");const Z=ft.length,K=8192;if(Z<K)return String.fromCharCode.apply(null,ft);const _t=[];for(let vt=0;vt<Z;vt+=K){const ee=Math.min(vt+K,Z),te=ft.subarray(vt,ee);_t.push(String.fromCharCode.apply(null,te))}return _t.join("")}function st(ft){typeof ft!="string"&&$("Invalid argument for stringToBytes");const Z=ft.length,K=new Uint8Array(Z);for(let _t=0;_t<Z;++_t)K[_t]=ft.charCodeAt(_t)&255;return K}function tt(ft){return String.fromCharCode(ft>>24&255,ft>>16&255,ft>>8&255,ft&255)}function at(ft){return Object.keys(ft).length}function ut(ft){const Z=Object.create(null);for(const[K,_t]of ft)Z[K]=_t;return Z}function gt(){const ft=new Uint8Array(4);return ft[0]=1,new Uint32Array(ft.buffer,0,1)[0]===1}function ct(){try{return new Function(""),!0}catch{return!1}}class Rt{static get isLittleEndian(){return wt(this,"isLittleEndian",gt())}static get isEvalSupported(){return wt(this,"isEvalSupported",ct())}static get isOffscreenCanvasSupported(){return wt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?wt(this,"platform",{isWin:!1,isMac:!1}):wt(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Z,K;return wt(this,"isCSSRoundSupported",(K=(Z=globalThis.CSS)==null?void 0:Z.supports)==null?void 0:K.call(Z,"width: round(1.5px, 1px)"))}}a.FeatureTest=Rt;const It=[...Array(256).keys()].map(ft=>ft.toString(16).padStart(2,"0"));class Et{static makeHexColor(Z,K,_t){return`#${It[Z]}${It[K]}${It[_t]}`}static scaleMinMax(Z,K){let _t;Z[0]?(Z[0]<0&&(_t=K[0],K[0]=K[1],K[1]=_t),K[0]*=Z[0],K[1]*=Z[0],Z[3]<0&&(_t=K[2],K[2]=K[3],K[3]=_t),K[2]*=Z[3],K[3]*=Z[3]):(_t=K[0],K[0]=K[2],K[2]=_t,_t=K[1],K[1]=K[3],K[3]=_t,Z[1]<0&&(_t=K[2],K[2]=K[3],K[3]=_t),K[2]*=Z[1],K[3]*=Z[1],Z[2]<0&&(_t=K[0],K[0]=K[1],K[1]=_t),K[0]*=Z[2],K[1]*=Z[2]),K[0]+=Z[4],K[1]+=Z[4],K[2]+=Z[5],K[3]+=Z[5]}static transform(Z,K){return[Z[0]*K[0]+Z[2]*K[1],Z[1]*K[0]+Z[3]*K[1],Z[0]*K[2]+Z[2]*K[3],Z[1]*K[2]+Z[3]*K[3],Z[0]*K[4]+Z[2]*K[5]+Z[4],Z[1]*K[4]+Z[3]*K[5]+Z[5]]}static applyTransform(Z,K){const _t=Z[0]*K[0]+Z[1]*K[2]+K[4],vt=Z[0]*K[1]+Z[1]*K[3]+K[5];return[_t,vt]}static applyInverseTransform(Z,K){const _t=K[0]*K[3]-K[1]*K[2],vt=(Z[0]*K[3]-Z[1]*K[2]+K[2]*K[5]-K[4]*K[3])/_t,ee=(-Z[0]*K[1]+Z[1]*K[0]+K[4]*K[1]-K[5]*K[0])/_t;return[vt,ee]}static getAxialAlignedBoundingBox(Z,K){const _t=this.applyTransform(Z,K),vt=this.applyTransform(Z.slice(2,4),K),ee=this.applyTransform([Z[0],Z[3]],K),te=this.applyTransform([Z[2],Z[1]],K);return[Math.min(_t[0],vt[0],ee[0],te[0]),Math.min(_t[1],vt[1],ee[1],te[1]),Math.max(_t[0],vt[0],ee[0],te[0]),Math.max(_t[1],vt[1],ee[1],te[1])]}static inverseTransform(Z){const K=Z[0]*Z[3]-Z[1]*Z[2];return[Z[3]/K,-Z[1]/K,-Z[2]/K,Z[0]/K,(Z[2]*Z[5]-Z[4]*Z[3])/K,(Z[4]*Z[1]-Z[5]*Z[0])/K]}static singularValueDecompose2dScale(Z){const K=[Z[0],Z[2],Z[1],Z[3]],_t=Z[0]*K[0]+Z[1]*K[2],vt=Z[0]*K[1]+Z[1]*K[3],ee=Z[2]*K[0]+Z[3]*K[2],te=Z[2]*K[1]+Z[3]*K[3],Q=(_t+te)/2,Tt=Math.sqrt((_t+te)**2-4*(_t*te-ee*vt))/2,Nt=Q+Tt||1,xt=Q-Tt||1;return[Math.sqrt(Nt),Math.sqrt(xt)]}static normalizeRect(Z){const K=Z.slice(0);return Z[0]>Z[2]&&(K[0]=Z[2],K[2]=Z[0]),Z[1]>Z[3]&&(K[1]=Z[3],K[3]=Z[1]),K}static intersect(Z,K){const _t=Math.max(Math.min(Z[0],Z[2]),Math.min(K[0],K[2])),vt=Math.min(Math.max(Z[0],Z[2]),Math.max(K[0],K[2]));if(_t>vt)return null;const ee=Math.max(Math.min(Z[1],Z[3]),Math.min(K[1],K[3])),te=Math.min(Math.max(Z[1],Z[3]),Math.max(K[1],K[3]));return ee>te?null:[_t,ee,vt,te]}static bezierBoundingBox(Z,K,_t,vt,ee,te,Q,Tt){const Nt=[],xt=[[],[]];let Bt,jt,Qt,At,Kt,Ot,N,e;for(let J=0;J<2;++J){if(J===0?(jt=6*Z-12*_t+6*ee,Bt=-3*Z+9*_t-9*ee+3*Q,Qt=3*_t-3*Z):(jt=6*K-12*vt+6*te,Bt=-3*K+9*vt-9*te+3*Tt,Qt=3*vt-3*K),Math.abs(Bt)<1e-12){if(Math.abs(jt)<1e-12)continue;At=-Qt/jt,0<At&&At<1&&Nt.push(At);continue}N=jt*jt-4*Qt*Bt,e=Math.sqrt(N),!(N<0)&&(Kt=(-jt+e)/(2*Bt),0<Kt&&Kt<1&&Nt.push(Kt),Ot=(-jt-e)/(2*Bt),0<Ot&&Ot<1&&Nt.push(Ot))}let y=Nt.length,B;const X=y;for(;y--;)At=Nt[y],B=1-At,xt[0][y]=B*B*B*Z+3*B*B*At*_t+3*B*At*At*ee+At*At*At*Q,xt[1][y]=B*B*B*K+3*B*B*At*vt+3*B*At*At*te+At*At*At*Tt;return xt[0][X]=Z,xt[1][X]=K,xt[0][X+1]=Q,xt[1][X+1]=Tt,xt[0].length=xt[1].length=X+2,[Math.min(...xt[0]),Math.min(...xt[1]),Math.max(...xt[0]),Math.max(...xt[1])]}}a.Util=Et;const Lt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function mt(ft){if(ft[0]>="ï"){let K;if(ft[0]==="þ"&&ft[1]==="ÿ"?K="utf-16be":ft[0]==="ÿ"&&ft[1]==="þ"?K="utf-16le":ft[0]==="ï"&&ft[1]==="»"&&ft[2]==="¿"&&(K="utf-8"),K)try{const _t=new TextDecoder(K,{fatal:!0}),vt=st(ft);return _t.decode(vt)}catch(_t){lt(`stringToPDFString: "${_t}".`)}}const Z=[];for(let K=0,_t=ft.length;K<_t;K++){const vt=Lt[ft.charCodeAt(K)];Z.push(vt?String.fromCharCode(vt):ft.charAt(K))}return Z.join("")}function et(ft){return decodeURIComponent(escape(ft))}function nt(ft){return unescape(encodeURIComponent(ft))}function pt(ft){return typeof ft=="object"&&(ft==null?void 0:ft.byteLength)!==void 0}function Pt(ft,Z){if(ft.length!==Z.length)return!1;for(let K=0,_t=ft.length;K<_t;K++)if(ft[K]!==Z[K])return!1;return!0}function Ct(ft=new Date){return[ft.getUTCFullYear().toString(),(ft.getUTCMonth()+1).toString().padStart(2,"0"),ft.getUTCDate().toString().padStart(2,"0"),ft.getUTCHours().toString().padStart(2,"0"),ft.getUTCMinutes().toString().padStart(2,"0"),ft.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ut{constructor(){H(this,Xt,!1);this.promise=new Promise((Z,K)=>{this.resolve=_t=>{rt(this,Xt,!0),Z(_t)},this.reject=_t=>{rt(this,Xt,!0),K(_t)}})}get settled(){return t(this,Xt)}}Xt=new WeakMap,a.PromiseCapability=Ut;let Vt=null,Ht=null;function zt(ft){return Vt||(Vt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ht=new Map([["ﬅ","ſt"]])),ft.replaceAll(Vt,(Z,K,_t)=>K?K.normalize("NFKC"):Ht.get(_t))}function $t(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const ft=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(ft);else for(let Z=0;Z<32;Z++)ft[Z]=Math.floor(Math.random()*255);return U(ft)}const Wt="pdfjs_internal_id_";a.AnnotationPrefix=Wt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var D,j,i,p,de,W,Te,F,C,m,I,O,x,E,v,f,we,P,w,je,l,d;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(b){if(typeof b=="string"||b instanceof URL?b={url:b}:(0,_util.isArrayBuffer)(b)&&(b={data:b}),typeof b!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!b.url&&!b.data&&!b.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const c=new PDFDocumentLoadingTask,{docId:k}=c,g=b.url?getUrlProp(b.url):null,G=b.data?getDataProp(b.data):null,z=b.httpHeaders||null,T=b.withCredentials===!0,Y=b.password??null,it=b.range instanceof PDFDataRangeTransport?b.range:null,lt=Number.isInteger(b.rangeChunkSize)&&b.rangeChunkSize>0?b.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let $=b.worker instanceof PDFWorker?b.worker:null;const ht=b.verbosity,bt=typeof b.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(b.docBaseUrl)?b.docBaseUrl:null,St=typeof b.cMapUrl=="string"?b.cMapUrl:null,wt=b.cMapPacked!==!1,R=b.CMapReaderFactory||DefaultCMapReaderFactory,n=typeof b.standardFontDataUrl=="string"?b.standardFontDataUrl:null,o=b.StandardFontDataFactory||DefaultStandardFontDataFactory,s=b.stopAtErrors!==!0,h=Number.isInteger(b.maxImageSize)&&b.maxImageSize>-1?b.maxImageSize:-1,u=b.isEvalSupported!==!1,S=typeof b.isOffscreenCanvasSupported=="boolean"?b.isOffscreenCanvasSupported:!_util.isNodeJS,L=Number.isInteger(b.canvasMaxAreaInBytes)?b.canvasMaxAreaInBytes:-1,U=typeof b.disableFontFace=="boolean"?b.disableFontFace:_util.isNodeJS,st=b.fontExtraProperties===!0,tt=b.enableXfa===!0,at=b.ownerDocument||globalThis.document,ut=b.disableRange===!0,gt=b.disableStream===!0,ct=b.disableAutoFetch===!0,Rt=b.pdfBug===!0,It=it?it.length:b.length??NaN,Et=typeof b.useSystemFonts=="boolean"?b.useSystemFonts:!_util.isNodeJS&&!U,Lt=typeof b.useWorkerFetch=="boolean"?b.useWorkerFetch:R===_display_utils.DOMCMapReaderFactory&&o===_display_utils.DOMStandardFontDataFactory&&St&&n&&(0,_display_utils.isValidFetchUrl)(St,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(n,document.baseURI),mt=b.canvasFactory||new DefaultCanvasFactory({ownerDocument:at}),et=b.filterFactory||new DefaultFilterFactory({docId:k,ownerDocument:at}),nt=null;(0,_util.setVerbosityLevel)(ht);const pt={canvasFactory:mt,filterFactory:et};if(Lt||(pt.cMapReaderFactory=new R({baseUrl:St,isCompressed:wt}),pt.standardFontDataFactory=new o({baseUrl:n})),!$){const Ut={verbosity:ht,port:_worker_options.GlobalWorkerOptions.workerPort};$=Ut.port?PDFWorker.fromPort(Ut):new PDFWorker(Ut),c._worker=$}const Pt={docId:k,apiVersion:"3.11.174",data:G,password:Y,disableAutoFetch:ct,rangeChunkSize:lt,length:It,docBaseUrl:bt,enableXfa:tt,evaluatorOptions:{maxImageSize:h,disableFontFace:U,ignoreErrors:s,isEvalSupported:u,isOffscreenCanvasSupported:S,canvasMaxAreaInBytes:L,fontExtraProperties:st,useSystemFonts:Et,cMapUrl:Lt?St:null,standardFontDataUrl:Lt?n:null}},Ct={ignoreErrors:s,isEvalSupported:u,disableFontFace:U,fontExtraProperties:st,enableXfa:tt,ownerDocument:at,disableAutoFetch:ct,pdfBug:Rt,styleElement:nt};return $.promise.then(function(){if(c.destroyed)throw new Error("Loading aborted");const Ut=_fetchDocument($,Pt),Vt=new Promise(function(Ht){let zt;it?zt=new _transport_stream.PDFDataTransportStream({length:It,initialData:it.initialData,progressiveDone:it.progressiveDone,contentDispositionFilename:it.contentDispositionFilename,disableRange:ut,disableStream:gt},it):G||(zt=(Wt=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Wt):(0,_display_utils.isValidFetchUrl)(Wt.url)?new _displayFetch_stream.PDFFetchStream(Wt):new _displayNetwork.PDFNetworkStream(Wt))({url:g,length:It,httpHeaders:z,withCredentials:T,rangeChunkSize:lt,disableRange:ut,disableStream:gt})),Ht(zt)});return Promise.all([Ut,Vt]).then(function([Ht,zt]){if(c.destroyed)throw new Error("Loading aborted");const $t=new _message_handler.MessageHandler(k,Ht,$.port),Wt=new WorkerTransport($t,c,zt,Ct,pt);c._transport=Wt,$t.send("Ready",null)})}).catch(c._capability.reject),c}async function _fetchDocument(b,c){if(b.destroyed)throw new Error("Worker was destroyed");const k=await b.messageHandler.sendWithPromise("GetDocRequest",c,c.data?[c.data.buffer]:null);if(b.destroyed)throw new Error("Worker was destroyed");return k}function getUrlProp(b){if(b instanceof URL)return b.href;try{return new URL(b,window.location).href}catch{if(_util.isNodeJS&&typeof b=="string")return b}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(b){if(_util.isNodeJS&&typeof Buffer<"u"&&b instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(b instanceof Uint8Array&&b.byteLength===b.buffer.byteLength)return b;if(typeof b=="string")return(0,_util.stringToBytes)(b);if(typeof b=="object"&&!isNaN(b==null?void 0:b.length)||(0,_util.isArrayBuffer)(b))return new Uint8Array(b);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const a=class a{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${me(a,D)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var c,k,g;this.destroyed=!0;try{(c=this._worker)!=null&&c.port&&(this._worker._pendingDestroy=!0),await((k=this._transport)==null?void 0:k.destroy())}catch(G){throw(g=this._worker)!=null&&g.port&&delete this._worker._pendingDestroy,G}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};D=new WeakMap,H(a,D,0);let PDFDocumentLoadingTask=a;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(c,k,g=!1,G=null){this.length=c,this.initialData=k,this.progressiveDone=g,this.contentDispositionFilename=G,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(c){this._rangeListeners.push(c)}addProgressListener(c){this._progressListeners.push(c)}addProgressiveReadListener(c){this._progressiveReadListeners.push(c)}addProgressiveDoneListener(c){this._progressiveDoneListeners.push(c)}onDataRange(c,k){for(const g of this._rangeListeners)g(c,k)}onDataProgress(c,k){this._readyCapability.promise.then(()=>{for(const g of this._progressListeners)g(c,k)})}onDataProgressiveRead(c){this._readyCapability.promise.then(()=>{for(const k of this._progressiveReadListeners)k(c)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const c of this._progressiveDoneListeners)c()})}transportReady(){this._readyCapability.resolve()}requestDataRange(c,k){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(c,k){this._pdfInfo=c,this._transport=k,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(g=>{if(!g)return g;const G=[];for(const z in g)G.push(...g[z]);return G}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(c){return this._transport.getPage(c)}getPageIndex(c){return this._transport.getPageIndex(c)}getDestinations(){return this._transport.getDestinations()}getDestination(c){return this._transport.getDestination(c)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(c=!1){return this._transport.startCleanup(c||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(c,k,g,G=!1){H(this,p);H(this,W);H(this,j,null);H(this,i,!1);this._pageIndex=c,this._pageInfo=k,this._transport=g,this._stats=G?new _display_utils.StatTimer:null,this._pdfBug=G,this.commonObjs=g.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:c,rotation:k=this.rotate,offsetX:g=0,offsetY:G=0,dontFlip:z=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:c,rotation:k,offsetX:g,offsetY:G,dontFlip:z})}getAnnotations({intent:c="display"}={}){const k=this._transport.getRenderingIntent(c);return this._transport.getAnnotations(this._pageIndex,k.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var c;return((c=this._transport._htmlForXfa)==null?void 0:c.children[this._pageIndex])||null}render({canvasContext:c,viewport:k,intent:g="display",annotationMode:G=_util.AnnotationMode.ENABLE,transform:z=null,background:T=null,optionalContentConfigPromise:Y=null,annotationCanvasMap:it=null,pageColors:lt=null,printAnnotationStorage:$=null}){var o,s;(o=this._stats)==null||o.time("Overall");const ht=this._transport.getRenderingIntent(g,G,$);rt(this,i,!1),q(this,W,Te).call(this),Y||(Y=this._transport.getOptionalContentConfig());let bt=this._intentStates.get(ht.cacheKey);bt||(bt=Object.create(null),this._intentStates.set(ht.cacheKey,bt)),bt.streamReaderCancelTimeout&&(clearTimeout(bt.streamReaderCancelTimeout),bt.streamReaderCancelTimeout=null);const St=!!(ht.renderingIntent&_util.RenderingIntentFlag.PRINT);bt.displayReadyCapability||(bt.displayReadyCapability=new _util.PromiseCapability,bt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(s=this._stats)==null||s.time("Page Request"),this._pumpOperatorList(ht));const wt=h=>{var u,S;bt.renderTasks.delete(R),(this._maybeCleanupAfterRender||St)&&rt(this,i,!0),q(this,p,de).call(this,!St),h?(R.capability.reject(h),this._abortOperatorList({intentState:bt,reason:h instanceof Error?h:new Error(h)})):R.capability.resolve(),(u=this._stats)==null||u.timeEnd("Rendering"),(S=this._stats)==null||S.timeEnd("Overall")},R=new InternalRenderTask({callback:wt,params:{canvasContext:c,viewport:k,transform:z,background:T},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:it,operatorList:bt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!St,pdfBug:this._pdfBug,pageColors:lt});(bt.renderTasks||(bt.renderTasks=new Set)).add(R);const n=R.task;return Promise.all([bt.displayReadyCapability.promise,Y]).then(([h,u])=>{var S;if(this.destroyed){wt();return}(S=this._stats)==null||S.time("Rendering"),R.initializeGraphics({transparency:h,optionalContentConfig:u}),R.operatorListChanged()}).catch(wt),n}getOperatorList({intent:c="display",annotationMode:k=_util.AnnotationMode.ENABLE,printAnnotationStorage:g=null}={}){var it;function G(){T.operatorList.lastChunk&&(T.opListReadCapability.resolve(T.operatorList),T.renderTasks.delete(Y))}const z=this._transport.getRenderingIntent(c,k,g,!0);let T=this._intentStates.get(z.cacheKey);T||(T=Object.create(null),this._intentStates.set(z.cacheKey,T));let Y;return T.opListReadCapability||(Y=Object.create(null),Y.operatorListChanged=G,T.opListReadCapability=new _util.PromiseCapability,(T.renderTasks||(T.renderTasks=new Set)).add(Y),T.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(it=this._stats)==null||it.time("Page Request"),this._pumpOperatorList(z)),T.opListReadCapability.promise}streamTextContent({includeMarkedContent:c=!1,disableNormalization:k=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:c===!0,disableNormalization:k===!0},{highWaterMark:100,size(G){return G.items.length}})}getTextContent(c={}){if(this._transport._htmlForXfa)return this.getXfa().then(g=>_xfa_text.XfaText.textContent(g));const k=this.streamTextContent(c);return new Promise(function(g,G){function z(){T.read().then(function({value:it,done:lt}){if(lt){g(Y);return}Object.assign(Y.styles,it.styles),Y.items.push(...it.items),z()},G)}const T=k.getReader(),Y={items:[],styles:Object.create(null)};z()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const c=[];for(const k of this._intentStates.values())if(this._abortOperatorList({intentState:k,reason:new Error("Page was destroyed."),force:!0}),!k.opListReadCapability)for(const g of k.renderTasks)c.push(g.completed),g.cancel();return this.objs.clear(),rt(this,i,!1),q(this,W,Te).call(this),Promise.all(c)}cleanup(c=!1){rt(this,i,!0);const k=q(this,p,de).call(this,!1);return c&&k&&this._stats&&(this._stats=new _display_utils.StatTimer),k}_startRenderPage(c,k){var G,z;const g=this._intentStates.get(k);g&&((G=this._stats)==null||G.timeEnd("Page Request"),(z=g.displayReadyCapability)==null||z.resolve(c))}_renderPageChunk(c,k){for(let g=0,G=c.length;g<G;g++)k.operatorList.fnArray.push(c.fnArray[g]),k.operatorList.argsArray.push(c.argsArray[g]);k.operatorList.lastChunk=c.lastChunk,k.operatorList.separateAnnots=c.separateAnnots;for(const g of k.renderTasks)g.operatorListChanged();c.lastChunk&&q(this,p,de).call(this,!0)}_pumpOperatorList({renderingIntent:c,cacheKey:k,annotationStorageSerializable:g}){const{map:G,transfers:z}=g,Y=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:c,cacheKey:k,annotationStorage:G},z).getReader(),it=this._intentStates.get(k);it.streamReader=Y;const lt=()=>{Y.read().then(({value:$,done:ht})=>{if(ht){it.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk($,it),lt())},$=>{if(it.streamReader=null,!this._transport.destroyed){if(it.operatorList){it.operatorList.lastChunk=!0;for(const ht of it.renderTasks)ht.operatorListChanged();q(this,p,de).call(this,!0)}if(it.displayReadyCapability)it.displayReadyCapability.reject($);else if(it.opListReadCapability)it.opListReadCapability.reject($);else throw $}})};lt()}_abortOperatorList({intentState:c,reason:k,force:g=!1}){if(c.streamReader){if(c.streamReaderCancelTimeout&&(clearTimeout(c.streamReaderCancelTimeout),c.streamReaderCancelTimeout=null),!g){if(c.renderTasks.size>0)return;if(k instanceof _display_utils.RenderingCancelledException){let G=RENDERING_CANCELLED_TIMEOUT;k.extraDelay>0&&k.extraDelay<1e3&&(G+=k.extraDelay),c.streamReaderCancelTimeout=setTimeout(()=>{c.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:c,reason:k,force:!0})},G);return}}if(c.streamReader.cancel(new _util.AbortException(k.message)).catch(()=>{}),c.streamReader=null,!this._transport.destroyed){for(const[G,z]of this._intentStates)if(z===c){this._intentStates.delete(G);break}this.cleanup()}}}get stats(){return this._stats}}j=new WeakMap,i=new WeakMap,p=new WeakSet,de=function(c=!1){if(q(this,W,Te).call(this),!t(this,i)||this.destroyed)return!1;if(c)return rt(this,j,setTimeout(()=>{rt(this,j,null),q(this,p,de).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:k,operatorList:g}of this._intentStates.values())if(k.size>0||!g.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),rt(this,i,!1),!0},W=new WeakSet,Te=function(){t(this,j)&&(clearTimeout(t(this,j)),rt(this,j,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){H(this,F,new Set);H(this,C,Promise.resolve())}postMessage(c,k){const g={data:structuredClone(c,k?{transfer:k}:null)};t(this,C).then(()=>{for(const G of t(this,F))G.call(this,g)})}addEventListener(c,k){t(this,F).add(k)}removeEventListener(c,k){t(this,F).delete(k)}terminate(){t(this,F).clear()}}F=new WeakMap,C=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const b=(m=document==null?void 0:document.currentScript)==null?void 0:m.src;b&&(PDFWorkerUtil.fallbackWorkerSrc=b.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(b,c){let k;try{if(k=new URL(b),!k.origin||k.origin==="null")return!1}catch{return!1}const g=new URL(c,k);return k.origin===g.origin},PDFWorkerUtil.createCDNWrapper=function(b){const c=`importScripts("${b}");`;return URL.createObjectURL(new Blob([c]))}}const _PDFWorker=class _PDFWorker{constructor({name:b=null,port:c=null,verbosity:k=(0,_util.getVerbosityLevel)()}={}){var g;if(this.name=b,this.destroyed=!1,this.verbosity=k,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,c){if((g=t(_PDFWorker,I))!=null&&g.has(c))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,I)||rt(_PDFWorker,I,new WeakMap)).set(c,this),this._initializeFromPort(c);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(b){this._port=b,this._messageHandler=new _message_handler.MessageHandler("main","worker",b),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:b}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,b)||(b=PDFWorkerUtil.createCDNWrapper(new URL(b,window.location).href));const c=new Worker(b),k=new _message_handler.MessageHandler("main","worker",c),g=()=>{c.removeEventListener("error",G),k.destroy(),c.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},G=()=>{this._webWorker||g()};c.addEventListener("error",G),k.on("test",T=>{if(c.removeEventListener("error",G),this.destroyed){g();return}T?(this._messageHandler=k,this._port=c,this._webWorker=c,this._readyCapability.resolve(),k.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),k.destroy(),c.terminate())}),k.on("ready",T=>{if(c.removeEventListener("error",G),this.destroyed){g();return}try{z()}catch{this._setupFakeWorker()}});const z=()=>{const T=new Uint8Array;k.send("test",T,[T.buffer])};z();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(b=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const c=new LoopbackPort;this._port=c;const k=`fake${PDFWorkerUtil.fakeWorkerId++}`,g=new _message_handler.MessageHandler(k+"_worker",k,c);b.setup(g,c);const G=new _message_handler.MessageHandler(k,k+"_worker",c);this._messageHandler=G,this._readyCapability.resolve(),G.send("configure",{verbosity:this.verbosity})}).catch(b=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${b.message}".`))})}destroy(){var b;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(b=t(_PDFWorker,I))==null||b.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(b){var k;if(!(b!=null&&b.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const c=(k=t(this,I))==null?void 0:k.get(b.port);if(c){if(c._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return c}return new _PDFWorker(b)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var b;try{return((b=globalThis.pdfjsWorker)==null?void 0:b.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};I=new WeakMap,H(_PDFWorker,I,void 0);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(c,k,g,G,z){H(this,f);H(this,O,new Map);H(this,x,new Map);H(this,E,new Map);H(this,v,null);this.messageHandler=c,this.loadingTask=k,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:G.ownerDocument,styleElement:G.styleElement}),this._params=G,this.canvasFactory=z.canvasFactory,this.filterFactory=z.filterFactory,this.cMapReaderFactory=z.cMapReaderFactory,this.standardFontDataFactory=z.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=g,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(c,k=_util.AnnotationMode.ENABLE,g=null,G=!1){let z=_util.RenderingIntentFlag.DISPLAY,T=_annotation_storage.SerializableEmpty;switch(c){case"any":z=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":z=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${c}`)}switch(k){case _util.AnnotationMode.DISABLE:z+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:z+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:z+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,T=(z&_util.RenderingIntentFlag.PRINT&&g instanceof _annotation_storage.PrintAnnotationStorage?g:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${k}`)}return G&&(z+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:z,cacheKey:`${z}_${T.hash}`,annotationStorageSerializable:T}}destroy(){var g;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(g=t(this,v))==null||g.reject(new Error("Worker was destroyed during onPassword callback"));const c=[];for(const G of t(this,x).values())c.push(G._destroy());t(this,x).clear(),t(this,E).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const k=this.messageHandler.sendWithPromise("Terminate",null);return c.push(k),Promise.all(c).then(()=>{var G;this.commonObjs.clear(),this.fontLoader.clear(),t(this,O).clear(),this.filterFactory.destroy(),(G=this._networkStream)==null||G.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:c,loadingTask:k}=this;c.on("GetReader",(g,G)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=z=>{this._lastProgress={loaded:z.loaded,total:z.total}},G.onPull=()=>{this._fullReader.read().then(function({value:z,done:T}){if(T){G.close();return}(0,_util.assert)(z instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),G.enqueue(new Uint8Array(z),1,[z])}).catch(z=>{G.error(z)})},G.onCancel=z=>{this._fullReader.cancel(z),G.ready.catch(T=>{if(!this.destroyed)throw T})}}),c.on("ReaderHeadersReady",g=>{const G=new _util.PromiseCapability,z=this._fullReader;return z.headersReady.then(()=>{var T;(!z.isStreamingSupported||!z.isRangeSupported)&&(this._lastProgress&&((T=k.onProgress)==null||T.call(k,this._lastProgress)),z.onProgress=Y=>{var it;(it=k.onProgress)==null||it.call(k,{loaded:Y.loaded,total:Y.total})}),G.resolve({isStreamingSupported:z.isStreamingSupported,isRangeSupported:z.isRangeSupported,contentLength:z.contentLength})},G.reject),G.promise}),c.on("GetRangeReader",(g,G)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const z=this._networkStream.getRangeReader(g.begin,g.end);if(!z){G.close();return}G.onPull=()=>{z.read().then(function({value:T,done:Y}){if(Y){G.close();return}(0,_util.assert)(T instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),G.enqueue(new Uint8Array(T),1,[T])}).catch(T=>{G.error(T)})},G.onCancel=T=>{z.cancel(T),G.ready.catch(Y=>{if(!this.destroyed)throw Y})}}),c.on("GetDoc",({pdfInfo:g})=>{this._numPages=g.numPages,this._htmlForXfa=g.htmlForXfa,delete g.htmlForXfa,k._capability.resolve(new PDFDocumentProxy(g,this))}),c.on("DocException",function(g){let G;switch(g.name){case"PasswordException":G=new _util.PasswordException(g.message,g.code);break;case"InvalidPDFException":G=new _util.InvalidPDFException(g.message);break;case"MissingPDFException":G=new _util.MissingPDFException(g.message);break;case"UnexpectedResponseException":G=new _util.UnexpectedResponseException(g.message,g.status);break;case"UnknownErrorException":G=new _util.UnknownErrorException(g.message,g.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}k._capability.reject(G)}),c.on("PasswordRequest",g=>{if(rt(this,v,new _util.PromiseCapability),k.onPassword){const G=z=>{z instanceof Error?t(this,v).reject(z):t(this,v).resolve({password:z})};try{k.onPassword(G,g.code)}catch(z){t(this,v).reject(z)}}else t(this,v).reject(new _util.PasswordException(g.message,g.code));return t(this,v).promise}),c.on("DataLoaded",g=>{var G;(G=k.onProgress)==null||G.call(k,{loaded:g.length,total:g.length}),this.downloadInfoCapability.resolve(g)}),c.on("StartRenderPage",g=>{if(this.destroyed)return;t(this,x).get(g.pageIndex)._startRenderPage(g.transparency,g.cacheKey)}),c.on("commonobj",([g,G,z])=>{var T;if(!this.destroyed&&!this.commonObjs.has(g))switch(G){case"Font":const Y=this._params;if("error"in z){const $=z.error;(0,_util.warn)(`Error during font loading: ${$}`),this.commonObjs.resolve(g,$);break}const it=Y.pdfBug&&((T=globalThis.FontInspector)!=null&&T.enabled)?($,ht)=>globalThis.FontInspector.fontAdded($,ht):null,lt=new _font_loader.FontFaceObject(z,{isEvalSupported:Y.isEvalSupported,disableFontFace:Y.disableFontFace,ignoreErrors:Y.ignoreErrors,inspectFont:it});this.fontLoader.bind(lt).catch($=>c.sendWithPromise("FontFallback",{id:g})).finally(()=>{!Y.fontExtraProperties&&lt.data&&(lt.data=null),this.commonObjs.resolve(g,lt)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(g,z);break;default:throw new Error(`Got unknown common object type ${G}`)}}),c.on("obj",([g,G,z,T])=>{var it;if(this.destroyed)return;const Y=t(this,x).get(G);if(!Y.objs.has(g))switch(z){case"Image":if(Y.objs.resolve(g,T),T){let lt;if(T.bitmap){const{width:$,height:ht}=T;lt=$*ht*4}else lt=((it=T.data)==null?void 0:it.length)||0;lt>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Y._maybeCleanupAfterRender=!0)}break;case"Pattern":Y.objs.resolve(g,T);break;default:throw new Error(`Got unknown object type ${z}`)}}),c.on("DocProgress",g=>{var G;this.destroyed||(G=k.onProgress)==null||G.call(k,{loaded:g.loaded,total:g.total})}),c.on("FetchBuiltInCMap",g=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(g):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),c.on("FetchStandardFontData",g=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(g):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var g;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:c,transfers:k}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:c,filename:((g=this._fullReader)==null?void 0:g.filename)??null},k).finally(()=>{this.annotationStorage.resetModified()})}getPage(c){if(!Number.isInteger(c)||c<=0||c>this._numPages)return Promise.reject(new Error("Invalid page request."));const k=c-1,g=t(this,E).get(k);if(g)return g;const G=this.messageHandler.sendWithPromise("GetPage",{pageIndex:k}).then(z=>{if(this.destroyed)throw new Error("Transport destroyed");const T=new PDFPageProxy(k,z,this,this._params.pdfBug);return t(this,x).set(k,T),T});return t(this,E).set(k,G),G}getPageIndex(c){return typeof c!="object"||c===null||!Number.isInteger(c.num)||c.num<0||!Number.isInteger(c.gen)||c.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:c.num,gen:c.gen})}getAnnotations(c,k){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:c,intent:k})}getFieldObjects(){return q(this,f,we).call(this,"GetFieldObjects")}hasJSActions(){return q(this,f,we).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(c){return typeof c!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:c})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return q(this,f,we).call(this,"GetDocJSActions")}getPageJSActions(c){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:c})}getStructTree(c){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:c})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(c=>new _optional_content_config.OptionalContentConfig(c))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const c="GetMetadata",k=t(this,O).get(c);if(k)return k;const g=this.messageHandler.sendWithPromise(c,null).then(G=>{var z,T;return{info:G[0],metadata:G[1]?new _metadata.Metadata(G[1]):null,contentDispositionFilename:((z=this._fullReader)==null?void 0:z.filename)??null,contentLength:((T=this._fullReader)==null?void 0:T.contentLength)??null}});return t(this,O).set(c,g),g}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(c=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const k of t(this,x).values())if(!k.cleanup())throw new Error(`startCleanup: Page ${k.pageNumber} is currently rendering.`);this.commonObjs.clear(),c||this.fontLoader.clear(),t(this,O).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:c,enableXfa:k}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:c,enableXfa:k})}}O=new WeakMap,x=new WeakMap,E=new WeakMap,v=new WeakMap,f=new WeakSet,we=function(c,k=null){const g=t(this,O).get(c);if(g)return g;const G=this.messageHandler.sendWithPromise(c,k);return t(this,O).set(c,G),G};class PDFObjects{constructor(){H(this,w);H(this,P,Object.create(null))}get(c,k=null){if(k){const G=q(this,w,je).call(this,c);return G.capability.promise.then(()=>k(G.data)),null}const g=t(this,P)[c];if(!(g!=null&&g.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${c}.`);return g.data}has(c){const k=t(this,P)[c];return(k==null?void 0:k.capability.settled)||!1}resolve(c,k=null){const g=q(this,w,je).call(this,c);g.data=k,g.capability.resolve()}clear(){var c;for(const k in t(this,P)){const{data:g}=t(this,P)[k];(c=g==null?void 0:g.bitmap)==null||c.close()}rt(this,P,Object.create(null))}}P=new WeakMap,w=new WeakSet,je=function(c){var k;return(k=t(this,P))[c]||(k[c]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(c){H(this,l,null);rt(this,l,c),this.onContinue=null}get promise(){return t(this,l).capability.promise}cancel(c=0){t(this,l).cancel(null,c)}get separateAnnots(){const{separateAnnots:c}=t(this,l).operatorList;if(!c)return!1;const{annotationCanvasMap:k}=t(this,l);return c.form||c.canvas&&(k==null?void 0:k.size)>0}}l=new WeakMap,exports.RenderTask=RenderTask;const M=class M{constructor({callback:c,params:k,objs:g,commonObjs:G,annotationCanvasMap:z,operatorList:T,pageIndex:Y,canvasFactory:it,filterFactory:lt,useRequestAnimationFrame:$=!1,pdfBug:ht=!1,pageColors:bt=null}){this.callback=c,this.params=k,this.objs=g,this.commonObjs=G,this.annotationCanvasMap=z,this.operatorListIdx=null,this.operatorList=T,this._pageIndex=Y,this.canvasFactory=it,this.filterFactory=lt,this._pdfBug=ht,this.pageColors=bt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=$===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=k.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:c=!1,optionalContentConfig:k}){var Y,it;if(this.cancelled)return;if(this._canvas){if(t(M,d).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(M,d).add(this._canvas)}this._pdfBug&&((Y=globalThis.StepperManager)!=null&&Y.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:g,viewport:G,transform:z,background:T}=this.params;this.gfx=new _canvas.CanvasGraphics(g,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:k},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:z,viewport:G,transparency:c,background:T}),this.operatorListIdx=0,this.graphicsReady=!0,(it=this.graphicsReadyCallback)==null||it.call(this)}cancel(c=null,k=0){var g;this.running=!1,this.cancelled=!0,(g=this.gfx)==null||g.endDrawing(),t(M,d).delete(this._canvas),this.callback(c||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,k))}operatorListChanged(){var c;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(c=this.stepper)==null||c.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(M,d).delete(this._canvas),this.callback())))}};d=new WeakMap,H(M,d,new WeakSet);let InternalRenderTask=M;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(D,a,j)=>{var C,m,I,vn,x;Object.defineProperty(a,"__esModule",{value:!0}),a.SerializableEmpty=a.PrintAnnotationStorage=a.AnnotationStorage=void 0;var i=j(1),p=j(4),V=j(8);const W=Object.freeze({map:null,hash:"",transfers:void 0});a.SerializableEmpty=W;class dt{constructor(){H(this,I);H(this,C,!1);H(this,m,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(v,f){const _=t(this,m).get(v);return _===void 0?f:Object.assign(f,_)}getRawValue(v){return t(this,m).get(v)}remove(v){if(t(this,m).delete(v),t(this,m).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const f of t(this,m).values())if(f instanceof p.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(v,f){const _=t(this,m).get(v);let P=!1;if(_!==void 0)for(const[w,A]of Object.entries(f))_[w]!==A&&(P=!0,_[w]=A);else P=!0,t(this,m).set(v,f);P&&q(this,I,vn).call(this),f instanceof p.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(f.constructor._type)}has(v){return t(this,m).has(v)}getAll(){return t(this,m).size>0?(0,i.objectFromMap)(t(this,m)):null}setAll(v){for(const[f,_]of Object.entries(v))this.setValue(f,_)}get size(){return t(this,m).size}resetModified(){t(this,C)&&(rt(this,C,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new F(this)}get serializable(){if(t(this,m).size===0)return W;const v=new Map,f=new V.MurmurHash3_64,_=[],P=Object.create(null);let w=!1;for(const[A,l]of t(this,m)){const d=l instanceof p.AnnotationEditor?l.serialize(!1,P):l;d&&(v.set(A,d),f.update(`${A}:${JSON.stringify(d)}`),w||(w=!!d.bitmap))}if(w)for(const A of v.values())A.bitmap&&_.push(A.bitmap);return v.size>0?{map:v,hash:f.hexdigest(),transfers:_}:W}}C=new WeakMap,m=new WeakMap,I=new WeakSet,vn=function(){t(this,C)||(rt(this,C,!0),typeof this.onSetModified=="function"&&this.onSetModified())},a.AnnotationStorage=dt;class F extends dt{constructor(f){super();H(this,x,void 0);const{map:_,hash:P,transfers:w}=f.serializable,A=structuredClone(_,w?{transfer:w}:null);rt(this,x,{map:A,hash:P,transfers:w})}get print(){(0,i.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,x)}}x=new WeakMap,a.PrintAnnotationStorage=F},(D,a,j)=>{var F,C,m,I,O,x,E,v,f,_,P,w,A,l,d,Ue,b,He,k,We,G,Ge,T,En,it,Sn,$,Tn,bt,$e,wt,wn;Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationEditor=void 0;var i=j(5),p=j(1),V=j(6);const n=class n{constructor(s){H(this,d);H(this,b);H(this,G);H(this,T);H(this,it);H(this,$);H(this,bt);H(this,wt);H(this,F,"");H(this,C,!1);H(this,m,null);H(this,I,null);H(this,O,null);H(this,x,!1);H(this,E,null);H(this,v,this.focusin.bind(this));H(this,f,this.focusout.bind(this));H(this,_,!1);H(this,P,!1);H(this,w,!1);ne(this,"_initialOptions",Object.create(null));ne(this,"_uiManager",null);ne(this,"_focusEventsAllowed",!0);ne(this,"_l10nPromise",null);H(this,A,!1);H(this,l,n._zIndex++);this.constructor===n&&(0,p.unreachable)("Cannot initialize AnnotationEditor."),this.parent=s.parent,this.id=s.id,this.width=this.height=null,this.pageIndex=s.parent.pageIndex,this.name=s.name,this.div=null,this._uiManager=s.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=s.isCentered,this._structTreeParentId=null;const{rotation:h,rawDims:{pageWidth:u,pageHeight:S,pageX:L,pageY:U}}=this.parent.viewport;this.rotation=h,this.pageRotation=(360+h-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[u,S],this.pageTranslation=[L,U];const[st,tt]=this.parentDimensions;this.x=s.x/st,this.y=s.y/tt,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,p.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(s){const h=new dt({id:s.parent.getNextId(),parent:s.parent,uiManager:s._uiManager});h.annotationElementId=s.annotationElementId,h.deleted=!0,h._uiManager.addToAnnotationStorage(h)}static initialize(s,h=null){if(n._l10nPromise||(n._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(S=>[S,s.get(S)]))),h!=null&&h.strings)for(const S of h.strings)n._l10nPromise.set(S,s.get(S));if(n._borderLineWidth!==-1)return;const u=getComputedStyle(document.documentElement);n._borderLineWidth=parseFloat(u.getPropertyValue("--outline-width"))||0}static updateDefaultParams(s,h){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(s){return!1}static paste(s,h){(0,p.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,A)}set _isDraggable(s){var h;rt(this,A,s),(h=this.div)==null||h.classList.toggle("draggable",s)}center(){const[s,h]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*h/(s*2),this.y+=this.width*s/(h*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*h/(s*2),this.y-=this.width*s/(h*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(s){this._uiManager.addCommands(s)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,l)}setParent(s){s!==null&&(this.pageIndex=s.pageIndex,this.pageDimensions=s.pageDimensions),this.parent=s}focusin(s){this._focusEventsAllowed&&(t(this,_)?rt(this,_,!1):this.parent.setSelected(this))}focusout(s){var u;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const h=s.relatedTarget;h!=null&&h.closest(`#${this.id}`)||(s.preventDefault(),(u=this.parent)!=null&&u.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(s,h,u,S){const[L,U]=this.parentDimensions;[u,S]=this.screenToPageTranslation(u,S),this.x=(s+u)/L,this.y=(h+S)/U,this.fixAndSetPosition()}translate(s,h){q(this,d,Ue).call(this,this.parentDimensions,s,h)}translateInPage(s,h){q(this,d,Ue).call(this,this.pageDimensions,s,h),this.div.scrollIntoView({block:"nearest"})}drag(s,h){const[u,S]=this.parentDimensions;if(this.x+=s/u,this.y+=h/S,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:at,y:ut}=this.div.getBoundingClientRect();this.parent.findNewParent(this,at,ut)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:L,y:U}=this;const[st,tt]=q(this,b,He).call(this);L+=st,U+=tt,this.div.style.left=`${(100*L).toFixed(2)}%`,this.div.style.top=`${(100*U).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[s,h]=this.pageDimensions;let{x:u,y:S,width:L,height:U}=this;switch(L*=s,U*=h,u*=s,S*=h,this.rotation){case 0:u=Math.max(0,Math.min(s-L,u)),S=Math.max(0,Math.min(h-U,S));break;case 90:u=Math.max(0,Math.min(s-U,u)),S=Math.min(h,Math.max(L,S));break;case 180:u=Math.min(s,Math.max(L,u)),S=Math.min(h,Math.max(U,S));break;case 270:u=Math.min(s,Math.max(U,u)),S=Math.max(0,Math.min(h-L,S));break}this.x=u/=s,this.y=S/=h;const[st,tt]=q(this,b,He).call(this);u+=st,S+=tt;const{style:at}=this.div;at.left=`${(100*u).toFixed(2)}%`,at.top=`${(100*S).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(s,h){var u;return q(u=n,k,We).call(u,s,h,this.parentRotation)}pageTranslationToScreen(s,h){var u;return q(u=n,k,We).call(u,s,h,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:s,pageDimensions:[h,u]}=this,S=h*s,L=u*s;return p.FeatureTest.isCSSRoundSupported?[Math.round(S),Math.round(L)]:[S,L]}setDims(s,h){var L;const[u,S]=this.parentDimensions;this.div.style.width=`${(100*s/u).toFixed(2)}%`,t(this,x)||(this.div.style.height=`${(100*h/S).toFixed(2)}%`),(L=t(this,m))==null||L.classList.toggle("small",s<n.SMALL_EDITOR_SIZE||h<n.SMALL_EDITOR_SIZE)}fixDims(){const{style:s}=this.div,{height:h,width:u}=s,S=u.endsWith("%"),L=!t(this,x)&&h.endsWith("%");if(S&&L)return;const[U,st]=this.parentDimensions;S||(s.width=`${(100*parseFloat(u)/U).toFixed(2)}%`),!t(this,x)&&!L&&(s.height=`${(100*parseFloat(h)/st).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,m))return;const s=rt(this,m,document.createElement("button"));s.className="altText";const h=await n._l10nPromise.get("editor_alt_text_button_label");s.textContent=h,s.setAttribute("aria-label",h),s.tabIndex="0",s.addEventListener("contextmenu",V.noContextMenu),s.addEventListener("pointerdown",u=>u.stopPropagation()),s.addEventListener("click",u=>{u.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),s.addEventListener("keydown",u=>{u.target===s&&u.key==="Enter"&&(u.preventDefault(),this._uiManager.editAltText(this))}),q(this,bt,$e).call(this),this.div.append(s),n.SMALL_EDITOR_SIZE||(n.SMALL_EDITOR_SIZE=Math.min(128,Math.round(s.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,F),decorative:t(this,C)}}set altTextData({altText:s,decorative:h}){t(this,F)===s&&t(this,C)===h||(rt(this,F,s),rt(this,C,h),q(this,bt,$e).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,v)),this.div.addEventListener("focusout",t(this,f));const[s,h]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*h/s).toFixed(2)}%`,this.div.style.maxHeight=`${(100*s/h).toFixed(2)}%`);const[u,S]=this.getInitialTranslation();return this.translate(u,S),(0,i.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(s){const{isMac:h}=p.FeatureTest.platform;if(s.button!==0||s.ctrlKey&&h){s.preventDefault();return}rt(this,_,!0),q(this,wt,wn).call(this,s)}moveInDOM(){var s;(s=this.parent)==null||s.moveEditorInDOM(this)}_setParentAndPosition(s,h,u){s.changeParent(this),this.x=h,this.y=u,this.fixAndSetPosition()}getRect(s,h){const u=this.parentScale,[S,L]=this.pageDimensions,[U,st]=this.pageTranslation,tt=s/u,at=h/u,ut=this.x*S,gt=this.y*L,ct=this.width*S,Rt=this.height*L;switch(this.rotation){case 0:return[ut+tt+U,L-gt-at-Rt+st,ut+tt+ct+U,L-gt-at+st];case 90:return[ut+at+U,L-gt+tt+st,ut+at+Rt+U,L-gt+tt+ct+st];case 180:return[ut-tt-ct+U,L-gt+at+st,ut-tt+U,L-gt+at+Rt+st];case 270:return[ut-at-Rt+U,L-gt-tt-ct+st,ut-at+U,L-gt-tt+st];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(s,h){const[u,S,L,U]=s,st=L-u,tt=U-S;switch(this.rotation){case 0:return[u,h-U,st,tt];case 90:return[u,h-S,tt,st];case 180:return[L,h-S,st,tt];case 270:return[L,h-U,tt,st];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){rt(this,w,!0)}disableEditMode(){rt(this,w,!1)}isInEditMode(){return t(this,w)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var s,h;(s=this.div)==null||s.addEventListener("focusin",t(this,v)),(h=this.div)==null||h.addEventListener("focusout",t(this,f))}serialize(s=!1,h=null){(0,p.unreachable)("An editor must be serializable")}static deserialize(s,h,u){const S=new this.prototype.constructor({parent:h,id:h.getNextId(),uiManager:u});S.rotation=s.rotation;const[L,U]=S.pageDimensions,[st,tt,at,ut]=S.getRectInCurrentCoords(s.rect,U);return S.x=st/L,S.y=tt/U,S.width=at/L,S.height=ut/U,S}remove(){var s;this.div.removeEventListener("focusin",t(this,v)),this.div.removeEventListener("focusout",t(this,f)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(s=t(this,m))==null||s.remove(),rt(this,m,null),rt(this,I,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(q(this,T,En).call(this),t(this,E).classList.remove("hidden"))}select(){var s;this.makeResizable(),(s=this.div)==null||s.classList.add("selectedEditor")}unselect(){var s,h,u;(s=t(this,E))==null||s.classList.add("hidden"),(h=this.div)==null||h.classList.remove("selectedEditor"),(u=this.div)!=null&&u.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(s,h){}disableEditing(){t(this,m)&&(t(this,m).hidden=!0)}enableEditing(){t(this,m)&&(t(this,m).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,P)}set isEditing(s){rt(this,P,s),this.parent&&(s?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(s,h){rt(this,x,!0);const u=s/h,{style:S}=this.div;S.aspectRatio=u,S.height="auto"}static get MIN_SIZE(){return 16}};F=new WeakMap,C=new WeakMap,m=new WeakMap,I=new WeakMap,O=new WeakMap,x=new WeakMap,E=new WeakMap,v=new WeakMap,f=new WeakMap,_=new WeakMap,P=new WeakMap,w=new WeakMap,A=new WeakMap,l=new WeakMap,d=new WeakSet,Ue=function([s,h],u,S){[u,S]=this.screenToPageTranslation(u,S),this.x+=u/s,this.y+=S/h,this.fixAndSetPosition()},b=new WeakSet,He=function(){const[s,h]=this.parentDimensions,{_borderLineWidth:u}=n,S=u/s,L=u/h;switch(this.rotation){case 90:return[-S,L];case 180:return[S,L];case 270:return[S,-L];default:return[-S,-L]}},k=new WeakSet,We=function(s,h,u){switch(u){case 90:return[h,-s];case 180:return[-s,-h];case 270:return[-h,s];default:return[s,h]}},G=new WeakSet,Ge=function(s){switch(s){case 90:{const[h,u]=this.pageDimensions;return[0,-h/u,u/h,0]}case 180:return[-1,0,0,-1];case 270:{const[h,u]=this.pageDimensions;return[0,h/u,-u/h,0]}default:return[1,0,0,1]}},T=new WeakSet,En=function(){if(t(this,E))return;rt(this,E,document.createElement("div")),t(this,E).classList.add("resizers");const s=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||s.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const h of s){const u=document.createElement("div");t(this,E).append(u),u.classList.add("resizer",h),u.addEventListener("pointerdown",q(this,it,Sn).bind(this,h)),u.addEventListener("contextmenu",V.noContextMenu)}this.div.prepend(t(this,E))},it=new WeakSet,Sn=function(s,h){h.preventDefault();const{isMac:u}=p.FeatureTest.platform;if(h.button!==0||h.ctrlKey&&u)return;const S=q(this,$,Tn).bind(this,s),L=this._isDraggable;this._isDraggable=!1;const U={passive:!0,capture:!0};window.addEventListener("pointermove",S,U);const st=this.x,tt=this.y,at=this.width,ut=this.height,gt=this.parent.div.style.cursor,ct=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(h.target).cursor;const Rt=()=>{this._isDraggable=L,window.removeEventListener("pointerup",Rt),window.removeEventListener("blur",Rt),window.removeEventListener("pointermove",S,U),this.parent.div.style.cursor=gt,this.div.style.cursor=ct;const It=this.x,Et=this.y,Lt=this.width,mt=this.height;It===st&&Et===tt&&Lt===at&&mt===ut||this.addCommands({cmd:()=>{this.width=Lt,this.height=mt,this.x=It,this.y=Et;const[et,nt]=this.parentDimensions;this.setDims(et*Lt,nt*mt),this.fixAndSetPosition()},undo:()=>{this.width=at,this.height=ut,this.x=st,this.y=tt;const[et,nt]=this.parentDimensions;this.setDims(et*at,nt*ut),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",Rt),window.addEventListener("blur",Rt)},$=new WeakSet,Tn=function(s,h){const[u,S]=this.parentDimensions,L=this.x,U=this.y,st=this.width,tt=this.height,at=n.MIN_SIZE/u,ut=n.MIN_SIZE/S,gt=_t=>Math.round(_t*1e4)/1e4,ct=q(this,G,Ge).call(this,this.rotation),Rt=(_t,vt)=>[ct[0]*_t+ct[2]*vt,ct[1]*_t+ct[3]*vt],It=q(this,G,Ge).call(this,360-this.rotation),Et=(_t,vt)=>[It[0]*_t+It[2]*vt,It[1]*_t+It[3]*vt];let Lt,mt,et=!1,nt=!1;switch(s){case"topLeft":et=!0,Lt=(_t,vt)=>[0,0],mt=(_t,vt)=>[_t,vt];break;case"topMiddle":Lt=(_t,vt)=>[_t/2,0],mt=(_t,vt)=>[_t/2,vt];break;case"topRight":et=!0,Lt=(_t,vt)=>[_t,0],mt=(_t,vt)=>[0,vt];break;case"middleRight":nt=!0,Lt=(_t,vt)=>[_t,vt/2],mt=(_t,vt)=>[0,vt/2];break;case"bottomRight":et=!0,Lt=(_t,vt)=>[_t,vt],mt=(_t,vt)=>[0,0];break;case"bottomMiddle":Lt=(_t,vt)=>[_t/2,vt],mt=(_t,vt)=>[_t/2,0];break;case"bottomLeft":et=!0,Lt=(_t,vt)=>[0,vt],mt=(_t,vt)=>[_t,0];break;case"middleLeft":nt=!0,Lt=(_t,vt)=>[0,vt/2],mt=(_t,vt)=>[_t,vt/2];break}const pt=Lt(st,tt),Pt=mt(st,tt);let Ct=Rt(...Pt);const Ut=gt(L+Ct[0]),Vt=gt(U+Ct[1]);let Ht=1,zt=1,[$t,Wt]=this.screenToPageTranslation(h.movementX,h.movementY);if([$t,Wt]=Et($t/u,Wt/S),et){const _t=Math.hypot(st,tt);Ht=zt=Math.max(Math.min(Math.hypot(Pt[0]-pt[0]-$t,Pt[1]-pt[1]-Wt)/_t,1/st,1/tt),at/st,ut/tt)}else nt?Ht=Math.max(at,Math.min(1,Math.abs(Pt[0]-pt[0]-$t)))/st:zt=Math.max(ut,Math.min(1,Math.abs(Pt[1]-pt[1]-Wt)))/tt;const Xt=gt(st*Ht),ft=gt(tt*zt);Ct=Rt(...mt(Xt,ft));const Z=Ut-Ct[0],K=Vt-Ct[1];this.width=Xt,this.height=ft,this.x=Z,this.y=K,this.setDims(u*Xt,S*ft),this.fixAndSetPosition()},bt=new WeakSet,$e=async function(){var u;const s=t(this,m);if(!s)return;if(!t(this,F)&&!t(this,C)){s.classList.remove("done"),(u=t(this,I))==null||u.remove();return}n._l10nPromise.get("editor_alt_text_edit_button_label").then(S=>{s.setAttribute("aria-label",S)});let h=t(this,I);if(!h){rt(this,I,h=document.createElement("span")),h.className="tooltip",h.setAttribute("role","tooltip");const S=h.id=`alt-text-tooltip-${this.id}`;s.setAttribute("aria-describedby",S);const L=100;s.addEventListener("mouseenter",()=>{rt(this,O,setTimeout(()=>{rt(this,O,null),t(this,I).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},L))}),s.addEventListener("mouseleave",()=>{var U;clearTimeout(t(this,O)),rt(this,O,null),(U=t(this,I))==null||U.classList.remove("show")})}s.classList.add("done"),h.innerText=t(this,C)?await n._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,F),h.parentNode||s.append(h)},wt=new WeakSet,wn=function(s){if(!this._isDraggable)return;const h=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let u,S;h&&(u={passive:!0,capture:!0},S=U=>{const[st,tt]=this.screenToPageTranslation(U.movementX,U.movementY);this._uiManager.dragSelectedEditors(st,tt)},window.addEventListener("pointermove",S,u));const L=()=>{if(window.removeEventListener("pointerup",L),window.removeEventListener("blur",L),h&&window.removeEventListener("pointermove",S,u),rt(this,_,!1),!this._uiManager.endDragSession()){const{isMac:U}=p.FeatureTest.platform;s.ctrlKey&&!U||s.shiftKey||s.metaKey&&U?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",L),window.addEventListener("blur",L)},H(n,k),ne(n,"_borderLineWidth",-1),ne(n,"_colorManager",new i.ColorManager),ne(n,"_zIndex",1),ne(n,"SMALL_EDITOR_SIZE",0);let W=n;a.AnnotationEditor=W;class dt extends W{constructor(s){super(s),this.annotationElementId=s.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(D,a,j)=>{var x,E,v,f,_,Ve,A,l,d,M,b,Pn,g,G,z,T,Y,it,lt,$,ht,bt,St,wt,R,n,o,s,h,u,S,L,U,st,tt,at,ut,gt,ct,Rt,It,Et,Lt,mt,et,nt,pt,Cn,Ct,ze,Vt,Xe,zt,Pe,Wt,qe,ft,Ye,K,ae,vt,be,te,Rn,Tt,xn,xt,Ke,jt,ye,At,Je;Object.defineProperty(a,"__esModule",{value:!0}),a.KeyboardManager=a.CommandManager=a.ColorManager=a.AnnotationEditorUIManager=void 0,a.bindEvents=V,a.opacityToHex=W;var i=j(1),p=j(6);function V(N,e,y){for(const B of y)e.addEventListener(B,N[B].bind(N))}function W(N){return Math.round(Math.min(255,Math.max(1,255*N))).toString(16).padStart(2,"0")}class dt{constructor(){H(this,x,0)}getId(){return`${i.AnnotationEditorPrefix}${me(this,x)._++}`}}x=new WeakMap;const w=class w{constructor(){H(this,_);H(this,E,(0,i.getUuid)());H(this,v,0);H(this,f,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',B=new OffscreenCanvas(1,3).getContext("2d"),X=new Image;X.src=e;const J=X.decode().then(()=>(B.drawImage(X,0,0,1,1,0,0,1,3),new Uint32Array(B.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,i.shadow)(this,"_isSVGFittingCanvas",J)}async getFromFile(e){const{lastModified:y,name:B,size:X,type:J}=e;return q(this,_,Ve).call(this,`${y}_${B}_${X}_${J}`,e)}async getFromUrl(e){return q(this,_,Ve).call(this,e,e)}async getFromId(e){t(this,f)||rt(this,f,new Map);const y=t(this,f).get(e);return y?y.bitmap?(y.refCounter+=1,y):y.file?this.getFromFile(y.file):this.getFromUrl(y.url):null}getSvgUrl(e){const y=t(this,f).get(e);return y!=null&&y.isSvg?y.svgUrl:null}deleteId(e){t(this,f)||rt(this,f,new Map);const y=t(this,f).get(e);y&&(y.refCounter-=1,y.refCounter===0&&(y.bitmap=null))}isValidId(e){return e.startsWith(`image_${t(this,E)}_`)}};E=new WeakMap,v=new WeakMap,f=new WeakMap,_=new WeakSet,Ve=async function(e,y){t(this,f)||rt(this,f,new Map);let B=t(this,f).get(e);if(B===null)return null;if(B!=null&&B.bitmap)return B.refCounter+=1,B;try{B||(B={bitmap:null,id:`image_${t(this,E)}_${me(this,v)._++}`,refCounter:0,isSvg:!1});let X;if(typeof y=="string"){B.url=y;const J=await fetch(y);if(!J.ok)throw new Error(J.statusText);X=await J.blob()}else X=B.file=y;if(X.type==="image/svg+xml"){const J=w._isSVGFittingCanvas,ot=new FileReader,yt=new Image,Ft=new Promise((kt,qt)=>{yt.onload=()=>{B.bitmap=yt,B.isSvg=!0,kt()},ot.onload=async()=>{const Mt=B.svgUrl=ot.result;yt.src=await J?`${Mt}#svgView(preserveAspectRatio(none))`:Mt},yt.onerror=ot.onerror=qt});ot.readAsDataURL(X),await Ft}else B.bitmap=await createImageBitmap(X);B.refCounter=1}catch(X){console.error(X),B=null}return t(this,f).set(e,B),B&&t(this,f).set(B.id,B),B};let F=w;class C{constructor(e=128){H(this,A,[]);H(this,l,!1);H(this,d,void 0);H(this,M,-1);rt(this,d,e)}add({cmd:e,undo:y,mustExec:B,type:X=NaN,overwriteIfSameType:J=!1,keepUndo:ot=!1}){if(B&&e(),t(this,l))return;const yt={cmd:e,undo:y,type:X};if(t(this,M)===-1){t(this,A).length>0&&(t(this,A).length=0),rt(this,M,0),t(this,A).push(yt);return}if(J&&t(this,A)[t(this,M)].type===X){ot&&(yt.undo=t(this,A)[t(this,M)].undo),t(this,A)[t(this,M)]=yt;return}const Ft=t(this,M)+1;Ft===t(this,d)?t(this,A).splice(0,1):(rt(this,M,Ft),Ft<t(this,A).length&&t(this,A).splice(Ft)),t(this,A).push(yt)}undo(){t(this,M)!==-1&&(rt(this,l,!0),t(this,A)[t(this,M)].undo(),rt(this,l,!1),rt(this,M,t(this,M)-1))}redo(){t(this,M)<t(this,A).length-1&&(rt(this,M,t(this,M)+1),rt(this,l,!0),t(this,A)[t(this,M)].cmd(),rt(this,l,!1))}hasSomethingToUndo(){return t(this,M)!==-1}hasSomethingToRedo(){return t(this,M)<t(this,A).length-1}destroy(){rt(this,A,null)}}A=new WeakMap,l=new WeakMap,d=new WeakMap,M=new WeakMap,a.CommandManager=C;class m{constructor(e){H(this,b);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:y}=i.FeatureTest.platform;for(const[B,X,J={}]of e)for(const ot of B){const yt=ot.startsWith("mac+");y&&yt?(this.callbacks.set(ot.slice(4),{callback:X,options:J}),this.allKeys.add(ot.split("+").at(-1))):!y&&!yt&&(this.callbacks.set(ot,{callback:X,options:J}),this.allKeys.add(ot.split("+").at(-1)))}}exec(e,y){if(!this.allKeys.has(y.key))return;const B=this.callbacks.get(q(this,b,Pn).call(this,y));if(!B)return;const{callback:X,options:{bubbles:J=!1,args:ot=[],checker:yt=null}}=B;yt&&!yt(e,y)||(X.bind(e,...ot)(),J||(y.stopPropagation(),y.preventDefault()))}}b=new WeakSet,Pn=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const y=this.buffer.join("+");return this.buffer.length=0,y},a.KeyboardManager=m;const k=class k{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return(0,p.getColorValues)(e),(0,i.shadow)(this,"_colors",e)}convert(e){const y=(0,p.getRGB)(e);if(!window.matchMedia("(forced-colors: active)").matches)return y;for(const[B,X]of this._colors)if(X.every((J,ot)=>J===y[ot]))return k._colorsMapping.get(B);return y}getHexCode(e){const y=this._colors.get(e);return y?i.Util.makeHexColor(...y):e}};ne(k,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let I=k;a.ColorManager=I;const Ot=class Ot{constructor(e,y,B,X,J,ot){H(this,pt);H(this,Ct);H(this,Vt);H(this,zt);H(this,Wt);H(this,ft);H(this,K);H(this,vt);H(this,te);H(this,Tt);H(this,xt);H(this,jt);H(this,At);H(this,g,null);H(this,G,new Map);H(this,z,new Map);H(this,T,null);H(this,Y,null);H(this,it,new C);H(this,lt,0);H(this,$,new Set);H(this,ht,null);H(this,bt,null);H(this,St,new Set);H(this,wt,null);H(this,R,new dt);H(this,n,!1);H(this,o,!1);H(this,s,null);H(this,h,i.AnnotationEditorType.NONE);H(this,u,new Set);H(this,S,null);H(this,L,this.blur.bind(this));H(this,U,this.focus.bind(this));H(this,st,this.copy.bind(this));H(this,tt,this.cut.bind(this));H(this,at,this.paste.bind(this));H(this,ut,this.keydown.bind(this));H(this,gt,this.onEditingAction.bind(this));H(this,ct,this.onPageChanging.bind(this));H(this,Rt,this.onScaleChanging.bind(this));H(this,It,this.onRotationChanging.bind(this));H(this,Et,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});H(this,Lt,[0,0]);H(this,mt,null);H(this,et,null);H(this,nt,null);rt(this,et,e),rt(this,nt,y),rt(this,T,B),this._eventBus=X,this._eventBus._on("editingaction",t(this,gt)),this._eventBus._on("pagechanging",t(this,ct)),this._eventBus._on("scalechanging",t(this,Rt)),this._eventBus._on("rotationchanging",t(this,It)),rt(this,Y,J.annotationStorage),rt(this,wt,J.filterFactory),rt(this,S,ot),this.viewParameters={realScale:p.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const e=Ot.prototype,y=J=>{const{activeElement:ot}=document;return ot&&t(J,et).contains(ot)&&J.hasSomethingToControl()},B=this.TRANSLATE_SMALL,X=this.TRANSLATE_BIG;return(0,i.shadow)(this,"_keyboardManager",new m([[["ctrl+a","mac+meta+a"],e.selectAll],[["ctrl+z","mac+meta+z"],e.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-B,0],checker:y}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-X,0],checker:y}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[B,0],checker:y}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[X,0],checker:y}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-B],checker:y}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-X],checker:y}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,B],checker:y}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,X],checker:y}]]))}destroy(){q(this,zt,Pe).call(this),q(this,Ct,ze).call(this),this._eventBus._off("editingaction",t(this,gt)),this._eventBus._off("pagechanging",t(this,ct)),this._eventBus._off("scalechanging",t(this,Rt)),this._eventBus._off("rotationchanging",t(this,It));for(const e of t(this,z).values())e.destroy();t(this,z).clear(),t(this,G).clear(),t(this,St).clear(),rt(this,g,null),t(this,u).clear(),t(this,it).destroy(),t(this,T).destroy()}get hcmFilter(){return(0,i.shadow)(this,"hcmFilter",t(this,S)?t(this,wt).addHCMFilter(t(this,S).foreground,t(this,S).background):"none")}get direction(){return(0,i.shadow)(this,"direction",getComputedStyle(t(this,et)).direction)}editAltText(e){var y;(y=t(this,T))==null||y.editAltText(this,e)}onPageChanging({pageNumber:e}){rt(this,lt,e-1)}focusMainContainer(){t(this,et).focus()}findParent(e,y){for(const B of t(this,z).values()){const{x:X,y:J,width:ot,height:yt}=B.div.getBoundingClientRect();if(e>=X&&e<=X+ot&&y>=J&&y<=J+yt)return B}return null}disableUserSelect(e=!1){t(this,nt).classList.toggle("noUserSelect",e)}addShouldRescale(e){t(this,St).add(e)}removeShouldRescale(e){t(this,St).delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*p.PixelsPerInch.PDF_TO_CSS_UNITS;for(const y of t(this,St))y.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}addToAnnotationStorage(e){!e.isEmpty()&&t(this,Y)&&!t(this,Y).has(e.id)&&t(this,Y).setValue(e.id,e)}blur(){if(!this.hasSelection)return;const{activeElement:e}=document;for(const y of t(this,u))if(y.div.contains(e)){rt(this,s,[y,e]),y._focusEventsAllowed=!1;break}}focus(){if(!t(this,s))return;const[e,y]=t(this,s);rt(this,s,null),y.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),y.focus()}addEditListeners(){q(this,Vt,Xe).call(this),q(this,Wt,qe).call(this)}removeEditListeners(){q(this,zt,Pe).call(this),q(this,ft,Ye).call(this)}copy(e){var B;if(e.preventDefault(),(B=t(this,g))==null||B.commitOrRemove(),!this.hasSelection)return;const y=[];for(const X of t(this,u)){const J=X.serialize(!0);J&&y.push(J)}y.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(y))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();const{clipboardData:y}=e;for(const J of y.items)for(const ot of t(this,bt))if(ot.isHandlingMimeForPasting(J.type)){ot.paste(J,this.currentLayer);return}let B=y.getData("application/pdfjs");if(!B)return;try{B=JSON.parse(B)}catch(J){(0,i.warn)(`paste: "${J.message}".`);return}if(!Array.isArray(B))return;this.unselectAll();const X=this.currentLayer;try{const J=[];for(const Ft of B){const kt=X.deserialize(Ft);if(!kt)return;J.push(kt)}const ot=()=>{for(const Ft of J)q(this,xt,Ke).call(this,Ft);q(this,At,Je).call(this,J)},yt=()=>{for(const Ft of J)Ft.remove()};this.addCommands({cmd:ot,undo:yt,mustExec:!0})}catch(J){(0,i.warn)(`paste: "${J.message}".`)}}keydown(e){var y;(y=this.getActive())!=null&&y.shouldGetKeyboardEvents()||Ot._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","delete","selectAll"].includes(e.name)&&this[e.name]()}setEditingState(e){e?(q(this,pt,Cn).call(this),q(this,Vt,Xe).call(this),q(this,Wt,qe).call(this),q(this,K,ae).call(this,{isEditing:t(this,h)!==i.AnnotationEditorType.NONE,isEmpty:q(this,jt,ye).call(this),hasSomethingToUndo:t(this,it).hasSomethingToUndo(),hasSomethingToRedo:t(this,it).hasSomethingToRedo(),hasSelectedEditor:!1})):(q(this,Ct,ze).call(this),q(this,zt,Pe).call(this),q(this,ft,Ye).call(this),q(this,K,ae).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!t(this,bt)){rt(this,bt,e);for(const y of t(this,bt))q(this,vt,be).call(this,y.defaultPropertiesToUpdate)}}getId(){return t(this,R).getId()}get currentLayer(){return t(this,z).get(t(this,lt))}getLayer(e){return t(this,z).get(e)}get currentPageIndex(){return t(this,lt)}addLayer(e){t(this,z).set(e.pageIndex,e),t(this,n)?e.enable():e.disable()}removeLayer(e){t(this,z).delete(e.pageIndex)}updateMode(e,y=null){if(t(this,h)!==e){if(rt(this,h,e),e===i.AnnotationEditorType.NONE){this.setEditingState(!1),q(this,Tt,xn).call(this);return}this.setEditingState(!0),q(this,te,Rn).call(this),this.unselectAll();for(const B of t(this,z).values())B.updateMode(e);if(y){for(const B of t(this,G).values())if(B.annotationElementId===y){this.setSelected(B),B.enterInEditMode();break}}}}updateToolbar(e){e!==t(this,h)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,y){if(t(this,bt)){if(e===i.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(e);return}for(const B of t(this,u))B.updateParams(e,y);for(const B of t(this,bt))B.updateDefaultParams(e,y)}}enableWaiting(e=!1){if(t(this,o)!==e){rt(this,o,e);for(const y of t(this,z).values())e?y.disableClick():y.enableClick(),y.div.classList.toggle("waiting",e)}}getEditors(e){const y=[];for(const B of t(this,G).values())B.pageIndex===e&&y.push(B);return y}getEditor(e){return t(this,G).get(e)}addEditor(e){t(this,G).set(e.id,e)}removeEditor(e){var y;t(this,G).delete(e.id),this.unselect(e),(!e.annotationElementId||!t(this,$).has(e.annotationElementId))&&((y=t(this,Y))==null||y.remove(e.id))}addDeletedAnnotationElement(e){t(this,$).add(e.annotationElementId),e.deleted=!0}isDeletedAnnotationElement(e){return t(this,$).has(e)}removeDeletedAnnotationElement(e){t(this,$).delete(e.annotationElementId),e.deleted=!1}setActiveEditor(e){t(this,g)!==e&&(rt(this,g,e),e&&q(this,vt,be).call(this,e.propertiesToUpdate))}toggleSelected(e){if(t(this,u).has(e)){t(this,u).delete(e),e.unselect(),q(this,K,ae).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,u).add(e),e.select(),q(this,vt,be).call(this,e.propertiesToUpdate),q(this,K,ae).call(this,{hasSelectedEditor:!0})}setSelected(e){for(const y of t(this,u))y!==e&&y.unselect();t(this,u).clear(),t(this,u).add(e),e.select(),q(this,vt,be).call(this,e.propertiesToUpdate),q(this,K,ae).call(this,{hasSelectedEditor:!0})}isSelected(e){return t(this,u).has(e)}unselect(e){e.unselect(),t(this,u).delete(e),q(this,K,ae).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,u).size!==0}undo(){t(this,it).undo(),q(this,K,ae).call(this,{hasSomethingToUndo:t(this,it).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:q(this,jt,ye).call(this)})}redo(){t(this,it).redo(),q(this,K,ae).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,it).hasSomethingToRedo(),isEmpty:q(this,jt,ye).call(this)})}addCommands(e){t(this,it).add(e),q(this,K,ae).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:q(this,jt,ye).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...t(this,u)],y=()=>{for(const X of e)X.remove()},B=()=>{for(const X of e)q(this,xt,Ke).call(this,X)};this.addCommands({cmd:y,undo:B,mustExec:!0})}commitOrRemove(){var e;(e=t(this,g))==null||e.commitOrRemove()}hasSomethingToControl(){return t(this,g)||this.hasSelection}selectAll(){for(const e of t(this,u))e.commit();q(this,At,Je).call(this,t(this,G).values())}unselectAll(){if(t(this,g)){t(this,g).commitOrRemove();return}if(this.hasSelection){for(const e of t(this,u))e.unselect();t(this,u).clear(),q(this,K,ae).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,y,B=!1){if(B||this.commitOrRemove(),!this.hasSelection)return;t(this,Lt)[0]+=e,t(this,Lt)[1]+=y;const[X,J]=t(this,Lt),ot=[...t(this,u)],yt=1e3;t(this,mt)&&clearTimeout(t(this,mt)),rt(this,mt,setTimeout(()=>{rt(this,mt,null),t(this,Lt)[0]=t(this,Lt)[1]=0,this.addCommands({cmd:()=>{for(const Ft of ot)t(this,G).has(Ft.id)&&Ft.translateInPage(X,J)},undo:()=>{for(const Ft of ot)t(this,G).has(Ft.id)&&Ft.translateInPage(-X,-J)},mustExec:!1})},yt));for(const Ft of ot)Ft.translateInPage(e,y)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),rt(this,ht,new Map);for(const e of t(this,u))t(this,ht).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,ht))return!1;this.disableUserSelect(!1);const e=t(this,ht);rt(this,ht,null);let y=!1;for(const[{x:X,y:J,pageIndex:ot},yt]of e)yt.newX=X,yt.newY=J,yt.newPageIndex=ot,y||(y=X!==yt.savedX||J!==yt.savedY||ot!==yt.savedPageIndex);if(!y)return!1;const B=(X,J,ot,yt)=>{if(t(this,G).has(X.id)){const Ft=t(this,z).get(yt);Ft?X._setParentAndPosition(Ft,J,ot):(X.pageIndex=yt,X.x=J,X.y=ot)}};return this.addCommands({cmd:()=>{for(const[X,{newX:J,newY:ot,newPageIndex:yt}]of e)B(X,J,ot,yt)},undo:()=>{for(const[X,{savedX:J,savedY:ot,savedPageIndex:yt}]of e)B(X,J,ot,yt)},mustExec:!0}),!0}dragSelectedEditors(e,y){if(t(this,ht))for(const B of t(this,ht).keys())B.drag(e,y)}rebuild(e){if(e.parent===null){const y=this.getLayer(e.pageIndex);y?(y.changeParent(e),y.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}isActive(e){return t(this,g)===e}getActive(){return t(this,g)}getMode(){return t(this,h)}get imageManager(){return(0,i.shadow)(this,"imageManager",new F)}};g=new WeakMap,G=new WeakMap,z=new WeakMap,T=new WeakMap,Y=new WeakMap,it=new WeakMap,lt=new WeakMap,$=new WeakMap,ht=new WeakMap,bt=new WeakMap,St=new WeakMap,wt=new WeakMap,R=new WeakMap,n=new WeakMap,o=new WeakMap,s=new WeakMap,h=new WeakMap,u=new WeakMap,S=new WeakMap,L=new WeakMap,U=new WeakMap,st=new WeakMap,tt=new WeakMap,at=new WeakMap,ut=new WeakMap,gt=new WeakMap,ct=new WeakMap,Rt=new WeakMap,It=new WeakMap,Et=new WeakMap,Lt=new WeakMap,mt=new WeakMap,et=new WeakMap,nt=new WeakMap,pt=new WeakSet,Cn=function(){window.addEventListener("focus",t(this,U)),window.addEventListener("blur",t(this,L))},Ct=new WeakSet,ze=function(){window.removeEventListener("focus",t(this,U)),window.removeEventListener("blur",t(this,L))},Vt=new WeakSet,Xe=function(){window.addEventListener("keydown",t(this,ut),{capture:!0})},zt=new WeakSet,Pe=function(){window.removeEventListener("keydown",t(this,ut),{capture:!0})},Wt=new WeakSet,qe=function(){document.addEventListener("copy",t(this,st)),document.addEventListener("cut",t(this,tt)),document.addEventListener("paste",t(this,at))},ft=new WeakSet,Ye=function(){document.removeEventListener("copy",t(this,st)),document.removeEventListener("cut",t(this,tt)),document.removeEventListener("paste",t(this,at))},K=new WeakSet,ae=function(e){Object.entries(e).some(([B,X])=>t(this,Et)[B]!==X)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,Et),e)})},vt=new WeakSet,be=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},te=new WeakSet,Rn=function(){if(!t(this,n)){rt(this,n,!0);for(const e of t(this,z).values())e.enable()}},Tt=new WeakSet,xn=function(){if(this.unselectAll(),t(this,n)){rt(this,n,!1);for(const e of t(this,z).values())e.disable()}},xt=new WeakSet,Ke=function(e){const y=t(this,z).get(e.pageIndex);y?y.addOrRebuild(e):this.addEditor(e)},jt=new WeakSet,ye=function(){if(t(this,G).size===0)return!0;if(t(this,G).size===1)for(const e of t(this,G).values())return e.isEmpty();return!1},At=new WeakSet,Je=function(e){t(this,u).clear();for(const y of e)y.isEmpty()||(t(this,u).add(y),y.select());q(this,K,ae).call(this,{hasSelectedEditor:!0})},ne(Ot,"TRANSLATE_SMALL",1),ne(Ot,"TRANSLATE_BIG",10);let O=Ot;a.AnnotationEditorUIManager=O},(D,a,j)=>{var lt,$,ht,bt,St,wt,R,n,o,s,h,u,ue,L,fe,st,Qe,at,Ce,gt,Re,Rt,_e,Et,Ae;Object.defineProperty(a,"__esModule",{value:!0}),a.StatTimer=a.RenderingCancelledException=a.PixelsPerInch=a.PageViewport=a.PDFDateString=a.DOMStandardFontDataFactory=a.DOMSVGFactory=a.DOMFilterFactory=a.DOMCanvasFactory=a.DOMCMapReaderFactory=void 0,a.deprecated=M,a.getColorValues=G,a.getCurrentTransform=z,a.getCurrentTransformInverse=T,a.getFilenameFromUrl=_,a.getPdfFilenameFromUrl=P,a.getRGB=g,a.getXfaPageViewport=k,a.isDataScheme=v,a.isPdfFile=f,a.isValidFetchUrl=A,a.loadScript=d,a.noContextMenu=l,a.setLayerDimensions=Y;var i=j(7),p=j(1);const V="http://www.w3.org/2000/svg",it=class it{};ne(it,"CSS",96),ne(it,"PDF",72),ne(it,"PDF_TO_CSS_UNITS",it.CSS/it.PDF);let W=it;a.PixelsPerInch=W;class dt extends i.BaseFilterFactory{constructor({docId:nt,ownerDocument:pt=globalThis.document}={}){super();H(this,u);H(this,L);H(this,st);H(this,at);H(this,gt);H(this,Rt);H(this,Et);H(this,lt,void 0);H(this,$,void 0);H(this,ht,void 0);H(this,bt,void 0);H(this,St,void 0);H(this,wt,void 0);H(this,R,void 0);H(this,n,void 0);H(this,o,void 0);H(this,s,void 0);H(this,h,0);rt(this,ht,nt),rt(this,bt,pt)}addFilter(nt){if(!nt)return"none";let pt=t(this,u,ue).get(nt);if(pt)return pt;let Pt,Ct,Ut,Vt;if(nt.length===1){const Wt=nt[0],Xt=new Array(256);for(let ft=0;ft<256;ft++)Xt[ft]=Wt[ft]/255;Vt=Pt=Ct=Ut=Xt.join(",")}else{const[Wt,Xt,ft]=nt,Z=new Array(256),K=new Array(256),_t=new Array(256);for(let vt=0;vt<256;vt++)Z[vt]=Wt[vt]/255,K[vt]=Xt[vt]/255,_t[vt]=ft[vt]/255;Pt=Z.join(","),Ct=K.join(","),Ut=_t.join(","),Vt=`${Pt}${Ct}${Ut}`}if(pt=t(this,u,ue).get(Vt),pt)return t(this,u,ue).set(nt,pt),pt;const Ht=`g_${t(this,ht)}_transfer_map_${me(this,h)._++}`,zt=`url(#${Ht})`;t(this,u,ue).set(nt,zt),t(this,u,ue).set(Vt,zt);const $t=q(this,at,Ce).call(this,Ht);return q(this,Rt,_e).call(this,Pt,Ct,Ut,$t),zt}addHCMFilter(nt,pt){var Xt;const Pt=`${nt}-${pt}`;if(t(this,wt)===Pt)return t(this,R);if(rt(this,wt,Pt),rt(this,R,"none"),(Xt=t(this,St))==null||Xt.remove(),!nt||!pt)return t(this,R);const Ct=q(this,Et,Ae).call(this,nt);nt=p.Util.makeHexColor(...Ct);const Ut=q(this,Et,Ae).call(this,pt);if(pt=p.Util.makeHexColor(...Ut),t(this,L,fe).style.color="",nt==="#000000"&&pt==="#ffffff"||nt===pt)return t(this,R);const Vt=new Array(256);for(let ft=0;ft<=255;ft++){const Z=ft/255;Vt[ft]=Z<=.03928?Z/12.92:((Z+.055)/1.055)**2.4}const Ht=Vt.join(","),zt=`g_${t(this,ht)}_hcm_filter`,$t=rt(this,n,q(this,at,Ce).call(this,zt));q(this,Rt,_e).call(this,Ht,Ht,Ht,$t),q(this,st,Qe).call(this,$t);const Wt=(ft,Z)=>{const K=Ct[ft]/255,_t=Ut[ft]/255,vt=new Array(Z+1);for(let ee=0;ee<=Z;ee++)vt[ee]=K+ee/Z*(_t-K);return vt.join(",")};return q(this,Rt,_e).call(this,Wt(0,5),Wt(1,5),Wt(2,5),$t),rt(this,R,`url(#${zt})`),t(this,R)}addHighlightHCMFilter(nt,pt,Pt,Ct){var _t;const Ut=`${nt}-${pt}-${Pt}-${Ct}`;if(t(this,o)===Ut)return t(this,s);if(rt(this,o,Ut),rt(this,s,"none"),(_t=t(this,n))==null||_t.remove(),!nt||!pt)return t(this,s);const[Vt,Ht]=[nt,pt].map(q(this,Et,Ae).bind(this));let zt=Math.round(.2126*Vt[0]+.7152*Vt[1]+.0722*Vt[2]),$t=Math.round(.2126*Ht[0]+.7152*Ht[1]+.0722*Ht[2]),[Wt,Xt]=[Pt,Ct].map(q(this,Et,Ae).bind(this));$t<zt&&([zt,$t,Wt,Xt]=[$t,zt,Xt,Wt]),t(this,L,fe).style.color="";const ft=(vt,ee,te)=>{const Q=new Array(256),Tt=($t-zt)/te,Nt=vt/255,xt=(ee-vt)/(255*te);let Bt=0;for(let jt=0;jt<=te;jt++){const Qt=Math.round(zt+jt*Tt),At=Nt+jt*xt;for(let Kt=Bt;Kt<=Qt;Kt++)Q[Kt]=At;Bt=Qt+1}for(let jt=Bt;jt<256;jt++)Q[jt]=Q[Bt-1];return Q.join(",")},Z=`g_${t(this,ht)}_hcm_highlight_filter`,K=rt(this,n,q(this,at,Ce).call(this,Z));return q(this,st,Qe).call(this,K),q(this,Rt,_e).call(this,ft(Wt[0],Xt[0],5),ft(Wt[1],Xt[1],5),ft(Wt[2],Xt[2],5),K),rt(this,s,`url(#${Z})`),t(this,s)}destroy(nt=!1){nt&&(t(this,R)||t(this,s))||(t(this,$)&&(t(this,$).parentNode.parentNode.remove(),rt(this,$,null)),t(this,lt)&&(t(this,lt).clear(),rt(this,lt,null)),rt(this,h,0))}}lt=new WeakMap,$=new WeakMap,ht=new WeakMap,bt=new WeakMap,St=new WeakMap,wt=new WeakMap,R=new WeakMap,n=new WeakMap,o=new WeakMap,s=new WeakMap,h=new WeakMap,u=new WeakSet,ue=function(){return t(this,lt)||rt(this,lt,new Map)},L=new WeakSet,fe=function(){if(!t(this,$)){const nt=t(this,bt).createElement("div"),{style:pt}=nt;pt.visibility="hidden",pt.contain="strict",pt.width=pt.height=0,pt.position="absolute",pt.top=pt.left=0,pt.zIndex=-1;const Pt=t(this,bt).createElementNS(V,"svg");Pt.setAttribute("width",0),Pt.setAttribute("height",0),rt(this,$,t(this,bt).createElementNS(V,"defs")),nt.append(Pt),Pt.append(t(this,$)),t(this,bt).body.append(nt)}return t(this,$)},st=new WeakSet,Qe=function(nt){const pt=t(this,bt).createElementNS(V,"feColorMatrix");pt.setAttribute("type","matrix"),pt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),nt.append(pt)},at=new WeakSet,Ce=function(nt){const pt=t(this,bt).createElementNS(V,"filter");return pt.setAttribute("color-interpolation-filters","sRGB"),pt.setAttribute("id",nt),t(this,L,fe).append(pt),pt},gt=new WeakSet,Re=function(nt,pt,Pt){const Ct=t(this,bt).createElementNS(V,pt);Ct.setAttribute("type","discrete"),Ct.setAttribute("tableValues",Pt),nt.append(Ct)},Rt=new WeakSet,_e=function(nt,pt,Pt,Ct){const Ut=t(this,bt).createElementNS(V,"feComponentTransfer");Ct.append(Ut),q(this,gt,Re).call(this,Ut,"feFuncR",nt),q(this,gt,Re).call(this,Ut,"feFuncG",pt),q(this,gt,Re).call(this,Ut,"feFuncB",Pt)},Et=new WeakSet,Ae=function(nt){return t(this,L,fe).style.color=nt,g(getComputedStyle(t(this,L,fe)).getPropertyValue("color"))},a.DOMFilterFactory=dt;class F extends i.BaseCanvasFactory{constructor({ownerDocument:et=globalThis.document}={}){super(),this._document=et}_createCanvas(et,nt){const pt=this._document.createElement("canvas");return pt.width=et,pt.height=nt,pt}}a.DOMCanvasFactory=F;async function C(mt,et=!1){if(A(mt,document.baseURI)){const nt=await fetch(mt);if(!nt.ok)throw new Error(nt.statusText);return et?new Uint8Array(await nt.arrayBuffer()):(0,p.stringToBytes)(await nt.text())}return new Promise((nt,pt)=>{const Pt=new XMLHttpRequest;Pt.open("GET",mt,!0),et&&(Pt.responseType="arraybuffer"),Pt.onreadystatechange=()=>{if(Pt.readyState===XMLHttpRequest.DONE){if(Pt.status===200||Pt.status===0){let Ct;if(et&&Pt.response?Ct=new Uint8Array(Pt.response):!et&&Pt.responseText&&(Ct=(0,p.stringToBytes)(Pt.responseText)),Ct){nt(Ct);return}}pt(new Error(Pt.statusText))}},Pt.send(null)})}class m extends i.BaseCMapReaderFactory{_fetchData(et,nt){return C(et,this.isCompressed).then(pt=>({cMapData:pt,compressionType:nt}))}}a.DOMCMapReaderFactory=m;class I extends i.BaseStandardFontDataFactory{_fetchData(et){return C(et,!0)}}a.DOMStandardFontDataFactory=I;class O extends i.BaseSVGFactory{_createSVG(et){return document.createElementNS(V,et)}}a.DOMSVGFactory=O;class x{constructor({viewBox:et,scale:nt,rotation:pt,offsetX:Pt=0,offsetY:Ct=0,dontFlip:Ut=!1}){this.viewBox=et,this.scale=nt,this.rotation=pt,this.offsetX=Pt,this.offsetY=Ct;const Vt=(et[2]+et[0])/2,Ht=(et[3]+et[1])/2;let zt,$t,Wt,Xt;switch(pt%=360,pt<0&&(pt+=360),pt){case 180:zt=-1,$t=0,Wt=0,Xt=1;break;case 90:zt=0,$t=1,Wt=1,Xt=0;break;case 270:zt=0,$t=-1,Wt=-1,Xt=0;break;case 0:zt=1,$t=0,Wt=0,Xt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Ut&&(Wt=-Wt,Xt=-Xt);let ft,Z,K,_t;zt===0?(ft=Math.abs(Ht-et[1])*nt+Pt,Z=Math.abs(Vt-et[0])*nt+Ct,K=(et[3]-et[1])*nt,_t=(et[2]-et[0])*nt):(ft=Math.abs(Vt-et[0])*nt+Pt,Z=Math.abs(Ht-et[1])*nt+Ct,K=(et[2]-et[0])*nt,_t=(et[3]-et[1])*nt),this.transform=[zt*nt,$t*nt,Wt*nt,Xt*nt,ft-zt*nt*Vt-Wt*nt*Ht,Z-$t*nt*Vt-Xt*nt*Ht],this.width=K,this.height=_t}get rawDims(){const{viewBox:et}=this;return(0,p.shadow)(this,"rawDims",{pageWidth:et[2]-et[0],pageHeight:et[3]-et[1],pageX:et[0],pageY:et[1]})}clone({scale:et=this.scale,rotation:nt=this.rotation,offsetX:pt=this.offsetX,offsetY:Pt=this.offsetY,dontFlip:Ct=!1}={}){return new x({viewBox:this.viewBox.slice(),scale:et,rotation:nt,offsetX:pt,offsetY:Pt,dontFlip:Ct})}convertToViewportPoint(et,nt){return p.Util.applyTransform([et,nt],this.transform)}convertToViewportRectangle(et){const nt=p.Util.applyTransform([et[0],et[1]],this.transform),pt=p.Util.applyTransform([et[2],et[3]],this.transform);return[nt[0],nt[1],pt[0],pt[1]]}convertToPdfPoint(et,nt){return p.Util.applyInverseTransform([et,nt],this.transform)}}a.PageViewport=x;class E extends p.BaseException{constructor(et,nt=0){super(et,"RenderingCancelledException"),this.extraDelay=nt}}a.RenderingCancelledException=E;function v(mt){const et=mt.length;let nt=0;for(;nt<et&&mt[nt].trim()==="";)nt++;return mt.substring(nt,nt+5).toLowerCase()==="data:"}function f(mt){return typeof mt=="string"&&/\.pdf$/i.test(mt)}function _(mt,et=!1){return et||([mt]=mt.split(/[#?]/,1)),mt.substring(mt.lastIndexOf("/")+1)}function P(mt,et="document.pdf"){if(typeof mt!="string")return et;if(v(mt))return(0,p.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),et;const nt=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,pt=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Pt=nt.exec(mt);let Ct=pt.exec(Pt[1])||pt.exec(Pt[2])||pt.exec(Pt[3]);if(Ct&&(Ct=Ct[0],Ct.includes("%")))try{Ct=pt.exec(decodeURIComponent(Ct))[0]}catch{}return Ct||et}class w{constructor(){ne(this,"started",Object.create(null));ne(this,"times",[])}time(et){et in this.started&&(0,p.warn)(`Timer is already running for ${et}`),this.started[et]=Date.now()}timeEnd(et){et in this.started||(0,p.warn)(`Timer has not been started for ${et}`),this.times.push({name:et,start:this.started[et],end:Date.now()}),delete this.started[et]}toString(){const et=[];let nt=0;for(const{name:pt}of this.times)nt=Math.max(pt.length,nt);for(const{name:pt,start:Pt,end:Ct}of this.times)et.push(`${pt.padEnd(nt)} ${Ct-Pt}ms
`);return et.join("")}}a.StatTimer=w;function A(mt,et){try{const{protocol:nt}=et?new URL(mt,et):new URL(mt);return nt==="http:"||nt==="https:"}catch{return!1}}function l(mt){mt.preventDefault()}function d(mt,et=!1){return new Promise((nt,pt)=>{const Pt=document.createElement("script");Pt.src=mt,Pt.onload=function(Ct){et&&Pt.remove(),nt(Ct)},Pt.onerror=function(){pt(new Error(`Cannot load script at: ${Pt.src}`))},(document.head||document.documentElement).append(Pt)})}function M(mt){console.log("Deprecated API usage: "+mt)}let b;class c{static toDateObject(et){if(!et||typeof et!="string")return null;b||(b=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const nt=b.exec(et);if(!nt)return null;const pt=parseInt(nt[1],10);let Pt=parseInt(nt[2],10);Pt=Pt>=1&&Pt<=12?Pt-1:0;let Ct=parseInt(nt[3],10);Ct=Ct>=1&&Ct<=31?Ct:1;let Ut=parseInt(nt[4],10);Ut=Ut>=0&&Ut<=23?Ut:0;let Vt=parseInt(nt[5],10);Vt=Vt>=0&&Vt<=59?Vt:0;let Ht=parseInt(nt[6],10);Ht=Ht>=0&&Ht<=59?Ht:0;const zt=nt[7]||"Z";let $t=parseInt(nt[8],10);$t=$t>=0&&$t<=23?$t:0;let Wt=parseInt(nt[9],10)||0;return Wt=Wt>=0&&Wt<=59?Wt:0,zt==="-"?(Ut+=$t,Vt+=Wt):zt==="+"&&(Ut-=$t,Vt-=Wt),new Date(Date.UTC(pt,Pt,Ct,Ut,Vt,Ht))}}a.PDFDateString=c;function k(mt,{scale:et=1,rotation:nt=0}){const{width:pt,height:Pt}=mt.attributes.style,Ct=[0,0,parseInt(pt),parseInt(Pt)];return new x({viewBox:Ct,scale:et,rotation:nt})}function g(mt){if(mt.startsWith("#")){const et=parseInt(mt.slice(1),16);return[(et&16711680)>>16,(et&65280)>>8,et&255]}return mt.startsWith("rgb(")?mt.slice(4,-1).split(",").map(et=>parseInt(et)):mt.startsWith("rgba(")?mt.slice(5,-1).split(",").map(et=>parseInt(et)).slice(0,3):((0,p.warn)(`Not a valid color format: "${mt}"`),[0,0,0])}function G(mt){const et=document.createElement("span");et.style.visibility="hidden",document.body.append(et);for(const nt of mt.keys()){et.style.color=nt;const pt=window.getComputedStyle(et).color;mt.set(nt,g(pt))}et.remove()}function z(mt){const{a:et,b:nt,c:pt,d:Pt,e:Ct,f:Ut}=mt.getTransform();return[et,nt,pt,Pt,Ct,Ut]}function T(mt){const{a:et,b:nt,c:pt,d:Pt,e:Ct,f:Ut}=mt.getTransform().invertSelf();return[et,nt,pt,Pt,Ct,Ut]}function Y(mt,et,nt=!1,pt=!0){if(et instanceof x){const{pageWidth:Pt,pageHeight:Ct}=et.rawDims,{style:Ut}=mt,Vt=p.FeatureTest.isCSSRoundSupported,Ht=`var(--scale-factor) * ${Pt}px`,zt=`var(--scale-factor) * ${Ct}px`,$t=Vt?`round(${Ht}, 1px)`:`calc(${Ht})`,Wt=Vt?`round(${zt}, 1px)`:`calc(${zt})`;!nt||et.rotation%180===0?(Ut.width=$t,Ut.height=Wt):(Ut.width=Wt,Ut.height=$t)}pt&&mt.setAttribute("data-main-rotation",et.rotation)}},(D,a,j)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BaseStandardFontDataFactory=a.BaseSVGFactory=a.BaseFilterFactory=a.BaseCanvasFactory=a.BaseCMapReaderFactory=void 0;var i=j(1);class p{constructor(){this.constructor===p&&(0,i.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(m){return"none"}addHCMFilter(m,I){return"none"}addHighlightHCMFilter(m,I,O,x){return"none"}destroy(m=!1){}}a.BaseFilterFactory=p;class V{constructor(){this.constructor===V&&(0,i.unreachable)("Cannot initialize BaseCanvasFactory.")}create(m,I){if(m<=0||I<=0)throw new Error("Invalid canvas size");const O=this._createCanvas(m,I);return{canvas:O,context:O.getContext("2d")}}reset(m,I,O){if(!m.canvas)throw new Error("Canvas is not specified");if(I<=0||O<=0)throw new Error("Invalid canvas size");m.canvas.width=I,m.canvas.height=O}destroy(m){if(!m.canvas)throw new Error("Canvas is not specified");m.canvas.width=0,m.canvas.height=0,m.canvas=null,m.context=null}_createCanvas(m,I){(0,i.unreachable)("Abstract method `_createCanvas` called.")}}a.BaseCanvasFactory=V;class W{constructor({baseUrl:m=null,isCompressed:I=!0}){this.constructor===W&&(0,i.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=m,this.isCompressed=I}async fetch({name:m}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!m)throw new Error("CMap name must be specified.");const I=this.baseUrl+m+(this.isCompressed?".bcmap":""),O=this.isCompressed?i.CMapCompressionType.BINARY:i.CMapCompressionType.NONE;return this._fetchData(I,O).catch(x=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${I}`)})}_fetchData(m,I){(0,i.unreachable)("Abstract method `_fetchData` called.")}}a.BaseCMapReaderFactory=W;class dt{constructor({baseUrl:m=null}){this.constructor===dt&&(0,i.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=m}async fetch({filename:m}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!m)throw new Error("Font filename must be specified.");const I=`${this.baseUrl}${m}`;return this._fetchData(I).catch(O=>{throw new Error(`Unable to load font data at: ${I}`)})}_fetchData(m){(0,i.unreachable)("Abstract method `_fetchData` called.")}}a.BaseStandardFontDataFactory=dt;class F{constructor(){this.constructor===F&&(0,i.unreachable)("Cannot initialize BaseSVGFactory.")}create(m,I,O=!1){if(m<=0||I<=0)throw new Error("Invalid SVG dimensions");const x=this._createSVG("svg:svg");return x.setAttribute("version","1.1"),O||(x.setAttribute("width",`${m}px`),x.setAttribute("height",`${I}px`)),x.setAttribute("preserveAspectRatio","none"),x.setAttribute("viewBox",`0 0 ${m} ${I}`),x}createElement(m){if(typeof m!="string")throw new Error("Invalid SVG element type");return this._createSVG(m)}_createSVG(m){(0,i.unreachable)("Abstract method `_createSVG` called.")}}a.BaseSVGFactory=F},(D,a,j)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.MurmurHash3_64=void 0;var i=j(1);const p=3285377520,V=4294901760,W=65535;class dt{constructor(C){this.h1=C?C&4294967295:p,this.h2=C?C&4294967295:p}update(C){let m,I;if(typeof C=="string"){m=new Uint8Array(C.length*2),I=0;for(let M=0,b=C.length;M<b;M++){const c=C.charCodeAt(M);c<=255?m[I++]=c:(m[I++]=c>>>8,m[I++]=c&255)}}else if((0,i.isArrayBuffer)(C))m=C.slice(),I=m.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const O=I>>2,x=I-O*4,E=new Uint32Array(m.buffer,0,O);let v=0,f=0,_=this.h1,P=this.h2;const w=3432918353,A=461845907,l=w&W,d=A&W;for(let M=0;M<O;M++)M&1?(v=E[M],v=v*w&V|v*l&W,v=v<<15|v>>>17,v=v*A&V|v*d&W,_^=v,_=_<<13|_>>>19,_=_*5+3864292196):(f=E[M],f=f*w&V|f*l&W,f=f<<15|f>>>17,f=f*A&V|f*d&W,P^=f,P=P<<13|P>>>19,P=P*5+3864292196);switch(v=0,x){case 3:v^=m[O*4+2]<<16;case 2:v^=m[O*4+1]<<8;case 1:v^=m[O*4],v=v*w&V|v*l&W,v=v<<15|v>>>17,v=v*A&V|v*d&W,O&1?_^=v:P^=v}this.h1=_,this.h2=P}hexdigest(){let C=this.h1,m=this.h2;return C^=m>>>1,C=C*3981806797&V|C*36045&W,m=m*4283543511&V|((m<<16|C>>>16)*2950163797&V)>>>16,C^=m>>>1,C=C*444984403&V|C*60499&W,m=m*3301882366&V|((m<<16|C>>>16)*3120437893&V)>>>16,C^=m>>>1,(C>>>0).toString(16).padStart(8,"0")+(m>>>0).toString(16).padStart(8,"0")}}a.MurmurHash3_64=dt},(D,a,j)=>{var W;Object.defineProperty(a,"__esModule",{value:!0}),a.FontLoader=a.FontFaceObject=void 0;var i=j(1);class p{constructor({ownerDocument:F=globalThis.document,styleElement:C=null}){H(this,W,new Set);this._document=F,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(F){this.nativeFontFaces.add(F),this._document.fonts.add(F)}removeNativeFontFace(F){this.nativeFontFaces.delete(F),this._document.fonts.delete(F)}insertRule(F){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const C=this.styleElement.sheet;C.insertRule(F,C.cssRules.length)}clear(){for(const F of this.nativeFontFaces)this._document.fonts.delete(F);this.nativeFontFaces.clear(),t(this,W).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(F){if(!(!F||t(this,W).has(F.loadedName))){if((0,i.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:C,src:m,style:I}=F,O=new FontFace(C,m,I);this.addNativeFontFace(O);try{await O.load(),t(this,W).add(C)}catch{(0,i.warn)(`Cannot load system font: ${F.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(O)}return}(0,i.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(F){if(F.attached||F.missingFile&&!F.systemFontInfo)return;if(F.attached=!0,F.systemFontInfo){await this.loadSystemFont(F.systemFontInfo);return}if(this.isFontLoadingAPISupported){const m=F.createNativeFontFace();if(m){this.addNativeFontFace(m);try{await m.loaded}catch(I){throw(0,i.warn)(`Failed to load font '${m.family}': '${I}'.`),F.disableFontFace=!0,I}}return}const C=F.createFontFaceRule();if(C){if(this.insertRule(C),this.isSyncFontLoadingSupported)return;await new Promise(m=>{const I=this._queueLoadingCallback(m);this._prepareFontLoadEvent(F,I)})}}get isFontLoadingAPISupported(){var C;const F=!!((C=this._document)!=null&&C.fonts);return(0,i.shadow)(this,"isFontLoadingAPISupported",F)}get isSyncFontLoadingSupported(){let F=!1;return(i.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(F=!0),(0,i.shadow)(this,"isSyncFontLoadingSupported",F)}_queueLoadingCallback(F){function C(){for((0,i.assert)(!I.done,"completeRequest() cannot be called twice."),I.done=!0;m.length>0&&m[0].done;){const O=m.shift();setTimeout(O.callback,0)}}const{loadingRequests:m}=this,I={done:!1,complete:C,callback:F};return m.push(I),I}get _loadTestFont(){const F=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,i.shadow)(this,"_loadTestFont",F)}_prepareFontLoadEvent(F,C){function m(g,G){return g.charCodeAt(G)<<24|g.charCodeAt(G+1)<<16|g.charCodeAt(G+2)<<8|g.charCodeAt(G+3)&255}function I(g,G,z,T){const Y=g.substring(0,G),it=g.substring(G+z);return Y+T+it}let O,x;const E=this._document.createElement("canvas");E.width=1,E.height=1;const v=E.getContext("2d");let f=0;function _(g,G){if(++f>30){(0,i.warn)("Load test font never loaded."),G();return}if(v.font="30px "+g,v.fillText(".",0,20),v.getImageData(0,0,1,1).data[3]>0){G();return}setTimeout(_.bind(null,g,G))}const P=`lt${Date.now()}${this.loadTestFontId++}`;let w=this._loadTestFont;w=I(w,976,P.length,P);const l=16,d=1482184792;let M=m(w,l);for(O=0,x=P.length-3;O<x;O+=4)M=M-d+m(P,O)|0;O<P.length&&(M=M-d+m(P+"XXX",O)|0),w=I(w,l,4,(0,i.string32)(M));const b=`url(data:font/opentype;base64,${btoa(w)});`,c=`@font-face {font-family:"${P}";src:${b}}`;this.insertRule(c);const k=this._document.createElement("div");k.style.visibility="hidden",k.style.width=k.style.height="10px",k.style.position="absolute",k.style.top=k.style.left="0px";for(const g of[F.loadedName,P]){const G=this._document.createElement("span");G.textContent="Hi",G.style.fontFamily=g,k.append(G)}this._document.body.append(k),_(P,()=>{k.remove(),C.complete()})}}W=new WeakMap,a.FontLoader=p;class V{constructor(F,{isEvalSupported:C=!0,disableFontFace:m=!1,ignoreErrors:I=!1,inspectFont:O=null}){this.compiledGlyphs=Object.create(null);for(const x in F)this[x]=F[x];this.isEvalSupported=C!==!1,this.disableFontFace=m===!0,this.ignoreErrors=I===!0,this._inspectFont=O}createNativeFontFace(){var C;if(!this.data||this.disableFontFace)return null;let F;if(!this.cssFontInfo)F=new FontFace(this.loadedName,this.data,{});else{const m={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(m.style=`oblique ${this.cssFontInfo.italicAngle}deg`),F=new FontFace(this.cssFontInfo.fontFamily,this.data,m)}return(C=this._inspectFont)==null||C.call(this,this),F}createFontFaceRule(){var I;if(!this.data||this.disableFontFace)return null;const F=(0,i.bytesToString)(this.data),C=`url(data:${this.mimetype};base64,${btoa(F)});`;let m;if(!this.cssFontInfo)m=`@font-face {font-family:"${this.loadedName}";src:${C}}`;else{let O=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(O+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),m=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${O}src:${C}}`}return(I=this._inspectFont)==null||I.call(this,this,C),m}getPathGenerator(F,C){if(this.compiledGlyphs[C]!==void 0)return this.compiledGlyphs[C];let m;try{m=F.get(this.loadedName+"_path_"+C)}catch(I){if(!this.ignoreErrors)throw I;return(0,i.warn)(`getPathGenerator - ignoring character: "${I}".`),this.compiledGlyphs[C]=function(O,x){}}if(this.isEvalSupported&&i.FeatureTest.isEvalSupported){const I=[];for(const O of m){const x=O.args!==void 0?O.args.join(","):"";I.push("c.",O.cmd,"(",x,`);
`)}return this.compiledGlyphs[C]=new Function("c","size",I.join(""))}return this.compiledGlyphs[C]=function(I,O){for(const x of m)x.cmd==="scale"&&(x.args=[O,-O]),I[x.cmd].apply(I,x.args)}}}a.FontFaceObject=V},(D,a,j)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.NodeStandardFontDataFactory=a.NodeFilterFactory=a.NodeCanvasFactory=a.NodeCMapReaderFactory=void 0;var i=j(7);j(1);const p=function(C){return new Promise((m,I)=>{require$$5.readFile(C,(x,E)=>{if(x||!E){I(new Error(x));return}m(new Uint8Array(E))})})};class V extends i.BaseFilterFactory{}a.NodeFilterFactory=V;class W extends i.BaseCanvasFactory{_createCanvas(m,I){return require$$5.createCanvas(m,I)}}a.NodeCanvasFactory=W;class dt extends i.BaseCMapReaderFactory{_fetchData(m,I){return p(m).then(O=>({cMapData:O,compressionType:I}))}}a.NodeCMapReaderFactory=dt;class F extends i.BaseStandardFontDataFactory{_fetchData(m){return p(m)}}a.NodeStandardFontDataFactory=F},(D,a,j)=>{var $,Ze,bt,tn;Object.defineProperty(a,"__esModule",{value:!0}),a.CanvasGraphics=void 0;var i=j(1),p=j(6),V=j(12),W=j(13);const dt=16,F=100,C=4096,m=15,I=10,O=1e3,x=16;function E(R,n){if(R._removeMirroring)throw new Error("Context is already forwarding operations.");R.__originalSave=R.save,R.__originalRestore=R.restore,R.__originalRotate=R.rotate,R.__originalScale=R.scale,R.__originalTranslate=R.translate,R.__originalTransform=R.transform,R.__originalSetTransform=R.setTransform,R.__originalResetTransform=R.resetTransform,R.__originalClip=R.clip,R.__originalMoveTo=R.moveTo,R.__originalLineTo=R.lineTo,R.__originalBezierCurveTo=R.bezierCurveTo,R.__originalRect=R.rect,R.__originalClosePath=R.closePath,R.__originalBeginPath=R.beginPath,R._removeMirroring=()=>{R.save=R.__originalSave,R.restore=R.__originalRestore,R.rotate=R.__originalRotate,R.scale=R.__originalScale,R.translate=R.__originalTranslate,R.transform=R.__originalTransform,R.setTransform=R.__originalSetTransform,R.resetTransform=R.__originalResetTransform,R.clip=R.__originalClip,R.moveTo=R.__originalMoveTo,R.lineTo=R.__originalLineTo,R.bezierCurveTo=R.__originalBezierCurveTo,R.rect=R.__originalRect,R.closePath=R.__originalClosePath,R.beginPath=R.__originalBeginPath,delete R._removeMirroring},R.save=function(){n.save(),this.__originalSave()},R.restore=function(){n.restore(),this.__originalRestore()},R.translate=function(s,h){n.translate(s,h),this.__originalTranslate(s,h)},R.scale=function(s,h){n.scale(s,h),this.__originalScale(s,h)},R.transform=function(s,h,u,S,L,U){n.transform(s,h,u,S,L,U),this.__originalTransform(s,h,u,S,L,U)},R.setTransform=function(s,h,u,S,L,U){n.setTransform(s,h,u,S,L,U),this.__originalSetTransform(s,h,u,S,L,U)},R.resetTransform=function(){n.resetTransform(),this.__originalResetTransform()},R.rotate=function(s){n.rotate(s),this.__originalRotate(s)},R.clip=function(s){n.clip(s),this.__originalClip(s)},R.moveTo=function(o,s){n.moveTo(o,s),this.__originalMoveTo(o,s)},R.lineTo=function(o,s){n.lineTo(o,s),this.__originalLineTo(o,s)},R.bezierCurveTo=function(o,s,h,u,S,L){n.bezierCurveTo(o,s,h,u,S,L),this.__originalBezierCurveTo(o,s,h,u,S,L)},R.rect=function(o,s,h,u){n.rect(o,s,h,u),this.__originalRect(o,s,h,u)},R.closePath=function(){n.closePath(),this.__originalClosePath()},R.beginPath=function(){n.beginPath(),this.__originalBeginPath()}}class v{constructor(n){this.canvasFactory=n,this.cache=Object.create(null)}getCanvas(n,o,s){let h;return this.cache[n]!==void 0?(h=this.cache[n],this.canvasFactory.reset(h,o,s)):(h=this.canvasFactory.create(o,s),this.cache[n]=h),h}delete(n){delete this.cache[n]}clear(){for(const n in this.cache){const o=this.cache[n];this.canvasFactory.destroy(o),delete this.cache[n]}}}function f(R,n,o,s,h,u,S,L,U,st){const[tt,at,ut,gt,ct,Rt]=(0,p.getCurrentTransform)(R);if(at===0&&ut===0){const Lt=S*tt+ct,mt=Math.round(Lt),et=L*gt+Rt,nt=Math.round(et),pt=(S+U)*tt+ct,Pt=Math.abs(Math.round(pt)-mt)||1,Ct=(L+st)*gt+Rt,Ut=Math.abs(Math.round(Ct)-nt)||1;return R.setTransform(Math.sign(tt),0,0,Math.sign(gt),mt,nt),R.drawImage(n,o,s,h,u,0,0,Pt,Ut),R.setTransform(tt,at,ut,gt,ct,Rt),[Pt,Ut]}if(tt===0&&gt===0){const Lt=L*ut+ct,mt=Math.round(Lt),et=S*at+Rt,nt=Math.round(et),pt=(L+st)*ut+ct,Pt=Math.abs(Math.round(pt)-mt)||1,Ct=(S+U)*at+Rt,Ut=Math.abs(Math.round(Ct)-nt)||1;return R.setTransform(0,Math.sign(at),Math.sign(ut),0,mt,nt),R.drawImage(n,o,s,h,u,0,0,Ut,Pt),R.setTransform(tt,at,ut,gt,ct,Rt),[Ut,Pt]}R.drawImage(n,o,s,h,u,S,L,U,st);const It=Math.hypot(tt,at),Et=Math.hypot(ut,gt);return[It*U,Et*st]}function _(R){const{width:n,height:o}=R;if(n>O||o>O)return null;const s=1e3,h=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),u=n+1;let S=new Uint8Array(u*(o+1)),L,U,st;const tt=n+7&-8;let at=new Uint8Array(tt*o),ut=0;for(const Et of R.data){let Lt=128;for(;Lt>0;)at[ut++]=Et&Lt?0:255,Lt>>=1}let gt=0;for(ut=0,at[ut]!==0&&(S[0]=1,++gt),U=1;U<n;U++)at[ut]!==at[ut+1]&&(S[U]=at[ut]?2:1,++gt),ut++;for(at[ut]!==0&&(S[U]=2,++gt),L=1;L<o;L++){ut=L*tt,st=L*u,at[ut-tt]!==at[ut]&&(S[st]=at[ut]?1:8,++gt);let Et=(at[ut]?4:0)+(at[ut-tt]?8:0);for(U=1;U<n;U++)Et=(Et>>2)+(at[ut+1]?4:0)+(at[ut-tt+1]?8:0),h[Et]&&(S[st+U]=h[Et],++gt),ut++;if(at[ut-tt]!==at[ut]&&(S[st+U]=at[ut]?2:4,++gt),gt>s)return null}for(ut=tt*(o-1),st=L*u,at[ut]!==0&&(S[st]=8,++gt),U=1;U<n;U++)at[ut]!==at[ut+1]&&(S[st+U]=at[ut]?4:8,++gt),ut++;if(at[ut]!==0&&(S[st+U]=4,++gt),gt>s)return null;const ct=new Int32Array([0,u,-1,0,-u,0,0,0,1]),Rt=new Path2D;for(L=0;gt&&L<=o;L++){let Et=L*u;const Lt=Et+n;for(;Et<Lt&&!S[Et];)Et++;if(Et===Lt)continue;Rt.moveTo(Et%u,L);const mt=Et;let et=S[Et];do{const nt=ct[et];do Et+=nt;while(!S[Et]);const pt=S[Et];pt!==5&&pt!==10?(et=pt,S[Et]=0):(et=pt&51*et>>4,S[Et]&=et>>2|et<<2),Rt.lineTo(Et%u,Et/u|0),S[Et]||--gt}while(mt!==Et);--L}return at=null,S=null,function(Et){Et.save(),Et.scale(1/n,-1/o),Et.translate(0,-o),Et.fill(Rt),Et.beginPath(),Et.restore()}}class P{constructor(n,o){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=i.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=i.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,n,o])}clone(){const n=Object.create(this);return n.clipBox=this.clipBox.slice(),n}setCurrentPoint(n,o){this.x=n,this.y=o}updatePathMinMax(n,o,s){[o,s]=i.Util.applyTransform([o,s],n),this.minX=Math.min(this.minX,o),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,o),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(n,o){const s=i.Util.applyTransform(o,n),h=i.Util.applyTransform(o.slice(2),n);this.minX=Math.min(this.minX,s[0],h[0]),this.minY=Math.min(this.minY,s[1],h[1]),this.maxX=Math.max(this.maxX,s[0],h[0]),this.maxY=Math.max(this.maxY,s[1],h[1])}updateScalingPathMinMax(n,o){i.Util.scaleMinMax(n,o),this.minX=Math.min(this.minX,o[0]),this.maxX=Math.max(this.maxX,o[1]),this.minY=Math.min(this.minY,o[2]),this.maxY=Math.max(this.maxY,o[3])}updateCurvePathMinMax(n,o,s,h,u,S,L,U,st,tt){const at=i.Util.bezierBoundingBox(o,s,h,u,S,L,U,st);if(tt){tt[0]=Math.min(tt[0],at[0],at[2]),tt[1]=Math.max(tt[1],at[0],at[2]),tt[2]=Math.min(tt[2],at[1],at[3]),tt[3]=Math.max(tt[3],at[1],at[3]);return}this.updateRectMinMax(n,at)}getPathBoundingBox(n=V.PathType.FILL,o=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(n===V.PathType.STROKE){o||(0,i.unreachable)("Stroke bounding box must include transform.");const h=i.Util.singularValueDecompose2dScale(o),u=h[0]*this.lineWidth/2,S=h[1]*this.lineWidth/2;s[0]-=u,s[1]-=S,s[2]+=u,s[3]+=S}return s}updateClipFromPath(){const n=i.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(n||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(n){this.clipBox=n,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(n=V.PathType.FILL,o=null){return i.Util.intersect(this.clipBox,this.getPathBoundingBox(n,o))}}function w(R,n){if(typeof ImageData<"u"&&n instanceof ImageData){R.putImageData(n,0,0);return}const o=n.height,s=n.width,h=o%x,u=(o-h)/x,S=h===0?u:u+1,L=R.createImageData(s,x);let U=0,st;const tt=n.data,at=L.data;let ut,gt,ct,Rt;if(n.kind===i.ImageKind.GRAYSCALE_1BPP){const It=tt.byteLength,Et=new Uint32Array(at.buffer,0,at.byteLength>>2),Lt=Et.length,mt=s+7>>3,et=4294967295,nt=i.FeatureTest.isLittleEndian?4278190080:255;for(ut=0;ut<S;ut++){for(ct=ut<u?x:h,st=0,gt=0;gt<ct;gt++){const pt=It-U;let Pt=0;const Ct=pt>mt?s:pt*8-7,Ut=Ct&-8;let Vt=0,Ht=0;for(;Pt<Ut;Pt+=8)Ht=tt[U++],Et[st++]=Ht&128?et:nt,Et[st++]=Ht&64?et:nt,Et[st++]=Ht&32?et:nt,Et[st++]=Ht&16?et:nt,Et[st++]=Ht&8?et:nt,Et[st++]=Ht&4?et:nt,Et[st++]=Ht&2?et:nt,Et[st++]=Ht&1?et:nt;for(;Pt<Ct;Pt++)Vt===0&&(Ht=tt[U++],Vt=128),Et[st++]=Ht&Vt?et:nt,Vt>>=1}for(;st<Lt;)Et[st++]=0;R.putImageData(L,0,ut*x)}}else if(n.kind===i.ImageKind.RGBA_32BPP){for(gt=0,Rt=s*x*4,ut=0;ut<u;ut++)at.set(tt.subarray(U,U+Rt)),U+=Rt,R.putImageData(L,0,gt),gt+=x;ut<S&&(Rt=s*h*4,at.set(tt.subarray(U,U+Rt)),R.putImageData(L,0,gt))}else if(n.kind===i.ImageKind.RGB_24BPP)for(ct=x,Rt=s*ct,ut=0;ut<S;ut++){for(ut>=u&&(ct=h,Rt=s*ct),st=0,gt=Rt;gt--;)at[st++]=tt[U++],at[st++]=tt[U++],at[st++]=tt[U++],at[st++]=255;R.putImageData(L,0,ut*x)}else throw new Error(`bad image kind: ${n.kind}`)}function A(R,n){if(n.bitmap){R.drawImage(n.bitmap,0,0);return}const o=n.height,s=n.width,h=o%x,u=(o-h)/x,S=h===0?u:u+1,L=R.createImageData(s,x);let U=0;const st=n.data,tt=L.data;for(let at=0;at<S;at++){const ut=at<u?x:h;({srcPos:U}=(0,W.convertBlackAndWhiteToRGBA)({src:st,srcPos:U,dest:tt,width:s,height:ut,nonBlackColor:0})),R.putImageData(L,0,at*x)}}function l(R,n){const o=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of o)R[s]!==void 0&&(n[s]=R[s]);R.setLineDash!==void 0&&(n.setLineDash(R.getLineDash()),n.lineDashOffset=R.lineDashOffset)}function d(R){if(R.strokeStyle=R.fillStyle="#000000",R.fillRule="nonzero",R.globalAlpha=1,R.lineWidth=1,R.lineCap="butt",R.lineJoin="miter",R.miterLimit=10,R.globalCompositeOperation="source-over",R.font="10px sans-serif",R.setLineDash!==void 0&&(R.setLineDash([]),R.lineDashOffset=0),!i.isNodeJS){const{filter:n}=R;n!=="none"&&n!==""&&(R.filter="none")}}function M(R,n,o,s){const h=R.length;for(let u=3;u<h;u+=4){const S=R[u];if(S===0)R[u-3]=n,R[u-2]=o,R[u-1]=s;else if(S<255){const L=255-S;R[u-3]=R[u-3]*S+n*L>>8,R[u-2]=R[u-2]*S+o*L>>8,R[u-1]=R[u-1]*S+s*L>>8}}}function b(R,n,o){const s=R.length,h=1/255;for(let u=3;u<s;u+=4){const S=o?o[R[u]]:R[u];n[u]=n[u]*S*h|0}}function c(R,n,o){const s=R.length;for(let h=3;h<s;h+=4){const u=R[h-3]*77+R[h-2]*152+R[h-1]*28;n[h]=o?n[h]*o[u>>8]>>8:n[h]*u>>16}}function k(R,n,o,s,h,u,S,L,U,st,tt){const at=!!u,ut=at?u[0]:0,gt=at?u[1]:0,ct=at?u[2]:0,Rt=h==="Luminosity"?c:b,Et=Math.min(s,Math.ceil(1048576/o));for(let Lt=0;Lt<s;Lt+=Et){const mt=Math.min(Et,s-Lt),et=R.getImageData(L-st,Lt+(U-tt),o,mt),nt=n.getImageData(L,Lt+U,o,mt);at&&M(et.data,ut,gt,ct),Rt(et.data,nt.data,S),n.putImageData(nt,L,Lt+U)}}function g(R,n,o,s){const h=s[0],u=s[1],S=s[2]-h,L=s[3]-u;S===0||L===0||(k(n.context,o,S,L,n.subtype,n.backdrop,n.transferMap,h,u,n.offsetX,n.offsetY),R.save(),R.globalAlpha=1,R.globalCompositeOperation="source-over",R.setTransform(1,0,0,1,0,0),R.drawImage(o.canvas,0,0),R.restore())}function G(R,n){const o=i.Util.singularValueDecompose2dScale(R);o[0]=Math.fround(o[0]),o[1]=Math.fround(o[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*p.PixelsPerInch.PDF_TO_CSS_UNITS);return n!==void 0?n:o[0]<=s||o[1]<=s}const z=["butt","round","square"],T=["miter","round","bevel"],Y={},it={},wt=class wt{constructor(n,o,s,h,u,{optionalContentConfig:S,markedContentStack:L=null},U,st){H(this,$);H(this,bt);this.ctx=n,this.current=new P(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=o,this.objs=s,this.canvasFactory=h,this.filterFactory=u,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=L||[],this.optionalContentConfig=S,this.cachedCanvases=new v(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=U,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=st,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(n,o=null){return typeof n=="string"?n.startsWith("g_")?this.commonObjs.get(n):this.objs.get(n):o}beginDrawing({transform:n,viewport:o,transparency:s=!1,background:h=null}){const u=this.ctx.canvas.width,S=this.ctx.canvas.height,L=this.ctx.fillStyle;if(this.ctx.fillStyle=h||"#ffffff",this.ctx.fillRect(0,0,u,S),this.ctx.fillStyle=L,s){const U=this.cachedCanvases.getCanvas("transparent",u,S);this.compositeCtx=this.ctx,this.transparentCanvas=U.canvas,this.ctx=U.context,this.ctx.save(),this.ctx.transform(...(0,p.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),d(this.ctx),n&&(this.ctx.transform(...n),this.outputScaleX=n[0],this.outputScaleY=n[0]),this.ctx.transform(...o.transform),this.viewportScale=o.scale,this.baseTransform=(0,p.getCurrentTransform)(this.ctx)}executeOperatorList(n,o,s,h){const u=n.argsArray,S=n.fnArray;let L=o||0;const U=u.length;if(U===L)return L;const st=U-L>I&&typeof s=="function",tt=st?Date.now()+m:0;let at=0;const ut=this.commonObjs,gt=this.objs;let ct;for(;;){if(h!==void 0&&L===h.nextBreakPoint)return h.breakIt(L,s),L;if(ct=S[L],ct!==i.OPS.dependency)this[ct].apply(this,u[L]);else for(const Rt of u[L]){const It=Rt.startsWith("g_")?ut:gt;if(!It.has(Rt))return It.get(Rt,s),L}if(L++,L===U)return L;if(st&&++at>I){if(Date.now()>tt)return s(),L;at=0}}}endDrawing(){q(this,$,Ze).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const n of this._cachedBitmapsMap.values()){for(const o of n.values())typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement&&(o.width=o.height=0);n.clear()}this._cachedBitmapsMap.clear(),q(this,bt,tn).call(this)}_scaleImage(n,o){const s=n.width,h=n.height;let u=Math.max(Math.hypot(o[0],o[1]),1),S=Math.max(Math.hypot(o[2],o[3]),1),L=s,U=h,st="prescale1",tt,at;for(;u>2&&L>1||S>2&&U>1;){let ut=L,gt=U;u>2&&L>1&&(ut=L>=16384?Math.floor(L/2)-1||1:Math.ceil(L/2),u/=L/ut),S>2&&U>1&&(gt=U>=16384?Math.floor(U/2)-1||1:Math.ceil(U)/2,S/=U/gt),tt=this.cachedCanvases.getCanvas(st,ut,gt),at=tt.context,at.clearRect(0,0,ut,gt),at.drawImage(n,0,0,L,U,0,0,ut,gt),n=tt.canvas,L=ut,U=gt,st=st==="prescale1"?"prescale2":"prescale1"}return{img:n,paintWidth:L,paintHeight:U}}_createMaskCanvas(n){const o=this.ctx,{width:s,height:h}=n,u=this.current.fillColor,S=this.current.patternFill,L=(0,p.getCurrentTransform)(o);let U,st,tt,at;if((n.bitmap||n.data)&&n.count>1){const Pt=n.bitmap||n.data.buffer;st=JSON.stringify(S?L:[L.slice(0,4),u]),U=this._cachedBitmapsMap.get(Pt),U||(U=new Map,this._cachedBitmapsMap.set(Pt,U));const Ct=U.get(st);if(Ct&&!S){const Ut=Math.round(Math.min(L[0],L[2])+L[4]),Vt=Math.round(Math.min(L[1],L[3])+L[5]);return{canvas:Ct,offsetX:Ut,offsetY:Vt}}tt=Ct}tt||(at=this.cachedCanvases.getCanvas("maskCanvas",s,h),A(at.context,n));let ut=i.Util.transform(L,[1/s,0,0,-1/h,0,0]);ut=i.Util.transform(ut,[1,0,0,1,0,-h]);const gt=i.Util.applyTransform([0,0],ut),ct=i.Util.applyTransform([s,h],ut),Rt=i.Util.normalizeRect([gt[0],gt[1],ct[0],ct[1]]),It=Math.round(Rt[2]-Rt[0])||1,Et=Math.round(Rt[3]-Rt[1])||1,Lt=this.cachedCanvases.getCanvas("fillCanvas",It,Et),mt=Lt.context,et=Math.min(gt[0],ct[0]),nt=Math.min(gt[1],ct[1]);mt.translate(-et,-nt),mt.transform(...ut),tt||(tt=this._scaleImage(at.canvas,(0,p.getCurrentTransformInverse)(mt)),tt=tt.img,U&&S&&U.set(st,tt)),mt.imageSmoothingEnabled=G((0,p.getCurrentTransform)(mt),n.interpolate),f(mt,tt,0,0,tt.width,tt.height,0,0,s,h),mt.globalCompositeOperation="source-in";const pt=i.Util.transform((0,p.getCurrentTransformInverse)(mt),[1,0,0,1,-et,-nt]);return mt.fillStyle=S?u.getPattern(o,this,pt,V.PathType.FILL):u,mt.fillRect(0,0,s,h),U&&!S&&(this.cachedCanvases.delete("fillCanvas"),U.set(st,Lt.canvas)),{canvas:Lt.canvas,offsetX:Math.round(et),offsetY:Math.round(nt)}}setLineWidth(n){n!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=n,this.ctx.lineWidth=n}setLineCap(n){this.ctx.lineCap=z[n]}setLineJoin(n){this.ctx.lineJoin=T[n]}setMiterLimit(n){this.ctx.miterLimit=n}setDash(n,o){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(n),s.lineDashOffset=o)}setRenderingIntent(n){}setFlatness(n){}setGState(n){for(const[o,s]of n)switch(o){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const n=this.inSMaskMode;this.current.activeSMask&&!n?this.beginSMaskMode():!this.current.activeSMask&&n&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const n=this.ctx.canvas.width,o=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,h=this.cachedCanvases.getCanvas(s,n,o);this.suspendedCtx=this.ctx,this.ctx=h.context;const u=this.ctx;u.setTransform(...(0,p.getCurrentTransform)(this.suspendedCtx)),l(this.suspendedCtx,u),E(u,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),l(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(n){if(!this.current.activeSMask)return;n?(n[0]=Math.floor(n[0]),n[1]=Math.floor(n[1]),n[2]=Math.ceil(n[2]),n[3]=Math.ceil(n[3])):n=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const o=this.current.activeSMask,s=this.suspendedCtx;g(s,o,this.ctx,n),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(l(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const n=this.current;this.stateStack.push(n),this.current=n.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),l(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(n,o,s,h,u,S){this.ctx.transform(n,o,s,h,u,S),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(n,o,s){const h=this.ctx,u=this.current;let S=u.x,L=u.y,U,st;const tt=(0,p.getCurrentTransform)(h),at=tt[0]===0&&tt[3]===0||tt[1]===0&&tt[2]===0,ut=at?s.slice(0):null;for(let gt=0,ct=0,Rt=n.length;gt<Rt;gt++)switch(n[gt]|0){case i.OPS.rectangle:S=o[ct++],L=o[ct++];const It=o[ct++],Et=o[ct++],Lt=S+It,mt=L+Et;h.moveTo(S,L),It===0||Et===0?h.lineTo(Lt,mt):(h.lineTo(Lt,L),h.lineTo(Lt,mt),h.lineTo(S,mt)),at||u.updateRectMinMax(tt,[S,L,Lt,mt]),h.closePath();break;case i.OPS.moveTo:S=o[ct++],L=o[ct++],h.moveTo(S,L),at||u.updatePathMinMax(tt,S,L);break;case i.OPS.lineTo:S=o[ct++],L=o[ct++],h.lineTo(S,L),at||u.updatePathMinMax(tt,S,L);break;case i.OPS.curveTo:U=S,st=L,S=o[ct+4],L=o[ct+5],h.bezierCurveTo(o[ct],o[ct+1],o[ct+2],o[ct+3],S,L),u.updateCurvePathMinMax(tt,U,st,o[ct],o[ct+1],o[ct+2],o[ct+3],S,L,ut),ct+=6;break;case i.OPS.curveTo2:U=S,st=L,h.bezierCurveTo(S,L,o[ct],o[ct+1],o[ct+2],o[ct+3]),u.updateCurvePathMinMax(tt,U,st,S,L,o[ct],o[ct+1],o[ct+2],o[ct+3],ut),S=o[ct+2],L=o[ct+3],ct+=4;break;case i.OPS.curveTo3:U=S,st=L,S=o[ct+2],L=o[ct+3],h.bezierCurveTo(o[ct],o[ct+1],S,L,S,L),u.updateCurvePathMinMax(tt,U,st,o[ct],o[ct+1],S,L,S,L,ut),ct+=4;break;case i.OPS.closePath:h.closePath();break}at&&u.updateScalingPathMinMax(tt,ut),u.setCurrentPoint(S,L)}closePath(){this.ctx.closePath()}stroke(n=!0){const o=this.ctx,s=this.current.strokeColor;o.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(o.save(),o.strokeStyle=s.getPattern(o,this,(0,p.getCurrentTransformInverse)(o),V.PathType.STROKE),this.rescaleAndStroke(!1),o.restore()):this.rescaleAndStroke(!0)),n&&this.consumePath(this.current.getClippedPathBoundingBox()),o.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(n=!0){const o=this.ctx,s=this.current.fillColor,h=this.current.patternFill;let u=!1;h&&(o.save(),o.fillStyle=s.getPattern(o,this,(0,p.getCurrentTransformInverse)(o),V.PathType.FILL),u=!0);const S=this.current.getClippedPathBoundingBox();this.contentVisible&&S!==null&&(this.pendingEOFill?(o.fill("evenodd"),this.pendingEOFill=!1):o.fill()),u&&o.restore(),n&&this.consumePath(S)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Y}eoClip(){this.pendingClip=it}beginText(){this.current.textMatrix=i.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const n=this.pendingTextPaths,o=this.ctx;if(n===void 0){o.beginPath();return}o.save(),o.beginPath();for(const s of n)o.setTransform(...s.transform),o.translate(s.x,s.y),s.addToPath(o,s.fontSize);o.restore(),o.clip(),o.beginPath(),delete this.pendingTextPaths}setCharSpacing(n){this.current.charSpacing=n}setWordSpacing(n){this.current.wordSpacing=n}setHScale(n){this.current.textHScale=n/100}setLeading(n){this.current.leading=-n}setFont(n,o){var tt;const s=this.commonObjs.get(n),h=this.current;if(!s)throw new Error(`Can't find font for ${n}`);if(h.fontMatrix=s.fontMatrix||i.FONT_IDENTITY_MATRIX,(h.fontMatrix[0]===0||h.fontMatrix[3]===0)&&(0,i.warn)("Invalid font matrix for font "+n),o<0?(o=-o,h.fontDirection=-1):h.fontDirection=1,this.current.font=s,this.current.fontSize=o,s.isType3Font)return;const u=s.loadedName||"sans-serif",S=((tt=s.systemFontInfo)==null?void 0:tt.css)||`"${u}", ${s.fallbackName}`;let L="normal";s.black?L="900":s.bold&&(L="bold");const U=s.italic?"italic":"normal";let st=o;o<dt?st=dt:o>F&&(st=F),this.current.fontSizeScale=o/st,this.ctx.font=`${U} ${L} ${st}px ${S}`}setTextRenderingMode(n){this.current.textRenderingMode=n}setTextRise(n){this.current.textRise=n}moveText(n,o){this.current.x=this.current.lineX+=n,this.current.y=this.current.lineY+=o}setLeadingMoveText(n,o){this.setLeading(-o),this.moveText(n,o)}setTextMatrix(n,o,s,h,u,S){this.current.textMatrix=[n,o,s,h,u,S],this.current.textMatrixScale=Math.hypot(n,o),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(n,o,s,h){const u=this.ctx,S=this.current,L=S.font,U=S.textRenderingMode,st=S.fontSize/S.fontSizeScale,tt=U&i.TextRenderingMode.FILL_STROKE_MASK,at=!!(U&i.TextRenderingMode.ADD_TO_PATH_FLAG),ut=S.patternFill&&!L.missingFile;let gt;(L.disableFontFace||at||ut)&&(gt=L.getPathGenerator(this.commonObjs,n)),L.disableFontFace||ut?(u.save(),u.translate(o,s),u.beginPath(),gt(u,st),h&&u.setTransform(...h),(tt===i.TextRenderingMode.FILL||tt===i.TextRenderingMode.FILL_STROKE)&&u.fill(),(tt===i.TextRenderingMode.STROKE||tt===i.TextRenderingMode.FILL_STROKE)&&u.stroke(),u.restore()):((tt===i.TextRenderingMode.FILL||tt===i.TextRenderingMode.FILL_STROKE)&&u.fillText(n,o,s),(tt===i.TextRenderingMode.STROKE||tt===i.TextRenderingMode.FILL_STROKE)&&u.strokeText(n,o,s)),at&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,p.getCurrentTransform)(u),x:o,y:s,fontSize:st,addToPath:gt})}get isFontSubpixelAAEnabled(){const{context:n}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);n.scale(1.5,1),n.fillText("I",0,10);const o=n.getImageData(0,0,10,10).data;let s=!1;for(let h=3;h<o.length;h+=4)if(o[h]>0&&o[h]<255){s=!0;break}return(0,i.shadow)(this,"isFontSubpixelAAEnabled",s)}showText(n){const o=this.current,s=o.font;if(s.isType3Font)return this.showType3Text(n);const h=o.fontSize;if(h===0)return;const u=this.ctx,S=o.fontSizeScale,L=o.charSpacing,U=o.wordSpacing,st=o.fontDirection,tt=o.textHScale*st,at=n.length,ut=s.vertical,gt=ut?1:-1,ct=s.defaultVMetrics,Rt=h*o.fontMatrix[0],It=o.textRenderingMode===i.TextRenderingMode.FILL&&!s.disableFontFace&&!o.patternFill;u.save(),u.transform(...o.textMatrix),u.translate(o.x,o.y+o.textRise),st>0?u.scale(tt,-1):u.scale(tt,1);let Et;if(o.patternFill){u.save();const pt=o.fillColor.getPattern(u,this,(0,p.getCurrentTransformInverse)(u),V.PathType.FILL);Et=(0,p.getCurrentTransform)(u),u.restore(),u.fillStyle=pt}let Lt=o.lineWidth;const mt=o.textMatrixScale;if(mt===0||Lt===0){const pt=o.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;(pt===i.TextRenderingMode.STROKE||pt===i.TextRenderingMode.FILL_STROKE)&&(Lt=this.getSinglePixelWidth())}else Lt/=mt;if(S!==1&&(u.scale(S,S),Lt/=S),u.lineWidth=Lt,s.isInvalidPDFjsFont){const pt=[];let Pt=0;for(const Ct of n)pt.push(Ct.unicode),Pt+=Ct.width;u.fillText(pt.join(""),0,0),o.x+=Pt*Rt*tt,u.restore(),this.compose();return}let et=0,nt;for(nt=0;nt<at;++nt){const pt=n[nt];if(typeof pt=="number"){et+=gt*pt*h/1e3;continue}let Pt=!1;const Ct=(pt.isSpace?U:0)+L,Ut=pt.fontChar,Vt=pt.accent;let Ht,zt,$t=pt.width;if(ut){const Xt=pt.vmetric||ct,ft=-(pt.vmetric?Xt[1]:$t*.5)*Rt,Z=Xt[2]*Rt;$t=Xt?-Xt[0]:$t,Ht=ft/S,zt=(et+Z)/S}else Ht=et/S,zt=0;if(s.remeasure&&$t>0){const Xt=u.measureText(Ut).width*1e3/h*S;if($t<Xt&&this.isFontSubpixelAAEnabled){const ft=$t/Xt;Pt=!0,u.save(),u.scale(ft,1),Ht/=ft}else $t!==Xt&&(Ht+=($t-Xt)/2e3*h/S)}if(this.contentVisible&&(pt.isInFont||s.missingFile)){if(It&&!Vt)u.fillText(Ut,Ht,zt);else if(this.paintChar(Ut,Ht,zt,Et),Vt){const Xt=Ht+h*Vt.offset.x/S,ft=zt-h*Vt.offset.y/S;this.paintChar(Vt.fontChar,Xt,ft,Et)}}const Wt=ut?$t*Rt-Ct*st:$t*Rt+Ct*st;et+=Wt,Pt&&u.restore()}ut?o.y-=et:o.x+=et*tt,u.restore(),this.compose()}showType3Text(n){const o=this.ctx,s=this.current,h=s.font,u=s.fontSize,S=s.fontDirection,L=h.vertical?1:-1,U=s.charSpacing,st=s.wordSpacing,tt=s.textHScale*S,at=s.fontMatrix||i.FONT_IDENTITY_MATRIX,ut=n.length,gt=s.textRenderingMode===i.TextRenderingMode.INVISIBLE;let ct,Rt,It,Et;if(!(gt||u===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,o.save(),o.transform(...s.textMatrix),o.translate(s.x,s.y),o.scale(tt,S),ct=0;ct<ut;++ct){if(Rt=n[ct],typeof Rt=="number"){Et=L*Rt*u/1e3,this.ctx.translate(Et,0),s.x+=Et*tt;continue}const Lt=(Rt.isSpace?st:0)+U,mt=h.charProcOperatorList[Rt.operatorListId];if(!mt){(0,i.warn)(`Type3 character "${Rt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Rt,this.save(),o.scale(u,u),o.transform(...at),this.executeOperatorList(mt),this.restore()),It=i.Util.applyTransform([Rt.width,0],at)[0]*u+Lt,o.translate(It,0),s.x+=It*tt}o.restore(),this.processingType3=null}}setCharWidth(n,o){}setCharWidthAndBounds(n,o,s,h,u,S){this.ctx.rect(s,h,u-s,S-h),this.ctx.clip(),this.endPath()}getColorN_Pattern(n){let o;if(n[0]==="TilingPattern"){const s=n[1],h=this.baseTransform||(0,p.getCurrentTransform)(this.ctx),u={createCanvasGraphics:S=>new wt(S,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};o=new V.TilingPattern(n,s,this.ctx,u,h)}else o=this._getPattern(n[1],n[2]);return o}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(n,o,s){const h=i.Util.makeHexColor(n,o,s);this.ctx.strokeStyle=h,this.current.strokeColor=h}setFillRGBColor(n,o,s){const h=i.Util.makeHexColor(n,o,s);this.ctx.fillStyle=h,this.current.fillColor=h,this.current.patternFill=!1}_getPattern(n,o=null){let s;return this.cachedPatterns.has(n)?s=this.cachedPatterns.get(n):(s=(0,V.getShadingPattern)(this.getObject(n)),this.cachedPatterns.set(n,s)),o&&(s.matrix=o),s}shadingFill(n){if(!this.contentVisible)return;const o=this.ctx;this.save();const s=this._getPattern(n);o.fillStyle=s.getPattern(o,this,(0,p.getCurrentTransformInverse)(o),V.PathType.SHADING);const h=(0,p.getCurrentTransformInverse)(o);if(h){const{width:u,height:S}=o.canvas,[L,U,st,tt]=i.Util.getAxialAlignedBoundingBox([0,0,u,S],h);this.ctx.fillRect(L,U,st-L,tt-U)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,i.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,i.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(n,o){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(n)&&n.length===6&&this.transform(...n),this.baseTransform=(0,p.getCurrentTransform)(this.ctx),o)){const s=o[2]-o[0],h=o[3]-o[1];this.ctx.rect(o[0],o[1],s,h),this.current.updateRectMinMax((0,p.getCurrentTransform)(this.ctx),o),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(n){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const o=this.ctx;n.isolated||(0,i.info)("TODO: Support non-isolated groups."),n.knockout&&(0,i.warn)("Knockout groups not supported.");const s=(0,p.getCurrentTransform)(o);if(n.matrix&&o.transform(...n.matrix),!n.bbox)throw new Error("Bounding box is required.");let h=i.Util.getAxialAlignedBoundingBox(n.bbox,(0,p.getCurrentTransform)(o));const u=[0,0,o.canvas.width,o.canvas.height];h=i.Util.intersect(h,u)||[0,0,0,0];const S=Math.floor(h[0]),L=Math.floor(h[1]);let U=Math.max(Math.ceil(h[2])-S,1),st=Math.max(Math.ceil(h[3])-L,1),tt=1,at=1;U>C&&(tt=U/C,U=C),st>C&&(at=st/C,st=C),this.current.startNewPathAndClipBox([0,0,U,st]);let ut="groupAt"+this.groupLevel;n.smask&&(ut+="_smask_"+this.smaskCounter++%2);const gt=this.cachedCanvases.getCanvas(ut,U,st),ct=gt.context;ct.scale(1/tt,1/at),ct.translate(-S,-L),ct.transform(...s),n.smask?this.smaskStack.push({canvas:gt.canvas,context:ct,offsetX:S,offsetY:L,scaleX:tt,scaleY:at,subtype:n.smask.subtype,backdrop:n.smask.backdrop,transferMap:n.smask.transferMap||null,startTransformInverse:null}):(o.setTransform(1,0,0,1,0,0),o.translate(S,L),o.scale(tt,at),o.save()),l(o,ct),this.ctx=ct,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++}endGroup(n){if(!this.contentVisible)return;this.groupLevel--;const o=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,n.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const h=(0,p.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...h);const u=i.Util.getAxialAlignedBoundingBox([0,0,o.canvas.width,o.canvas.height],h);this.ctx.drawImage(o.canvas,0,0),this.ctx.restore(),this.compose(u)}}beginAnnotation(n,o,s,h,u){if(q(this,$,Ze).call(this),d(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(o)&&o.length===4){const S=o[2]-o[0],L=o[3]-o[1];if(u&&this.annotationCanvasMap){s=s.slice(),s[4]-=o[0],s[5]-=o[1],o=o.slice(),o[0]=o[1]=0,o[2]=S,o[3]=L;const[U,st]=i.Util.singularValueDecompose2dScale((0,p.getCurrentTransform)(this.ctx)),{viewportScale:tt}=this,at=Math.ceil(S*this.outputScaleX*tt),ut=Math.ceil(L*this.outputScaleY*tt);this.annotationCanvas=this.canvasFactory.create(at,ut);const{canvas:gt,context:ct}=this.annotationCanvas;this.annotationCanvasMap.set(n,gt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ct,this.ctx.save(),this.ctx.setTransform(U,0,0,-st,0,L*st),d(this.ctx)}else d(this.ctx),this.ctx.rect(o[0],o[1],S,L),this.ctx.clip(),this.endPath()}this.current=new P(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...h)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),q(this,bt,tn).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(n){if(!this.contentVisible)return;const o=n.count;n=this.getObject(n.data,n),n.count=o;const s=this.ctx,h=this.processingType3;if(h&&(h.compiled===void 0&&(h.compiled=_(n)),h.compiled)){h.compiled(s);return}const u=this._createMaskCanvas(n),S=u.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(S,u.offsetX,u.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(n,o,s=0,h=0,u,S){if(!this.contentVisible)return;n=this.getObject(n.data,n);const L=this.ctx;L.save();const U=(0,p.getCurrentTransform)(L);L.transform(o,s,h,u,0,0);const st=this._createMaskCanvas(n);L.setTransform(1,0,0,1,st.offsetX-U[4],st.offsetY-U[5]);for(let tt=0,at=S.length;tt<at;tt+=2){const ut=i.Util.transform(U,[o,s,h,u,S[tt],S[tt+1]]),[gt,ct]=i.Util.applyTransform([0,0],ut);L.drawImage(st.canvas,gt,ct)}L.restore(),this.compose()}paintImageMaskXObjectGroup(n){if(!this.contentVisible)return;const o=this.ctx,s=this.current.fillColor,h=this.current.patternFill;for(const u of n){const{data:S,width:L,height:U,transform:st}=u,tt=this.cachedCanvases.getCanvas("maskCanvas",L,U),at=tt.context;at.save();const ut=this.getObject(S,u);A(at,ut),at.globalCompositeOperation="source-in",at.fillStyle=h?s.getPattern(at,this,(0,p.getCurrentTransformInverse)(o),V.PathType.FILL):s,at.fillRect(0,0,L,U),at.restore(),o.save(),o.transform(...st),o.scale(1,-1),f(o,tt.canvas,0,0,L,U,0,-1,1,1),o.restore()}this.compose()}paintImageXObject(n){if(!this.contentVisible)return;const o=this.getObject(n);if(!o){(0,i.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(o)}paintImageXObjectRepeat(n,o,s,h){if(!this.contentVisible)return;const u=this.getObject(n);if(!u){(0,i.warn)("Dependent image isn't ready yet");return}const S=u.width,L=u.height,U=[];for(let st=0,tt=h.length;st<tt;st+=2)U.push({transform:[o,0,0,s,h[st],h[st+1]],x:0,y:0,w:S,h:L});this.paintInlineImageXObjectGroup(u,U)}applyTransferMapsToCanvas(n){return this.current.transferMaps!=="none"&&(n.filter=this.current.transferMaps,n.drawImage(n.canvas,0,0),n.filter="none"),n.canvas}applyTransferMapsToBitmap(n){if(this.current.transferMaps==="none")return n.bitmap;const{bitmap:o,width:s,height:h}=n,u=this.cachedCanvases.getCanvas("inlineImage",s,h),S=u.context;return S.filter=this.current.transferMaps,S.drawImage(o,0,0),S.filter="none",u.canvas}paintInlineImageXObject(n){if(!this.contentVisible)return;const o=n.width,s=n.height,h=this.ctx;if(this.save(),!i.isNodeJS){const{filter:L}=h;L!=="none"&&L!==""&&(h.filter="none")}h.scale(1/o,-1/s);let u;if(n.bitmap)u=this.applyTransferMapsToBitmap(n);else if(typeof HTMLElement=="function"&&n instanceof HTMLElement||!n.data)u=n;else{const U=this.cachedCanvases.getCanvas("inlineImage",o,s).context;w(U,n),u=this.applyTransferMapsToCanvas(U)}const S=this._scaleImage(u,(0,p.getCurrentTransformInverse)(h));h.imageSmoothingEnabled=G((0,p.getCurrentTransform)(h),n.interpolate),f(h,S.img,0,0,S.paintWidth,S.paintHeight,0,-s,o,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(n,o){if(!this.contentVisible)return;const s=this.ctx;let h;if(n.bitmap)h=n.bitmap;else{const u=n.width,S=n.height,U=this.cachedCanvases.getCanvas("inlineImage",u,S).context;w(U,n),h=this.applyTransferMapsToCanvas(U)}for(const u of o)s.save(),s.transform(...u.transform),s.scale(1,-1),f(s,h,u.x,u.y,u.w,u.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(n){}markPointProps(n,o){}beginMarkedContent(n){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(n,o){n==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(o)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(n){const o=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const s=this.ctx;this.pendingClip&&(o||(this.pendingClip===it?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const n=(0,p.getCurrentTransform)(this.ctx);if(n[1]===0&&n[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(n[0]),Math.abs(n[3]));else{const o=Math.abs(n[0]*n[3]-n[2]*n[1]),s=Math.hypot(n[0],n[2]),h=Math.hypot(n[1],n[3]);this._cachedGetSinglePixelWidth=Math.max(s,h)/o}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:n}=this.current,{a:o,b:s,c:h,d:u}=this.ctx.getTransform();let S,L;if(s===0&&h===0){const U=Math.abs(o),st=Math.abs(u);if(U===st)if(n===0)S=L=1/U;else{const tt=U*n;S=L=tt<1?1/tt:1}else if(n===0)S=1/U,L=1/st;else{const tt=U*n,at=st*n;S=tt<1?1/tt:1,L=at<1?1/at:1}}else{const U=Math.abs(o*u-s*h),st=Math.hypot(o,s),tt=Math.hypot(h,u);if(n===0)S=tt/U,L=st/U;else{const at=n*U;S=tt>at?tt/at:1,L=st>at?st/at:1}}this._cachedScaleForStroking[0]=S,this._cachedScaleForStroking[1]=L}return this._cachedScaleForStroking}rescaleAndStroke(n){const{ctx:o}=this,{lineWidth:s}=this.current,[h,u]=this.getScaleForStroking();if(o.lineWidth=s||1,h===1&&u===1){o.stroke();return}const S=o.getLineDash();if(n&&o.save(),o.scale(h,u),S.length>0){const L=Math.max(h,u);o.setLineDash(S.map(U=>U/L)),o.lineDashOffset/=L}o.stroke(),n&&o.restore()}isContentVisible(){for(let n=this.markedContentStack.length-1;n>=0;n--)if(!this.markedContentStack[n].visible)return!1;return!0}};$=new WeakSet,Ze=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},bt=new WeakSet,tn=function(){if(this.pageColors){const n=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(n!=="none"){const o=this.ctx.filter;this.ctx.filter=n,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=o}}};let lt=wt;a.CanvasGraphics=lt;for(const R in i.OPS)lt.prototype[R]!==void 0&&(lt.prototype[i.OPS[R]]=lt.prototype[R])},(D,a,j)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TilingPattern=a.PathType=void 0,a.getShadingPattern=x;var i=j(1),p=j(6);const V={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};a.PathType=V;function W(_,P){if(!P)return;const w=P[2]-P[0],A=P[3]-P[1],l=new Path2D;l.rect(P[0],P[1],w,A),_.clip(l)}class dt{constructor(){this.constructor===dt&&(0,i.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,i.unreachable)("Abstract method `getPattern` called.")}}class F extends dt{constructor(P){super(),this._type=P[1],this._bbox=P[2],this._colorStops=P[3],this._p0=P[4],this._p1=P[5],this._r0=P[6],this._r1=P[7],this.matrix=null}_createGradient(P){let w;this._type==="axial"?w=P.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(w=P.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const A of this._colorStops)w.addColorStop(A[0],A[1]);return w}getPattern(P,w,A,l){let d;if(l===V.STROKE||l===V.FILL){const M=w.current.getClippedPathBoundingBox(l,(0,p.getCurrentTransform)(P))||[0,0,0,0],b=Math.ceil(M[2]-M[0])||1,c=Math.ceil(M[3]-M[1])||1,k=w.cachedCanvases.getCanvas("pattern",b,c,!0),g=k.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-M[0],-M[1]),A=i.Util.transform(A,[1,0,0,1,M[0],M[1]]),g.transform(...w.baseTransform),this.matrix&&g.transform(...this.matrix),W(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),d=P.createPattern(k.canvas,"no-repeat");const G=new DOMMatrix(A);d.setTransform(G)}else W(P,this._bbox),d=this._createGradient(P);return d}}function C(_,P,w,A,l,d,M,b){const c=P.coords,k=P.colors,g=_.data,G=_.width*4;let z;c[w+1]>c[A+1]&&(z=w,w=A,A=z,z=d,d=M,M=z),c[A+1]>c[l+1]&&(z=A,A=l,l=z,z=M,M=b,b=z),c[w+1]>c[A+1]&&(z=w,w=A,A=z,z=d,d=M,M=z);const T=(c[w]+P.offsetX)*P.scaleX,Y=(c[w+1]+P.offsetY)*P.scaleY,it=(c[A]+P.offsetX)*P.scaleX,lt=(c[A+1]+P.offsetY)*P.scaleY,$=(c[l]+P.offsetX)*P.scaleX,ht=(c[l+1]+P.offsetY)*P.scaleY;if(Y>=ht)return;const bt=k[d],St=k[d+1],wt=k[d+2],R=k[M],n=k[M+1],o=k[M+2],s=k[b],h=k[b+1],u=k[b+2],S=Math.round(Y),L=Math.round(ht);let U,st,tt,at,ut,gt,ct,Rt;for(let It=S;It<=L;It++){if(It<lt){const nt=It<Y?0:(Y-It)/(Y-lt);U=T-(T-it)*nt,st=bt-(bt-R)*nt,tt=St-(St-n)*nt,at=wt-(wt-o)*nt}else{let nt;It>ht?nt=1:lt===ht?nt=0:nt=(lt-It)/(lt-ht),U=it-(it-$)*nt,st=R-(R-s)*nt,tt=n-(n-h)*nt,at=o-(o-u)*nt}let Et;It<Y?Et=0:It>ht?Et=1:Et=(Y-It)/(Y-ht),ut=T-(T-$)*Et,gt=bt-(bt-s)*Et,ct=St-(St-h)*Et,Rt=wt-(wt-u)*Et;const Lt=Math.round(Math.min(U,ut)),mt=Math.round(Math.max(U,ut));let et=G*It+Lt*4;for(let nt=Lt;nt<=mt;nt++)Et=(U-nt)/(U-ut),Et<0?Et=0:Et>1&&(Et=1),g[et++]=st-(st-gt)*Et|0,g[et++]=tt-(tt-ct)*Et|0,g[et++]=at-(at-Rt)*Et|0,g[et++]=255}}function m(_,P,w){const A=P.coords,l=P.colors;let d,M;switch(P.type){case"lattice":const b=P.verticesPerRow,c=Math.floor(A.length/b)-1,k=b-1;for(d=0;d<c;d++){let g=d*b;for(let G=0;G<k;G++,g++)C(_,w,A[g],A[g+1],A[g+b],l[g],l[g+1],l[g+b]),C(_,w,A[g+b+1],A[g+1],A[g+b],l[g+b+1],l[g+1],l[g+b])}break;case"triangles":for(d=0,M=A.length;d<M;d+=3)C(_,w,A[d],A[d+1],A[d+2],l[d],l[d+1],l[d+2]);break;default:throw new Error("illegal figure")}}class I extends dt{constructor(P){super(),this._coords=P[2],this._colors=P[3],this._figures=P[4],this._bounds=P[5],this._bbox=P[7],this._background=P[8],this.matrix=null}_createMeshCanvas(P,w,A){const b=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),k=Math.ceil(this._bounds[2])-b,g=Math.ceil(this._bounds[3])-c,G=Math.min(Math.ceil(Math.abs(k*P[0]*1.1)),3e3),z=Math.min(Math.ceil(Math.abs(g*P[1]*1.1)),3e3),T=k/G,Y=g/z,it={coords:this._coords,colors:this._colors,offsetX:-b,offsetY:-c,scaleX:1/T,scaleY:1/Y},lt=G+2*2,$=z+2*2,ht=A.getCanvas("mesh",lt,$,!1),bt=ht.context,St=bt.createImageData(G,z);if(w){const R=St.data;for(let n=0,o=R.length;n<o;n+=4)R[n]=w[0],R[n+1]=w[1],R[n+2]=w[2],R[n+3]=255}for(const R of this._figures)m(St,R,it);return bt.putImageData(St,2,2),{canvas:ht.canvas,offsetX:b-2*T,offsetY:c-2*Y,scaleX:T,scaleY:Y}}getPattern(P,w,A,l){W(P,this._bbox);let d;if(l===V.SHADING)d=i.Util.singularValueDecompose2dScale((0,p.getCurrentTransform)(P));else if(d=i.Util.singularValueDecompose2dScale(w.baseTransform),this.matrix){const b=i.Util.singularValueDecompose2dScale(this.matrix);d=[d[0]*b[0],d[1]*b[1]]}const M=this._createMeshCanvas(d,l===V.SHADING?null:this._background,w.cachedCanvases);return l!==V.SHADING&&(P.setTransform(...w.baseTransform),this.matrix&&P.transform(...this.matrix)),P.translate(M.offsetX,M.offsetY),P.scale(M.scaleX,M.scaleY),P.createPattern(M.canvas,"no-repeat")}}class O extends dt{getPattern(){return"hotpink"}}function x(_){switch(_[0]){case"RadialAxial":return new F(_);case"Mesh":return new I(_);case"Dummy":return new O}throw new Error(`Unknown IR type: ${_[0]}`)}const E={COLORED:1,UNCOLORED:2},f=class f{constructor(P,w,A,l,d){this.operatorList=P[2],this.matrix=P[3]||[1,0,0,1,0,0],this.bbox=P[4],this.xstep=P[5],this.ystep=P[6],this.paintType=P[7],this.tilingType=P[8],this.color=w,this.ctx=A,this.canvasGraphicsFactory=l,this.baseTransform=d}createPatternCanvas(P){const w=this.operatorList,A=this.bbox,l=this.xstep,d=this.ystep,M=this.paintType,b=this.tilingType,c=this.color,k=this.canvasGraphicsFactory;(0,i.info)("TilingType: "+b);const g=A[0],G=A[1],z=A[2],T=A[3],Y=i.Util.singularValueDecompose2dScale(this.matrix),it=i.Util.singularValueDecompose2dScale(this.baseTransform),lt=[Y[0]*it[0],Y[1]*it[1]],$=this.getSizeAndScale(l,this.ctx.canvas.width,lt[0]),ht=this.getSizeAndScale(d,this.ctx.canvas.height,lt[1]),bt=P.cachedCanvases.getCanvas("pattern",$.size,ht.size,!0),St=bt.context,wt=k.createCanvasGraphics(St);wt.groupLevel=P.groupLevel,this.setFillAndStrokeStyleToContext(wt,M,c);let R=g,n=G,o=z,s=T;return g<0&&(R=0,o+=Math.abs(g)),G<0&&(n=0,s+=Math.abs(G)),St.translate(-($.scale*R),-(ht.scale*n)),wt.transform($.scale,0,0,ht.scale,0,0),St.save(),this.clipBbox(wt,R,n,o,s),wt.baseTransform=(0,p.getCurrentTransform)(wt.ctx),wt.executeOperatorList(w),wt.endDrawing(),{canvas:bt.canvas,scaleX:$.scale,scaleY:ht.scale,offsetX:R,offsetY:n}}getSizeAndScale(P,w,A){P=Math.abs(P);const l=Math.max(f.MAX_PATTERN_SIZE,w);let d=Math.ceil(P*A);return d>=l?d=l:A=d/P,{scale:A,size:d}}clipBbox(P,w,A,l,d){const M=l-w,b=d-A;P.ctx.rect(w,A,M,b),P.current.updateRectMinMax((0,p.getCurrentTransform)(P.ctx),[w,A,l,d]),P.clip(),P.endPath()}setFillAndStrokeStyleToContext(P,w,A){const l=P.ctx,d=P.current;switch(w){case E.COLORED:const M=this.ctx;l.fillStyle=M.fillStyle,l.strokeStyle=M.strokeStyle,d.fillColor=M.fillStyle,d.strokeColor=M.strokeStyle;break;case E.UNCOLORED:const b=i.Util.makeHexColor(A[0],A[1],A[2]);l.fillStyle=b,l.strokeStyle=b,d.fillColor=b,d.strokeColor=b;break;default:throw new i.FormatError(`Unsupported paint type: ${w}`)}}getPattern(P,w,A,l){let d=A;l!==V.SHADING&&(d=i.Util.transform(d,w.baseTransform),this.matrix&&(d=i.Util.transform(d,this.matrix)));const M=this.createPatternCanvas(w);let b=new DOMMatrix(d);b=b.translate(M.offsetX,M.offsetY),b=b.scale(1/M.scaleX,1/M.scaleY);const c=P.createPattern(M.canvas,"repeat");return c.setTransform(b),c}};ne(f,"MAX_PATTERN_SIZE",3e3);let v=f;a.TilingPattern=v},(D,a,j)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.convertBlackAndWhiteToRGBA=V,a.convertToRGBA=p,a.grayToRGBA=dt;var i=j(1);function p(F){switch(F.kind){case i.ImageKind.GRAYSCALE_1BPP:return V(F);case i.ImageKind.RGB_24BPP:return W(F)}return null}function V({src:F,srcPos:C=0,dest:m,width:I,height:O,nonBlackColor:x=4294967295,inverseDecode:E=!1}){const v=i.FeatureTest.isLittleEndian?4278190080:255,[f,_]=E?[x,v]:[v,x],P=I>>3,w=I&7,A=F.length;m=new Uint32Array(m.buffer);let l=0;for(let d=0;d<O;d++){for(const b=C+P;C<b;C++){const c=C<A?F[C]:255;m[l++]=c&128?_:f,m[l++]=c&64?_:f,m[l++]=c&32?_:f,m[l++]=c&16?_:f,m[l++]=c&8?_:f,m[l++]=c&4?_:f,m[l++]=c&2?_:f,m[l++]=c&1?_:f}if(w===0)continue;const M=C<A?F[C++]:255;for(let b=0;b<w;b++)m[l++]=M&1<<7-b?_:f}return{srcPos:C,destPos:l}}function W({src:F,srcPos:C=0,dest:m,destPos:I=0,width:O,height:x}){let E=0;const v=F.length>>2,f=new Uint32Array(F.buffer,C,v);if(i.FeatureTest.isLittleEndian){for(;E<v-2;E+=3,I+=4){const _=f[E],P=f[E+1],w=f[E+2];m[I]=_|4278190080,m[I+1]=_>>>24|P<<8|4278190080,m[I+2]=P>>>16|w<<16|4278190080,m[I+3]=w>>>8|4278190080}for(let _=E*4,P=F.length;_<P;_+=3)m[I++]=F[_]|F[_+1]<<8|F[_+2]<<16|4278190080}else{for(;E<v-2;E+=3,I+=4){const _=f[E],P=f[E+1],w=f[E+2];m[I]=_|255,m[I+1]=_<<24|P>>>8|255,m[I+2]=P<<16|w>>>16|255,m[I+3]=w<<8|255}for(let _=E*4,P=F.length;_<P;_+=3)m[I++]=F[_]<<24|F[_+1]<<16|F[_+2]<<8|255}return{srcPos:C,destPos:I}}function dt(F,C){if(i.FeatureTest.isLittleEndian)for(let m=0,I=F.length;m<I;m++)C[m]=F[m]*65793|4278190080;else for(let m=0,I=F.length;m<I;m++)C[m]=F[m]*16843008|255}},(D,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.GlobalWorkerOptions=void 0;const j=Object.create(null);a.GlobalWorkerOptions=j,j.workerPort=null,j.workerSrc=""},(D,a,j)=>{var F,kn,m,Fn,O,xe;Object.defineProperty(a,"__esModule",{value:!0}),a.MessageHandler=void 0;var i=j(1);const p={UNKNOWN:0,DATA:1,ERROR:2},V={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function W(E){switch(E instanceof Error||typeof E=="object"&&E!==null||(0,i.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),E.name){case"AbortException":return new i.AbortException(E.message);case"MissingPDFException":return new i.MissingPDFException(E.message);case"PasswordException":return new i.PasswordException(E.message,E.code);case"UnexpectedResponseException":return new i.UnexpectedResponseException(E.message,E.status);case"UnknownErrorException":return new i.UnknownErrorException(E.message,E.details);default:return new i.UnknownErrorException(E.message,E.toString())}}class dt{constructor(v,f,_){H(this,F);H(this,m);H(this,O);this.sourceName=v,this.targetName=f,this.comObj=_,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=P=>{const w=P.data;if(w.targetName!==this.sourceName)return;if(w.stream){q(this,m,Fn).call(this,w);return}if(w.callback){const l=w.callbackId,d=this.callbackCapabilities[l];if(!d)throw new Error(`Cannot resolve callback ${l}`);if(delete this.callbackCapabilities[l],w.callback===p.DATA)d.resolve(w.data);else if(w.callback===p.ERROR)d.reject(W(w.reason));else throw new Error("Unexpected callback case");return}const A=this.actionHandler[w.action];if(!A)throw new Error(`Unknown action from worker: ${w.action}`);if(w.callbackId){const l=this.sourceName,d=w.sourceName;new Promise(function(M){M(A(w.data))}).then(function(M){_.postMessage({sourceName:l,targetName:d,callback:p.DATA,callbackId:w.callbackId,data:M})},function(M){_.postMessage({sourceName:l,targetName:d,callback:p.ERROR,callbackId:w.callbackId,reason:W(M)})});return}if(w.streamId){q(this,F,kn).call(this,w);return}A(w.data)},_.addEventListener("message",this._onComObjOnMessage)}on(v,f){const _=this.actionHandler;if(_[v])throw new Error(`There is already an actionName called "${v}"`);_[v]=f}send(v,f,_){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:v,data:f},_)}sendWithPromise(v,f,_){const P=this.callbackId++,w=new i.PromiseCapability;this.callbackCapabilities[P]=w;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:v,callbackId:P,data:f},_)}catch(A){w.reject(A)}return w.promise}sendWithStream(v,f,_,P){const w=this.streamId++,A=this.sourceName,l=this.targetName,d=this.comObj;return new ReadableStream({start:M=>{const b=new i.PromiseCapability;return this.streamControllers[w]={controller:M,startCall:b,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:A,targetName:l,action:v,streamId:w,data:f,desiredSize:M.desiredSize},P),b.promise},pull:M=>{const b=new i.PromiseCapability;return this.streamControllers[w].pullCall=b,d.postMessage({sourceName:A,targetName:l,stream:V.PULL,streamId:w,desiredSize:M.desiredSize}),b.promise},cancel:M=>{(0,i.assert)(M instanceof Error,"cancel must have a valid reason");const b=new i.PromiseCapability;return this.streamControllers[w].cancelCall=b,this.streamControllers[w].isClosed=!0,d.postMessage({sourceName:A,targetName:l,stream:V.CANCEL,streamId:w,reason:W(M)}),b.promise}},_)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}F=new WeakSet,kn=function(v){const f=v.streamId,_=this.sourceName,P=v.sourceName,w=this.comObj,A=this,l=this.actionHandler[v.action],d={enqueue(M,b=1,c){if(this.isCancelled)return;const k=this.desiredSize;this.desiredSize-=b,k>0&&this.desiredSize<=0&&(this.sinkCapability=new i.PromiseCapability,this.ready=this.sinkCapability.promise),w.postMessage({sourceName:_,targetName:P,stream:V.ENQUEUE,streamId:f,chunk:M},c)},close(){this.isCancelled||(this.isCancelled=!0,w.postMessage({sourceName:_,targetName:P,stream:V.CLOSE,streamId:f}),delete A.streamSinks[f])},error(M){(0,i.assert)(M instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,w.postMessage({sourceName:_,targetName:P,stream:V.ERROR,streamId:f,reason:W(M)}))},sinkCapability:new i.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:v.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[f]=d,new Promise(function(M){M(l(v.data,d))}).then(function(){w.postMessage({sourceName:_,targetName:P,stream:V.START_COMPLETE,streamId:f,success:!0})},function(M){w.postMessage({sourceName:_,targetName:P,stream:V.START_COMPLETE,streamId:f,reason:W(M)})})},m=new WeakSet,Fn=function(v){const f=v.streamId,_=this.sourceName,P=v.sourceName,w=this.comObj,A=this.streamControllers[f],l=this.streamSinks[f];switch(v.stream){case V.START_COMPLETE:v.success?A.startCall.resolve():A.startCall.reject(W(v.reason));break;case V.PULL_COMPLETE:v.success?A.pullCall.resolve():A.pullCall.reject(W(v.reason));break;case V.PULL:if(!l){w.postMessage({sourceName:_,targetName:P,stream:V.PULL_COMPLETE,streamId:f,success:!0});break}l.desiredSize<=0&&v.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=v.desiredSize,new Promise(function(d){var M;d((M=l.onPull)==null?void 0:M.call(l))}).then(function(){w.postMessage({sourceName:_,targetName:P,stream:V.PULL_COMPLETE,streamId:f,success:!0})},function(d){w.postMessage({sourceName:_,targetName:P,stream:V.PULL_COMPLETE,streamId:f,reason:W(d)})});break;case V.ENQUEUE:if((0,i.assert)(A,"enqueue should have stream controller"),A.isClosed)break;A.controller.enqueue(v.chunk);break;case V.CLOSE:if((0,i.assert)(A,"close should have stream controller"),A.isClosed)break;A.isClosed=!0,A.controller.close(),q(this,O,xe).call(this,A,f);break;case V.ERROR:(0,i.assert)(A,"error should have stream controller"),A.controller.error(W(v.reason)),q(this,O,xe).call(this,A,f);break;case V.CANCEL_COMPLETE:v.success?A.cancelCall.resolve():A.cancelCall.reject(W(v.reason)),q(this,O,xe).call(this,A,f);break;case V.CANCEL:if(!l)break;new Promise(function(d){var M;d((M=l.onCancel)==null?void 0:M.call(l,W(v.reason)))}).then(function(){w.postMessage({sourceName:_,targetName:P,stream:V.CANCEL_COMPLETE,streamId:f,success:!0})},function(d){w.postMessage({sourceName:_,targetName:P,stream:V.CANCEL_COMPLETE,streamId:f,reason:W(d)})}),l.sinkCapability.reject(W(v.reason)),l.isCancelled=!0,delete this.streamSinks[f];break;default:throw new Error("Unexpected stream case")}},O=new WeakSet,xe=async function(v,f){var _,P,w;await Promise.allSettled([(_=v.startCall)==null?void 0:_.promise,(P=v.pullCall)==null?void 0:P.promise,(w=v.cancelCall)==null?void 0:w.promise]),delete this.streamControllers[f]},a.MessageHandler=dt},(D,a,j)=>{var V,W;Object.defineProperty(a,"__esModule",{value:!0}),a.Metadata=void 0;var i=j(1);class p{constructor({parsedData:F,rawData:C}){H(this,V,void 0);H(this,W,void 0);rt(this,V,F),rt(this,W,C)}getRaw(){return t(this,W)}get(F){return t(this,V).get(F)??null}getAll(){return(0,i.objectFromMap)(t(this,V))}has(F){return t(this,V).has(F)}}V=new WeakMap,W=new WeakMap,a.Metadata=p},(D,a,j)=>{var F,C,m,I,O,x,en;Object.defineProperty(a,"__esModule",{value:!0}),a.OptionalContentConfig=void 0;var i=j(1),p=j(8);const V=Symbol("INTERNAL");class W{constructor(f,_){H(this,F,!0);this.name=f,this.intent=_}get visible(){return t(this,F)}_setVisible(f,_){f!==V&&(0,i.unreachable)("Internal method `_setVisible` called."),rt(this,F,_)}}F=new WeakMap;class dt{constructor(f){H(this,x);H(this,C,null);H(this,m,new Map);H(this,I,null);H(this,O,null);if(this.name=null,this.creator=null,f!==null){this.name=f.name,this.creator=f.creator,rt(this,O,f.order);for(const _ of f.groups)t(this,m).set(_.id,new W(_.name,_.intent));if(f.baseState==="OFF")for(const _ of t(this,m).values())_._setVisible(V,!1);for(const _ of f.on)t(this,m).get(_)._setVisible(V,!0);for(const _ of f.off)t(this,m).get(_)._setVisible(V,!1);rt(this,I,this.getHash())}}isVisible(f){if(t(this,m).size===0)return!0;if(!f)return(0,i.warn)("Optional content group not defined."),!0;if(f.type==="OCG")return t(this,m).has(f.id)?t(this,m).get(f.id).visible:((0,i.warn)(`Optional content group not found: ${f.id}`),!0);if(f.type==="OCMD"){if(f.expression)return q(this,x,en).call(this,f.expression);if(!f.policy||f.policy==="AnyOn"){for(const _ of f.ids){if(!t(this,m).has(_))return(0,i.warn)(`Optional content group not found: ${_}`),!0;if(t(this,m).get(_).visible)return!0}return!1}else if(f.policy==="AllOn"){for(const _ of f.ids){if(!t(this,m).has(_))return(0,i.warn)(`Optional content group not found: ${_}`),!0;if(!t(this,m).get(_).visible)return!1}return!0}else if(f.policy==="AnyOff"){for(const _ of f.ids){if(!t(this,m).has(_))return(0,i.warn)(`Optional content group not found: ${_}`),!0;if(!t(this,m).get(_).visible)return!0}return!1}else if(f.policy==="AllOff"){for(const _ of f.ids){if(!t(this,m).has(_))return(0,i.warn)(`Optional content group not found: ${_}`),!0;if(t(this,m).get(_).visible)return!1}return!0}return(0,i.warn)(`Unknown optional content policy ${f.policy}.`),!0}return(0,i.warn)(`Unknown group type ${f.type}.`),!0}setVisibility(f,_=!0){if(!t(this,m).has(f)){(0,i.warn)(`Optional content group not found: ${f}`);return}t(this,m).get(f)._setVisible(V,!!_),rt(this,C,null)}get hasInitialVisibility(){return t(this,I)===null||this.getHash()===t(this,I)}getOrder(){return t(this,m).size?t(this,O)?t(this,O).slice():[...t(this,m).keys()]:null}getGroups(){return t(this,m).size>0?(0,i.objectFromMap)(t(this,m)):null}getGroup(f){return t(this,m).get(f)||null}getHash(){if(t(this,C)!==null)return t(this,C);const f=new p.MurmurHash3_64;for(const[_,P]of t(this,m))f.update(`${_}:${P.visible}`);return rt(this,C,f.hexdigest())}}C=new WeakMap,m=new WeakMap,I=new WeakMap,O=new WeakMap,x=new WeakSet,en=function(f){const _=f.length;if(_<2)return!0;const P=f[0];for(let w=1;w<_;w++){const A=f[w];let l;if(Array.isArray(A))l=q(this,x,en).call(this,A);else if(t(this,m).has(A))l=t(this,m).get(A).visible;else return(0,i.warn)(`Optional content group not found: ${A}`),!0;switch(P){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return P==="And"},a.OptionalContentConfig=dt},(D,a,j)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFDataTransportStream=void 0;var i=j(1),p=j(6);class V{constructor({length:C,initialData:m,progressiveDone:I=!1,contentDispositionFilename:O=null,disableRange:x=!1,disableStream:E=!1},v){if((0,i.assert)(v,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=I,this._contentDispositionFilename=O,(m==null?void 0:m.length)>0){const f=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=v,this._isStreamingSupported=!E,this._isRangeSupported=!x,this._contentLength=C,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((f,_)=>{this._onReceiveData({begin:f,chunk:_})}),this._pdfDataRangeTransport.addProgressListener((f,_)=>{this._onProgress({loaded:f,total:_})}),this._pdfDataRangeTransport.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:C,chunk:m}){const I=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;if(C===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(I):this._queuedChunks.push(I);else{const O=this._rangeReaders.some(function(x){return x._begin!==C?!1:(x._enqueue(I),!0)});(0,i.assert)(O,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var C;return((C=this._fullRequestReader)==null?void 0:C._loaded)??0}_onProgress(C){var m,I,O,x;C.total===void 0?(I=(m=this._rangeReaders[0])==null?void 0:m.onProgress)==null||I.call(m,{loaded:C.loaded}):(x=(O=this._fullRequestReader)==null?void 0:O.onProgress)==null||x.call(O,{loaded:C.loaded,total:C.total})}_onProgressiveDone(){var C;(C=this._fullRequestReader)==null||C.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(C){const m=this._rangeReaders.indexOf(C);m>=0&&this._rangeReaders.splice(m,1)}getFullReader(){(0,i.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const C=this._queuedChunks;return this._queuedChunks=null,new W(this,C,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(C,m){if(m<=this._progressiveDataLength)return null;const I=new dt(this,C,m);return this._pdfDataRangeTransport.requestDataRange(C,m),this._rangeReaders.push(I),I}cancelAllRequests(C){var m;(m=this._fullRequestReader)==null||m.cancel(C);for(const I of this._rangeReaders.slice(0))I.cancel(C);this._pdfDataRangeTransport.abort()}}a.PDFDataTransportStream=V;class W{constructor(C,m,I=!1,O=null){this._stream=C,this._done=I||!1,this._filename=(0,p.isPdfFile)(O)?O:null,this._queuedChunks=m||[],this._loaded=0;for(const x of this._queuedChunks)this._loaded+=x.byteLength;this._requests=[],this._headersReady=Promise.resolve(),C._fullRequestReader=this,this.onProgress=null}_enqueue(C){this._done||(this._requests.length>0?this._requests.shift().resolve({value:C,done:!1}):this._queuedChunks.push(C),this._loaded+=C.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const C=new i.PromiseCapability;return this._requests.push(C),C.promise}cancel(C){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class dt{constructor(C,m,I){this._stream=C,this._begin=m,this._end=I,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(C){if(!this._done){if(this._requests.length===0)this._queuedChunk=C;else{this._requests.shift().resolve({value:C,done:!1});for(const I of this._requests)I.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const C=new i.PromiseCapability;return this._requests.push(C),C.promise}cancel(C){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(D,a,j)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFFetchStream=void 0;var i=j(1),p=j(20);function V(I,O,x){return{method:"GET",headers:I,signal:x.signal,mode:"cors",credentials:O?"include":"same-origin",redirect:"follow"}}function W(I){const O=new Headers;for(const x in I){const E=I[x];E!==void 0&&O.append(x,E)}return O}function dt(I){return I instanceof Uint8Array?I.buffer:I instanceof ArrayBuffer?I:((0,i.warn)(`getArrayBuffer - unexpected data format: ${I}`),new Uint8Array(I).buffer)}class F{constructor(O){this.source=O,this.isHttp=/^https?:/i.test(O.url),this.httpHeaders=this.isHttp&&O.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var O;return((O=this._fullRequestReader)==null?void 0:O._loaded)??0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new C(this),this._fullRequestReader}getRangeReader(O,x){if(x<=this._progressiveDataLength)return null;const E=new m(this,O,x);return this._rangeRequestReaders.push(E),E}cancelAllRequests(O){var x;(x=this._fullRequestReader)==null||x.cancel(O);for(const E of this._rangeRequestReaders.slice(0))E.cancel(O)}}a.PDFFetchStream=F;class C{constructor(O){this._stream=O,this._reader=null,this._loaded=0,this._filename=null;const x=O.source;this._withCredentials=x.withCredentials||!1,this._contentLength=x.length,this._headersCapability=new i.PromiseCapability,this._disableRange=x.disableRange||!1,this._rangeChunkSize=x.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!x.disableStream,this._isRangeSupported=!x.disableRange,this._headers=W(this._stream.httpHeaders);const E=x.url;fetch(E,V(this._headers,this._withCredentials,this._abortController)).then(v=>{if(!(0,p.validateResponseStatus)(v.status))throw(0,p.createResponseStatusError)(v.status,E);this._reader=v.body.getReader(),this._headersCapability.resolve();const f=w=>v.headers.get(w),{allowRangeRequests:_,suggestedLength:P}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:f,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=_,this._contentLength=P||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(f),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new i.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var E;await this._headersCapability.promise;const{value:O,done:x}=await this._reader.read();return x?{value:O,done:x}:(this._loaded+=O.byteLength,(E=this.onProgress)==null||E.call(this,{loaded:this._loaded,total:this._contentLength}),{value:dt(O),done:!1})}cancel(O){var x;(x=this._reader)==null||x.cancel(O),this._abortController.abort()}}class m{constructor(O,x,E){this._stream=O,this._reader=null,this._loaded=0;const v=O.source;this._withCredentials=v.withCredentials||!1,this._readCapability=new i.PromiseCapability,this._isStreamingSupported=!v.disableStream,this._abortController=new AbortController,this._headers=W(this._stream.httpHeaders),this._headers.append("Range",`bytes=${x}-${E-1}`);const f=v.url;fetch(f,V(this._headers,this._withCredentials,this._abortController)).then(_=>{if(!(0,p.validateResponseStatus)(_.status))throw(0,p.createResponseStatusError)(_.status,f);this._readCapability.resolve(),this._reader=_.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var E;await this._readCapability.promise;const{value:O,done:x}=await this._reader.read();return x?{value:O,done:x}:(this._loaded+=O.byteLength,(E=this.onProgress)==null||E.call(this,{loaded:this._loaded}),{value:dt(O),done:!1})}cancel(O){var x;(x=this._reader)==null||x.cancel(O),this._abortController.abort()}}},(D,a,j)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createResponseStatusError=F,a.extractFilenameFromHeader=dt,a.validateRangeRequestCapabilities=W,a.validateResponseStatus=C;var i=j(1),p=j(21),V=j(6);function W({getResponseHeader:m,isHttp:I,rangeChunkSize:O,disableRange:x}){const E={allowRangeRequests:!1,suggestedLength:void 0},v=parseInt(m("Content-Length"),10);return!Number.isInteger(v)||(E.suggestedLength=v,v<=2*O)||x||!I||m("Accept-Ranges")!=="bytes"||(m("Content-Encoding")||"identity")!=="identity"||(E.allowRangeRequests=!0),E}function dt(m){const I=m("Content-Disposition");if(I){let O=(0,p.getFilenameFromContentDispositionHeader)(I);if(O.includes("%"))try{O=decodeURIComponent(O)}catch{}if((0,V.isPdfFile)(O))return O}return null}function F(m,I){return m===404||m===0&&I.startsWith("file:")?new i.MissingPDFException('Missing PDF "'+I+'".'):new i.UnexpectedResponseException(`Unexpected server response (${m}) while retrieving PDF "${I}".`,m)}function C(m){return m===200||m===206}},(D,a,j)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.getFilenameFromContentDispositionHeader=p;var i=j(1);function p(V){let W=!0,dt=F("filename\\*","i").exec(V);if(dt){dt=dt[1];let v=O(dt);return v=unescape(v),v=x(v),v=E(v),m(v)}if(dt=I(V),dt){const v=E(dt);return m(v)}if(dt=F("filename","i").exec(V),dt){dt=dt[1];let v=O(dt);return v=E(v),m(v)}function F(v,f){return new RegExp("(?:^|;)\\s*"+v+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function C(v,f){if(v){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const _=new TextDecoder(v,{fatal:!0}),P=(0,i.stringToBytes)(f);f=_.decode(P),W=!1}catch{}}return f}function m(v){return W&&/[\x80-\xff]/.test(v)&&(v=C("utf-8",v),W&&(v=C("iso-8859-1",v))),v}function I(v){const f=[];let _;const P=F("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(_=P.exec(v))!==null;){let[,A,l,d]=_;if(A=parseInt(A,10),A in f){if(A===0)break;continue}f[A]=[l,d]}const w=[];for(let A=0;A<f.length&&A in f;++A){let[l,d]=f[A];d=O(d),l&&(d=unescape(d),A===0&&(d=x(d))),w.push(d)}return w.join("")}function O(v){if(v.startsWith('"')){const f=v.slice(1).split('\\"');for(let _=0;_<f.length;++_){const P=f[_].indexOf('"');P!==-1&&(f[_]=f[_].slice(0,P),f.length=_+1),f[_]=f[_].replaceAll(/\\(.)/g,"$1")}v=f.join('"')}return v}function x(v){const f=v.indexOf("'");if(f===-1)return v;const _=v.slice(0,f),w=v.slice(f+1).replace(/^[^']*'/,"");return C(_,w)}function E(v){return!v.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(v)?v:v.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,_,P,w){if(P==="q"||P==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,l){return String.fromCharCode(parseInt(l,16))}),C(_,w);try{w=atob(w)}catch{}return C(_,w)})}return""}},(D,a,j)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFNetworkStream=void 0;var i=j(1),p=j(20);const V=200,W=206;function dt(O){const x=O.response;return typeof x!="string"?x:(0,i.stringToBytes)(x).buffer}class F{constructor(x,E={}){this.url=x,this.isHttp=/^https?:/i.test(x),this.httpHeaders=this.isHttp&&E.httpHeaders||Object.create(null),this.withCredentials=E.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(x,E,v){const f={begin:x,end:E};for(const _ in v)f[_]=v[_];return this.request(f)}requestFull(x){return this.request(x)}request(x){const E=new XMLHttpRequest,v=this.currXhrId++,f=this.pendingRequests[v]={xhr:E};E.open("GET",this.url),E.withCredentials=this.withCredentials;for(const _ in this.httpHeaders){const P=this.httpHeaders[_];P!==void 0&&E.setRequestHeader(_,P)}return this.isHttp&&"begin"in x&&"end"in x?(E.setRequestHeader("Range",`bytes=${x.begin}-${x.end-1}`),f.expectedStatus=W):f.expectedStatus=V,E.responseType="arraybuffer",x.onError&&(E.onerror=function(_){x.onError(E.status)}),E.onreadystatechange=this.onStateChange.bind(this,v),E.onprogress=this.onProgress.bind(this,v),f.onHeadersReceived=x.onHeadersReceived,f.onDone=x.onDone,f.onError=x.onError,f.onProgress=x.onProgress,E.send(null),v}onProgress(x,E){var f;const v=this.pendingRequests[x];v&&((f=v.onProgress)==null||f.call(v,E))}onStateChange(x,E){var A,l,d;const v=this.pendingRequests[x];if(!v)return;const f=v.xhr;if(f.readyState>=2&&v.onHeadersReceived&&(v.onHeadersReceived(),delete v.onHeadersReceived),f.readyState!==4||!(x in this.pendingRequests))return;if(delete this.pendingRequests[x],f.status===0&&this.isHttp){(A=v.onError)==null||A.call(v,f.status);return}const _=f.status||V;if(!(_===V&&v.expectedStatus===W)&&_!==v.expectedStatus){(l=v.onError)==null||l.call(v,f.status);return}const w=dt(f);if(_===W){const M=f.getResponseHeader("Content-Range"),b=/bytes (\d+)-(\d+)\/(\d+)/.exec(M);v.onDone({begin:parseInt(b[1],10),chunk:w})}else w?v.onDone({begin:0,chunk:w}):(d=v.onError)==null||d.call(v,f.status)}getRequestXhr(x){return this.pendingRequests[x].xhr}isPendingRequest(x){return x in this.pendingRequests}abortRequest(x){const E=this.pendingRequests[x].xhr;delete this.pendingRequests[x],E.abort()}}class C{constructor(x){this._source=x,this._manager=new F(x.url,{httpHeaders:x.httpHeaders,withCredentials:x.withCredentials}),this._rangeChunkSize=x.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(x){const E=this._rangeRequestReaders.indexOf(x);E>=0&&this._rangeRequestReaders.splice(E,1)}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new m(this._manager,this._source),this._fullRequestReader}getRangeReader(x,E){const v=new I(this._manager,x,E);return v.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(v),v}cancelAllRequests(x){var E;(E=this._fullRequestReader)==null||E.cancel(x);for(const v of this._rangeRequestReaders.slice(0))v.cancel(x)}}a.PDFNetworkStream=C;class m{constructor(x,E){this._manager=x;const v={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=E.url,this._fullRequestId=x.requestFull(v),this._headersReceivedCapability=new i.PromiseCapability,this._disableRange=E.disableRange||!1,this._contentLength=E.length,this._rangeChunkSize=E.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const x=this._fullRequestId,E=this._manager.getRequestXhr(x),v=P=>E.getResponseHeader(P),{allowRangeRequests:f,suggestedLength:_}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:v,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});f&&(this._isRangeSupported=!0),this._contentLength=_||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(v),this._isRangeSupported&&this._manager.abortRequest(x),this._headersReceivedCapability.resolve()}_onDone(x){if(x&&(this._requests.length>0?this._requests.shift().resolve({value:x.chunk,done:!1}):this._cachedChunks.push(x.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(x){this._storedError=(0,p.createResponseStatusError)(x,this._url),this._headersReceivedCapability.reject(this._storedError);for(const E of this._requests)E.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(x){var E;(E=this.onProgress)==null||E.call(this,{loaded:x.loaded,total:x.lengthComputable?x.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const x=new i.PromiseCapability;return this._requests.push(x),x.promise}cancel(x){this._done=!0,this._headersReceivedCapability.reject(x);for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class I{constructor(x,E,v){this._manager=x;const f={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=x.url,this._requestId=x.requestRange(E,v,f),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var x;(x=this.onClosed)==null||x.call(this,this)}_onDone(x){const E=x.chunk;this._requests.length>0?this._requests.shift().resolve({value:E,done:!1}):this._queuedChunk=E,this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(x){this._storedError=(0,p.createResponseStatusError)(x,this._url);for(const E of this._requests)E.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(x){var E;this.isStreamingSupported||(E=this.onProgress)==null||E.call(this,{loaded:x.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const E=this._queuedChunk;return this._queuedChunk=null,{value:E,done:!1}}if(this._done)return{value:void 0,done:!0};const x=new i.PromiseCapability;return this._requests.push(x),x.promise}cancel(x){this._done=!0;for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(D,a,j)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFNodeStream=void 0;var i=j(1),p=j(20);const V=/^file:\/\/\/[a-zA-Z]:\//;function W(v){const f=require$$5,_=f.parse(v);return _.protocol==="file:"||_.host?_:/^[a-z]:[/\\]/i.test(v)?f.parse(`file:///${v}`):(_.host||(_.protocol="file:"),_)}class dt{constructor(f){this.source=f,this.url=W(f.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&f.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new x(this):new I(this),this._fullRequestReader}getRangeReader(f,_){if(_<=this._progressiveDataLength)return null;const P=this.isFsUrl?new E(this,f,_):new O(this,f,_);return this._rangeRequestReaders.push(P),P}cancelAllRequests(f){var _;(_=this._fullRequestReader)==null||_.cancel(f);for(const P of this._rangeRequestReaders.slice(0))P.cancel(f)}}a.PDFNodeStream=dt;class F{constructor(f){this._url=f.url,this._done=!1,this._storedError=null,this.onProgress=null;const _=f.source;this._contentLength=_.length,this._loaded=0,this._filename=null,this._disableRange=_.disableRange||!1,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!_.disableStream,this._isRangeSupported=!_.disableRange,this._readableStream=null,this._readCapability=new i.PromiseCapability,this._headersCapability=new i.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var P;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const f=this._readableStream.read();return f===null?(this._readCapability=new i.PromiseCapability,this.read()):(this._loaded+=f.length,(P=this.onProgress)==null||P.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(f).buffer,done:!1})}cancel(f){if(!this._readableStream){this._error(f);return}this._readableStream.destroy(f)}_error(f){this._storedError=f,this._readCapability.resolve()}_setReadableStream(f){this._readableStream=f,f.on("readable",()=>{this._readCapability.resolve()}),f.on("end",()=>{f.destroy(),this._done=!0,this._readCapability.resolve()}),f.on("error",_=>{this._error(_)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new i.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class C{constructor(f){this._url=f.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new i.PromiseCapability;const _=f.source;this._isStreamingSupported=!_.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var P;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const f=this._readableStream.read();return f===null?(this._readCapability=new i.PromiseCapability,this.read()):(this._loaded+=f.length,(P=this.onProgress)==null||P.call(this,{loaded:this._loaded}),{value:new Uint8Array(f).buffer,done:!1})}cancel(f){if(!this._readableStream){this._error(f);return}this._readableStream.destroy(f)}_error(f){this._storedError=f,this._readCapability.resolve()}_setReadableStream(f){this._readableStream=f,f.on("readable",()=>{this._readCapability.resolve()}),f.on("end",()=>{f.destroy(),this._done=!0,this._readCapability.resolve()}),f.on("error",_=>{this._error(_)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function m(v,f){return{protocol:v.protocol,auth:v.auth,host:v.hostname,port:v.port,path:v.path,method:"GET",headers:f}}class I extends F{constructor(f){super(f);const _=P=>{if(P.statusCode===404){const d=new i.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=d,this._headersCapability.reject(d);return}this._headersCapability.resolve(),this._setReadableStream(P);const w=d=>this._readableStream.headers[d.toLowerCase()],{allowRangeRequests:A,suggestedLength:l}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:w,isHttp:f.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=A,this._contentLength=l||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(w)};if(this._request=null,this._url.protocol==="http:"){const P=require$$5;this._request=P.request(m(this._url,f.httpHeaders),_)}else{const P=require$$5;this._request=P.request(m(this._url,f.httpHeaders),_)}this._request.on("error",P=>{this._storedError=P,this._headersCapability.reject(P)}),this._request.end()}}class O extends C{constructor(f,_,P){super(f),this._httpHeaders={};for(const A in f.httpHeaders){const l=f.httpHeaders[A];l!==void 0&&(this._httpHeaders[A]=l)}this._httpHeaders.Range=`bytes=${_}-${P-1}`;const w=A=>{if(A.statusCode===404){const l=new i.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=l;return}this._setReadableStream(A)};if(this._request=null,this._url.protocol==="http:"){const A=require$$5;this._request=A.request(m(this._url,this._httpHeaders),w)}else{const A=require$$5;this._request=A.request(m(this._url,this._httpHeaders),w)}this._request.on("error",A=>{this._storedError=A}),this._request.end()}}class x extends F{constructor(f){super(f);let _=decodeURIComponent(this._url.path);V.test(this._url.href)&&(_=_.replace(/^\//,""));const P=require$$5;P.lstat(_,(w,A)=>{if(w){w.code==="ENOENT"&&(w=new i.MissingPDFException(`Missing PDF "${_}".`)),this._storedError=w,this._headersCapability.reject(w);return}this._contentLength=A.size,this._setReadableStream(P.createReadStream(_)),this._headersCapability.resolve()})}}class E extends C{constructor(f,_,P){super(f);let w=decodeURIComponent(this._url.path);V.test(this._url.href)&&(w=w.replace(/^\//,""));const A=require$$5;this._setReadableStream(A.createReadStream(w,{start:_,end:P-1}))}}},(D,a,j)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.SVGGraphics=void 0;var i=j(6),p=j(1);const V={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},W="http://www.w3.org/XML/1998/namespace",dt="http://www.w3.org/1999/xlink",F=["butt","round","square"],C=["miter","round","bevel"],m=function(A,l="",d=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!d)return URL.createObjectURL(new Blob([A],{type:l}));const M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let b=`data:${l};base64,`;for(let c=0,k=A.length;c<k;c+=3){const g=A[c]&255,G=A[c+1]&255,z=A[c+2]&255,T=g>>2,Y=(g&3)<<4|G>>4,it=c+1<k?(G&15)<<2|z>>6:64,lt=c+2<k?z&63:64;b+=M[T]+M[Y]+M[it]+M[lt]}return b},I=function(){const A=new Uint8Array([137,80,78,71,13,10,26,10]),l=12,d=new Int32Array(256);for(let z=0;z<256;z++){let T=z;for(let Y=0;Y<8;Y++)T=T&1?3988292384^T>>1&2147483647:T>>1&2147483647;d[z]=T}function M(z,T,Y){let it=-1;for(let lt=T;lt<Y;lt++){const $=(it^z[lt])&255,ht=d[$];it=it>>>8^ht}return it^-1}function b(z,T,Y,it){let lt=it;const $=T.length;Y[lt]=$>>24&255,Y[lt+1]=$>>16&255,Y[lt+2]=$>>8&255,Y[lt+3]=$&255,lt+=4,Y[lt]=z.charCodeAt(0)&255,Y[lt+1]=z.charCodeAt(1)&255,Y[lt+2]=z.charCodeAt(2)&255,Y[lt+3]=z.charCodeAt(3)&255,lt+=4,Y.set(T,lt),lt+=T.length;const ht=M(Y,it+4,lt);Y[lt]=ht>>24&255,Y[lt+1]=ht>>16&255,Y[lt+2]=ht>>8&255,Y[lt+3]=ht&255}function c(z,T,Y){let it=1,lt=0;for(let $=T;$<Y;++$)it=(it+(z[$]&255))%65521,lt=(lt+it)%65521;return lt<<16|it}function k(z){if(!p.isNodeJS)return g(z);try{const T=parseInt(process.versions.node)>=8?z:Buffer.from(z),Y=require$$5.deflateSync(T,{level:9});return Y instanceof Uint8Array?Y:new Uint8Array(Y)}catch(T){(0,p.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+T)}return g(z)}function g(z){let T=z.length;const Y=65535,it=Math.ceil(T/Y),lt=new Uint8Array(2+T+it*5+4);let $=0;lt[$++]=120,lt[$++]=156;let ht=0;for(;T>Y;)lt[$++]=0,lt[$++]=255,lt[$++]=255,lt[$++]=0,lt[$++]=0,lt.set(z.subarray(ht,ht+Y),$),$+=Y,ht+=Y,T-=Y;lt[$++]=1,lt[$++]=T&255,lt[$++]=T>>8&255,lt[$++]=~T&65535&255,lt[$++]=(~T&65535)>>8&255,lt.set(z.subarray(ht),$),$+=z.length-ht;const bt=c(z,0,z.length);return lt[$++]=bt>>24&255,lt[$++]=bt>>16&255,lt[$++]=bt>>8&255,lt[$++]=bt&255,lt}function G(z,T,Y,it){const lt=z.width,$=z.height;let ht,bt,St;const wt=z.data;switch(T){case p.ImageKind.GRAYSCALE_1BPP:bt=0,ht=1,St=lt+7>>3;break;case p.ImageKind.RGB_24BPP:bt=2,ht=8,St=lt*3;break;case p.ImageKind.RGBA_32BPP:bt=6,ht=8,St=lt*4;break;default:throw new Error("invalid format")}const R=new Uint8Array((1+St)*$);let n=0,o=0;for(let U=0;U<$;++U)R[n++]=0,R.set(wt.subarray(o,o+St),n),o+=St,n+=St;if(T===p.ImageKind.GRAYSCALE_1BPP&&it){n=0;for(let U=0;U<$;U++){n++;for(let st=0;st<St;st++)R[n++]^=255}}const s=new Uint8Array([lt>>24&255,lt>>16&255,lt>>8&255,lt&255,$>>24&255,$>>16&255,$>>8&255,$&255,ht,bt,0,0,0]),h=k(R),u=A.length+l*3+s.length+h.length,S=new Uint8Array(u);let L=0;return S.set(A,L),L+=A.length,b("IHDR",s,S,L),L+=l+s.length,b("IDATA",h,S,L),L+=l+h.length,b("IEND",new Uint8Array(0),S,L),m(S,"image/png",Y)}return function(T,Y,it){const lt=T.kind===void 0?p.ImageKind.GRAYSCALE_1BPP:T.kind;return G(T,lt,Y,it)}}();class O{constructor(){this.fontSizeScale=1,this.fontWeight=V.fontWeight,this.fontSize=0,this.textMatrix=p.IDENTITY_MATRIX,this.fontMatrix=p.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=p.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=V.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(l,d){this.x=l,this.y=d}}function x(A){let l=[];const d=[];for(const M of A){if(M.fn==="save"){l.push({fnId:92,fn:"group",items:[]}),d.push(l),l=l.at(-1).items;continue}M.fn==="restore"?l=d.pop():l.push(M)}return l}function E(A){if(Number.isInteger(A))return A.toString();const l=A.toFixed(10);let d=l.length-1;if(l[d]!=="0")return l;do d--;while(l[d]==="0");return l.substring(0,l[d]==="."?d:d+1)}function v(A){if(A[4]===0&&A[5]===0){if(A[1]===0&&A[2]===0)return A[0]===1&&A[3]===1?"":`scale(${E(A[0])} ${E(A[3])})`;if(A[0]===A[3]&&A[1]===-A[2]){const l=Math.acos(A[0])*180/Math.PI;return`rotate(${E(l)})`}}else if(A[0]===1&&A[1]===0&&A[2]===0&&A[3]===1)return`translate(${E(A[4])} ${E(A[5])})`;return`matrix(${E(A[0])} ${E(A[1])} ${E(A[2])} ${E(A[3])} ${E(A[4])} ${E(A[5])})`}let f=0,_=0,P=0;class w{constructor(l,d,M=!1){(0,i.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new i.DOMSVGFactory,this.current=new O,this.transformMatrix=p.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=l,this.objs=d,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!M,this._operatorIdMapping=[];for(const b in p.OPS)this._operatorIdMapping[p.OPS[b]]=b}getObject(l,d=null){return typeof l=="string"?l.startsWith("g_")?this.commonObjs.get(l):this.objs.get(l):d}save(){this.transformStack.push(this.transformMatrix);const l=this.current;this.extraStack.push(l),this.current=l.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(l){this.save(),this.executeOpTree(l),this.restore()}loadDependencies(l){const d=l.fnArray,M=l.argsArray;for(let b=0,c=d.length;b<c;b++)if(d[b]===p.OPS.dependency)for(const k of M[b]){const g=k.startsWith("g_")?this.commonObjs:this.objs,G=new Promise(z=>{g.get(k,z)});this.current.dependencies.push(G)}return Promise.all(this.current.dependencies)}transform(l,d,M,b,c,k){const g=[l,d,M,b,c,k];this.transformMatrix=p.Util.transform(this.transformMatrix,g),this.tgrp=null}getSVG(l,d){this.viewport=d;const M=this._initialize(d);return this.loadDependencies(l).then(()=>(this.transformMatrix=p.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(l)),M))}convertOpList(l){const d=this._operatorIdMapping,M=l.argsArray,b=l.fnArray,c=[];for(let k=0,g=b.length;k<g;k++){const G=b[k];c.push({fnId:G,fn:d[G],args:M[k]})}return x(c)}executeOpTree(l){for(const d of l){const M=d.fn,b=d.fnId,c=d.args;switch(b|0){case p.OPS.beginText:this.beginText();break;case p.OPS.dependency:break;case p.OPS.setLeading:this.setLeading(c);break;case p.OPS.setLeadingMoveText:this.setLeadingMoveText(c[0],c[1]);break;case p.OPS.setFont:this.setFont(c);break;case p.OPS.showText:this.showText(c[0]);break;case p.OPS.showSpacedText:this.showText(c[0]);break;case p.OPS.endText:this.endText();break;case p.OPS.moveText:this.moveText(c[0],c[1]);break;case p.OPS.setCharSpacing:this.setCharSpacing(c[0]);break;case p.OPS.setWordSpacing:this.setWordSpacing(c[0]);break;case p.OPS.setHScale:this.setHScale(c[0]);break;case p.OPS.setTextMatrix:this.setTextMatrix(c[0],c[1],c[2],c[3],c[4],c[5]);break;case p.OPS.setTextRise:this.setTextRise(c[0]);break;case p.OPS.setTextRenderingMode:this.setTextRenderingMode(c[0]);break;case p.OPS.setLineWidth:this.setLineWidth(c[0]);break;case p.OPS.setLineJoin:this.setLineJoin(c[0]);break;case p.OPS.setLineCap:this.setLineCap(c[0]);break;case p.OPS.setMiterLimit:this.setMiterLimit(c[0]);break;case p.OPS.setFillRGBColor:this.setFillRGBColor(c[0],c[1],c[2]);break;case p.OPS.setStrokeRGBColor:this.setStrokeRGBColor(c[0],c[1],c[2]);break;case p.OPS.setStrokeColorN:this.setStrokeColorN(c);break;case p.OPS.setFillColorN:this.setFillColorN(c);break;case p.OPS.shadingFill:this.shadingFill(c[0]);break;case p.OPS.setDash:this.setDash(c[0],c[1]);break;case p.OPS.setRenderingIntent:this.setRenderingIntent(c[0]);break;case p.OPS.setFlatness:this.setFlatness(c[0]);break;case p.OPS.setGState:this.setGState(c[0]);break;case p.OPS.fill:this.fill();break;case p.OPS.eoFill:this.eoFill();break;case p.OPS.stroke:this.stroke();break;case p.OPS.fillStroke:this.fillStroke();break;case p.OPS.eoFillStroke:this.eoFillStroke();break;case p.OPS.clip:this.clip("nonzero");break;case p.OPS.eoClip:this.clip("evenodd");break;case p.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case p.OPS.paintImageXObject:this.paintImageXObject(c[0]);break;case p.OPS.paintInlineImageXObject:this.paintInlineImageXObject(c[0]);break;case p.OPS.paintImageMaskXObject:this.paintImageMaskXObject(c[0]);break;case p.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(c[0],c[1]);break;case p.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case p.OPS.closePath:this.closePath();break;case p.OPS.closeStroke:this.closeStroke();break;case p.OPS.closeFillStroke:this.closeFillStroke();break;case p.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case p.OPS.nextLine:this.nextLine();break;case p.OPS.transform:this.transform(c[0],c[1],c[2],c[3],c[4],c[5]);break;case p.OPS.constructPath:this.constructPath(c[0],c[1]);break;case p.OPS.endPath:this.endPath();break;case 92:this.group(d.items);break;default:(0,p.warn)(`Unimplemented operator ${M}`);break}}}setWordSpacing(l){this.current.wordSpacing=l}setCharSpacing(l){this.current.charSpacing=l}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(l,d,M,b,c,k){const g=this.current;g.textMatrix=g.lineMatrix=[l,d,M,b,c,k],g.textMatrixScale=Math.hypot(l,d),g.x=g.lineX=0,g.y=g.lineY=0,g.xcoords=[],g.ycoords=[],g.tspan=this.svgFactory.createElement("svg:tspan"),g.tspan.setAttributeNS(null,"font-family",g.fontFamily),g.tspan.setAttributeNS(null,"font-size",`${E(g.fontSize)}px`),g.tspan.setAttributeNS(null,"y",E(-g.y)),g.txtElement=this.svgFactory.createElement("svg:text"),g.txtElement.append(g.tspan)}beginText(){const l=this.current;l.x=l.lineX=0,l.y=l.lineY=0,l.textMatrix=p.IDENTITY_MATRIX,l.lineMatrix=p.IDENTITY_MATRIX,l.textMatrixScale=1,l.tspan=this.svgFactory.createElement("svg:tspan"),l.txtElement=this.svgFactory.createElement("svg:text"),l.txtgrp=this.svgFactory.createElement("svg:g"),l.xcoords=[],l.ycoords=[]}moveText(l,d){const M=this.current;M.x=M.lineX+=l,M.y=M.lineY+=d,M.xcoords=[],M.ycoords=[],M.tspan=this.svgFactory.createElement("svg:tspan"),M.tspan.setAttributeNS(null,"font-family",M.fontFamily),M.tspan.setAttributeNS(null,"font-size",`${E(M.fontSize)}px`),M.tspan.setAttributeNS(null,"y",E(-M.y))}showText(l){const d=this.current,M=d.font,b=d.fontSize;if(b===0)return;const c=d.fontSizeScale,k=d.charSpacing,g=d.wordSpacing,G=d.fontDirection,z=d.textHScale*G,T=M.vertical,Y=T?1:-1,it=M.defaultVMetrics,lt=b*d.fontMatrix[0];let $=0;for(const St of l){if(St===null){$+=G*g;continue}else if(typeof St=="number"){$+=Y*St*b/1e3;continue}const wt=(St.isSpace?g:0)+k,R=St.fontChar;let n,o,s=St.width;if(T){let u;const S=St.vmetric||it;u=St.vmetric?S[1]:s*.5,u=-u*lt;const L=S[2]*lt;s=S?-S[0]:s,n=u/c,o=($+L)/c}else n=$/c,o=0;(St.isInFont||M.missingFile)&&(d.xcoords.push(d.x+n),T&&d.ycoords.push(-d.y+o),d.tspan.textContent+=R);const h=T?s*lt-wt*G:s*lt+wt*G;$+=h}d.tspan.setAttributeNS(null,"x",d.xcoords.map(E).join(" ")),T?d.tspan.setAttributeNS(null,"y",d.ycoords.map(E).join(" ")):d.tspan.setAttributeNS(null,"y",E(-d.y)),T?d.y-=$:d.x+=$*z,d.tspan.setAttributeNS(null,"font-family",d.fontFamily),d.tspan.setAttributeNS(null,"font-size",`${E(d.fontSize)}px`),d.fontStyle!==V.fontStyle&&d.tspan.setAttributeNS(null,"font-style",d.fontStyle),d.fontWeight!==V.fontWeight&&d.tspan.setAttributeNS(null,"font-weight",d.fontWeight);const ht=d.textRenderingMode&p.TextRenderingMode.FILL_STROKE_MASK;if(ht===p.TextRenderingMode.FILL||ht===p.TextRenderingMode.FILL_STROKE?(d.fillColor!==V.fillColor&&d.tspan.setAttributeNS(null,"fill",d.fillColor),d.fillAlpha<1&&d.tspan.setAttributeNS(null,"fill-opacity",d.fillAlpha)):d.textRenderingMode===p.TextRenderingMode.ADD_TO_PATH?d.tspan.setAttributeNS(null,"fill","transparent"):d.tspan.setAttributeNS(null,"fill","none"),ht===p.TextRenderingMode.STROKE||ht===p.TextRenderingMode.FILL_STROKE){const St=1/(d.textMatrixScale||1);this._setStrokeAttributes(d.tspan,St)}let bt=d.textMatrix;d.textRise!==0&&(bt=bt.slice(),bt[5]+=d.textRise),d.txtElement.setAttributeNS(null,"transform",`${v(bt)} scale(${E(z)}, -1)`),d.txtElement.setAttributeNS(W,"xml:space","preserve"),d.txtElement.append(d.tspan),d.txtgrp.append(d.txtElement),this._ensureTransformGroup().append(d.txtElement)}setLeadingMoveText(l,d){this.setLeading(-d),this.moveText(l,d)}addFontStyle(l){if(!l.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const d=m(l.data,l.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${l.loadedName}"; src: url(${d}); }
`}setFont(l){const d=this.current,M=this.commonObjs.get(l[0]);let b=l[1];d.font=M,this.embedFonts&&!M.missingFile&&!this.embeddedFonts[M.loadedName]&&(this.addFontStyle(M),this.embeddedFonts[M.loadedName]=M),d.fontMatrix=M.fontMatrix||p.FONT_IDENTITY_MATRIX;let c="normal";M.black?c="900":M.bold&&(c="bold");const k=M.italic?"italic":"normal";b<0?(b=-b,d.fontDirection=-1):d.fontDirection=1,d.fontSize=b,d.fontFamily=M.loadedName,d.fontWeight=c,d.fontStyle=k,d.tspan=this.svgFactory.createElement("svg:tspan"),d.tspan.setAttributeNS(null,"y",E(-d.y)),d.xcoords=[],d.ycoords=[]}endText(){var d;const l=this.current;l.textRenderingMode&p.TextRenderingMode.ADD_TO_PATH_FLAG&&((d=l.txtElement)!=null&&d.hasChildNodes())&&(l.element=l.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(l){l>0&&(this.current.lineWidth=l)}setLineCap(l){this.current.lineCap=F[l]}setLineJoin(l){this.current.lineJoin=C[l]}setMiterLimit(l){this.current.miterLimit=l}setStrokeAlpha(l){this.current.strokeAlpha=l}setStrokeRGBColor(l,d,M){this.current.strokeColor=p.Util.makeHexColor(l,d,M)}setFillAlpha(l){this.current.fillAlpha=l}setFillRGBColor(l,d,M){this.current.fillColor=p.Util.makeHexColor(l,d,M),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(l){this.current.strokeColor=this._makeColorN_Pattern(l)}setFillColorN(l){this.current.fillColor=this._makeColorN_Pattern(l)}shadingFill(l){const{width:d,height:M}=this.viewport,b=p.Util.inverseTransform(this.transformMatrix),[c,k,g,G]=p.Util.getAxialAlignedBoundingBox([0,0,d,M],b),z=this.svgFactory.createElement("svg:rect");z.setAttributeNS(null,"x",c),z.setAttributeNS(null,"y",k),z.setAttributeNS(null,"width",g-c),z.setAttributeNS(null,"height",G-k),z.setAttributeNS(null,"fill",this._makeShadingPattern(l)),this.current.fillAlpha<1&&z.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(z)}_makeColorN_Pattern(l){return l[0]==="TilingPattern"?this._makeTilingPattern(l):this._makeShadingPattern(l)}_makeTilingPattern(l){const d=l[1],M=l[2],b=l[3]||p.IDENTITY_MATRIX,[c,k,g,G]=l[4],z=l[5],T=l[6],Y=l[7],it=`shading${P++}`,[lt,$,ht,bt]=p.Util.normalizeRect([...p.Util.applyTransform([c,k],b),...p.Util.applyTransform([g,G],b)]),[St,wt]=p.Util.singularValueDecompose2dScale(b),R=z*St,n=T*wt,o=this.svgFactory.createElement("svg:pattern");o.setAttributeNS(null,"id",it),o.setAttributeNS(null,"patternUnits","userSpaceOnUse"),o.setAttributeNS(null,"width",R),o.setAttributeNS(null,"height",n),o.setAttributeNS(null,"x",`${lt}`),o.setAttributeNS(null,"y",`${$}`);const s=this.svg,h=this.transformMatrix,u=this.current.fillColor,S=this.current.strokeColor,L=this.svgFactory.create(ht-lt,bt-$);if(this.svg=L,this.transformMatrix=b,Y===2){const U=p.Util.makeHexColor(...d);this.current.fillColor=U,this.current.strokeColor=U}return this.executeOpTree(this.convertOpList(M)),this.svg=s,this.transformMatrix=h,this.current.fillColor=u,this.current.strokeColor=S,o.append(L.childNodes[0]),this.defs.append(o),`url(#${it})`}_makeShadingPattern(l){switch(typeof l=="string"&&(l=this.objs.get(l)),l[0]){case"RadialAxial":const d=`shading${P++}`,M=l[3];let b;switch(l[1]){case"axial":const c=l[4],k=l[5];b=this.svgFactory.createElement("svg:linearGradient"),b.setAttributeNS(null,"id",d),b.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),b.setAttributeNS(null,"x1",c[0]),b.setAttributeNS(null,"y1",c[1]),b.setAttributeNS(null,"x2",k[0]),b.setAttributeNS(null,"y2",k[1]);break;case"radial":const g=l[4],G=l[5],z=l[6],T=l[7];b=this.svgFactory.createElement("svg:radialGradient"),b.setAttributeNS(null,"id",d),b.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),b.setAttributeNS(null,"cx",G[0]),b.setAttributeNS(null,"cy",G[1]),b.setAttributeNS(null,"r",T),b.setAttributeNS(null,"fx",g[0]),b.setAttributeNS(null,"fy",g[1]),b.setAttributeNS(null,"fr",z);break;default:throw new Error(`Unknown RadialAxial type: ${l[1]}`)}for(const c of M){const k=this.svgFactory.createElement("svg:stop");k.setAttributeNS(null,"offset",c[0]),k.setAttributeNS(null,"stop-color",c[1]),b.append(k)}return this.defs.append(b),`url(#${d})`;case"Mesh":return(0,p.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${l[0]}`)}}setDash(l,d){this.current.dashArray=l,this.current.dashPhase=d}constructPath(l,d){const M=this.current;let b=M.x,c=M.y,k=[],g=0;for(const G of l)switch(G|0){case p.OPS.rectangle:b=d[g++],c=d[g++];const z=d[g++],T=d[g++],Y=b+z,it=c+T;k.push("M",E(b),E(c),"L",E(Y),E(c),"L",E(Y),E(it),"L",E(b),E(it),"Z");break;case p.OPS.moveTo:b=d[g++],c=d[g++],k.push("M",E(b),E(c));break;case p.OPS.lineTo:b=d[g++],c=d[g++],k.push("L",E(b),E(c));break;case p.OPS.curveTo:b=d[g+4],c=d[g+5],k.push("C",E(d[g]),E(d[g+1]),E(d[g+2]),E(d[g+3]),E(b),E(c)),g+=6;break;case p.OPS.curveTo2:k.push("C",E(b),E(c),E(d[g]),E(d[g+1]),E(d[g+2]),E(d[g+3])),b=d[g+2],c=d[g+3],g+=4;break;case p.OPS.curveTo3:b=d[g+2],c=d[g+3],k.push("C",E(d[g]),E(d[g+1]),E(b),E(c),E(b),E(c)),g+=4;break;case p.OPS.closePath:k.push("Z");break}k=k.join(" "),M.path&&l.length>0&&l[0]!==p.OPS.rectangle&&l[0]!==p.OPS.moveTo?k=M.path.getAttributeNS(null,"d")+k:(M.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(M.path)),M.path.setAttributeNS(null,"d",k),M.path.setAttributeNS(null,"fill","none"),M.element=M.path,M.setCurrentPoint(b,c)}endPath(){const l=this.current;if(l.path=null,!this.pendingClip)return;if(!l.element){this.pendingClip=null;return}const d=`clippath${f++}`,M=this.svgFactory.createElement("svg:clipPath");M.setAttributeNS(null,"id",d),M.setAttributeNS(null,"transform",v(this.transformMatrix));const b=l.element.cloneNode(!0);if(this.pendingClip==="evenodd"?b.setAttributeNS(null,"clip-rule","evenodd"):b.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,M.append(b),this.defs.append(M),l.activeClipUrl){l.clipGroup=null;for(const c of this.extraStack)c.clipGroup=null;M.setAttributeNS(null,"clip-path",l.activeClipUrl)}l.activeClipUrl=`url(#${d})`,this.tgrp=null}clip(l){this.pendingClip=l}closePath(){const l=this.current;if(l.path){const d=`${l.path.getAttributeNS(null,"d")}Z`;l.path.setAttributeNS(null,"d",d)}}setLeading(l){this.current.leading=-l}setTextRise(l){this.current.textRise=l}setTextRenderingMode(l){this.current.textRenderingMode=l}setHScale(l){this.current.textHScale=l/100}setRenderingIntent(l){}setFlatness(l){}setGState(l){for(const[d,M]of l)switch(d){case"LW":this.setLineWidth(M);break;case"LC":this.setLineCap(M);break;case"LJ":this.setLineJoin(M);break;case"ML":this.setMiterLimit(M);break;case"D":this.setDash(M[0],M[1]);break;case"RI":this.setRenderingIntent(M);break;case"FL":this.setFlatness(M);break;case"Font":this.setFont(M);break;case"CA":this.setStrokeAlpha(M);break;case"ca":this.setFillAlpha(M);break;default:(0,p.warn)(`Unimplemented graphic state operator ${d}`);break}}fill(){const l=this.current;l.element&&(l.element.setAttributeNS(null,"fill",l.fillColor),l.element.setAttributeNS(null,"fill-opacity",l.fillAlpha),this.endPath())}stroke(){const l=this.current;l.element&&(this._setStrokeAttributes(l.element),l.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(l,d=1){const M=this.current;let b=M.dashArray;d!==1&&b.length>0&&(b=b.map(function(c){return d*c})),l.setAttributeNS(null,"stroke",M.strokeColor),l.setAttributeNS(null,"stroke-opacity",M.strokeAlpha),l.setAttributeNS(null,"stroke-miterlimit",E(M.miterLimit)),l.setAttributeNS(null,"stroke-linecap",M.lineCap),l.setAttributeNS(null,"stroke-linejoin",M.lineJoin),l.setAttributeNS(null,"stroke-width",E(d*M.lineWidth)+"px"),l.setAttributeNS(null,"stroke-dasharray",b.map(E).join(" ")),l.setAttributeNS(null,"stroke-dashoffset",E(d*M.dashPhase)+"px")}eoFill(){var l;(l=this.current.element)==null||l.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var l;(l=this.current.element)==null||l.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y","0"),l.setAttributeNS(null,"width","1px"),l.setAttributeNS(null,"height","1px"),l.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(l)}paintImageXObject(l){const d=this.getObject(l);if(!d){(0,p.warn)(`Dependent image with object ID ${l} is not ready yet`);return}this.paintInlineImageXObject(d)}paintInlineImageXObject(l,d){const M=l.width,b=l.height,c=I(l,this.forceDataSchema,!!d),k=this.svgFactory.createElement("svg:rect");k.setAttributeNS(null,"x","0"),k.setAttributeNS(null,"y","0"),k.setAttributeNS(null,"width",E(M)),k.setAttributeNS(null,"height",E(b)),this.current.element=k,this.clip("nonzero");const g=this.svgFactory.createElement("svg:image");g.setAttributeNS(dt,"xlink:href",c),g.setAttributeNS(null,"x","0"),g.setAttributeNS(null,"y",E(-b)),g.setAttributeNS(null,"width",E(M)+"px"),g.setAttributeNS(null,"height",E(b)+"px"),g.setAttributeNS(null,"transform",`scale(${E(1/M)} ${E(-1/b)})`),d?d.append(g):this._ensureTransformGroup().append(g)}paintImageMaskXObject(l){const d=this.getObject(l.data,l);if(d.bitmap){(0,p.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const M=this.current,b=d.width,c=d.height,k=M.fillColor;M.maskId=`mask${_++}`;const g=this.svgFactory.createElement("svg:mask");g.setAttributeNS(null,"id",M.maskId);const G=this.svgFactory.createElement("svg:rect");G.setAttributeNS(null,"x","0"),G.setAttributeNS(null,"y","0"),G.setAttributeNS(null,"width",E(b)),G.setAttributeNS(null,"height",E(c)),G.setAttributeNS(null,"fill",k),G.setAttributeNS(null,"mask",`url(#${M.maskId})`),this.defs.append(g),this._ensureTransformGroup().append(G),this.paintInlineImageXObject(d,g)}paintFormXObjectBegin(l,d){if(Array.isArray(l)&&l.length===6&&this.transform(l[0],l[1],l[2],l[3],l[4],l[5]),d){const M=d[2]-d[0],b=d[3]-d[1],c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x",d[0]),c.setAttributeNS(null,"y",d[1]),c.setAttributeNS(null,"width",E(M)),c.setAttributeNS(null,"height",E(b)),this.current.element=c,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(l){const d=this.svgFactory.create(l.width,l.height),M=this.svgFactory.createElement("svg:defs");d.append(M),this.defs=M;const b=this.svgFactory.createElement("svg:g");return b.setAttributeNS(null,"transform",v(l.transform)),d.append(b),this.svg=b,d}_ensureClipGroup(){if(!this.current.clipGroup){const l=this.svgFactory.createElement("svg:g");l.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(l),this.current.clipGroup=l}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",v(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}a.SVGGraphics=w},(D,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.XfaText=void 0;class j{static textContent(p){const V=[],W={items:V,styles:Object.create(null)};function dt(F){var I;if(!F)return;let C=null;const m=F.name;if(m==="#text")C=F.value;else if(j.shouldBuildText(m))(I=F==null?void 0:F.attributes)!=null&&I.textContent?C=F.attributes.textContent:F.value&&(C=F.value);else return;if(C!==null&&V.push({str:C}),!!F.children)for(const O of F.children)dt(O)}return dt(p),W}static shouldBuildText(p){return!(p==="textarea"||p==="input"||p==="option"||p==="select")}}a.XfaText=j},(D,a,j)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TextLayerRenderTask=void 0,a.renderTextLayer=v,a.updateTextLayer=f;var i=j(1),p=j(6);const V=1e5,W=30,dt=.8,F=new Map;function C(_,P){let w;if(P&&i.FeatureTest.isOffscreenCanvasSupported)w=new OffscreenCanvas(_,_).getContext("2d",{alpha:!1});else{const A=document.createElement("canvas");A.width=A.height=_,w=A.getContext("2d",{alpha:!1})}return w}function m(_,P){const w=F.get(_);if(w)return w;const A=C(W,P);A.font=`${W}px ${_}`;const l=A.measureText("");let d=l.fontBoundingBoxAscent,M=Math.abs(l.fontBoundingBoxDescent);if(d){const c=d/(d+M);return F.set(_,c),A.canvas.width=A.canvas.height=0,c}A.strokeStyle="red",A.clearRect(0,0,W,W),A.strokeText("g",0,0);let b=A.getImageData(0,0,W,W).data;M=0;for(let c=b.length-1-3;c>=0;c-=4)if(b[c]>0){M=Math.ceil(c/4/W);break}A.clearRect(0,0,W,W),A.strokeText("A",0,W),b=A.getImageData(0,0,W,W).data,d=0;for(let c=0,k=b.length;c<k;c+=4)if(b[c]>0){d=W-Math.floor(c/4/W);break}if(A.canvas.width=A.canvas.height=0,d){const c=d/(d+M);return F.set(_,c),c}return F.set(_,dt),dt}function I(_,P,w){const A=document.createElement("span"),l={angle:0,canvasWidth:0,hasText:P.str!=="",hasEOL:P.hasEOL,fontSize:0};_._textDivs.push(A);const d=i.Util.transform(_._transform,P.transform);let M=Math.atan2(d[1],d[0]);const b=w[P.fontName];b.vertical&&(M+=Math.PI/2);const c=Math.hypot(d[2],d[3]),k=c*m(b.fontFamily,_._isOffscreenCanvasSupported);let g,G;M===0?(g=d[4],G=d[5]-k):(g=d[4]+k*Math.sin(M),G=d[5]-k*Math.cos(M));const z="calc(var(--scale-factor)*",T=A.style;_._container===_._rootContainer?(T.left=`${(100*g/_._pageWidth).toFixed(2)}%`,T.top=`${(100*G/_._pageHeight).toFixed(2)}%`):(T.left=`${z}${g.toFixed(2)}px)`,T.top=`${z}${G.toFixed(2)}px)`),T.fontSize=`${z}${c.toFixed(2)}px)`,T.fontFamily=b.fontFamily,l.fontSize=c,A.setAttribute("role","presentation"),A.textContent=P.str,A.dir=P.dir,_._fontInspectorEnabled&&(A.dataset.fontName=P.fontName),M!==0&&(l.angle=M*(180/Math.PI));let Y=!1;if(P.str.length>1)Y=!0;else if(P.str!==" "&&P.transform[0]!==P.transform[3]){const it=Math.abs(P.transform[0]),lt=Math.abs(P.transform[3]);it!==lt&&Math.max(it,lt)/Math.min(it,lt)>1.5&&(Y=!0)}Y&&(l.canvasWidth=b.vertical?P.height:P.width),_._textDivProperties.set(A,l),_._isReadableStream&&_._layoutText(A)}function O(_){const{div:P,scale:w,properties:A,ctx:l,prevFontSize:d,prevFontFamily:M}=_,{style:b}=P;let c="";if(A.canvasWidth!==0&&A.hasText){const{fontFamily:k}=b,{canvasWidth:g,fontSize:G}=A;(d!==G||M!==k)&&(l.font=`${G*w}px ${k}`,_.prevFontSize=G,_.prevFontFamily=k);const{width:z}=l.measureText(P.textContent);z>0&&(c=`scaleX(${g*w/z})`)}A.angle!==0&&(c=`rotate(${A.angle}deg) ${c}`),c.length>0&&(b.transform=c)}function x(_){if(_._canceled)return;const P=_._textDivs,w=_._capability;if(P.length>V){w.resolve();return}if(!_._isReadableStream)for(const l of P)_._layoutText(l);w.resolve()}class E{constructor({textContentSource:P,container:w,viewport:A,textDivs:l,textDivProperties:d,textContentItemsStr:M,isOffscreenCanvasSupported:b}){var z;this._textContentSource=P,this._isReadableStream=P instanceof ReadableStream,this._container=this._rootContainer=w,this._textDivs=l||[],this._textContentItemsStr=M||[],this._isOffscreenCanvasSupported=b,this._fontInspectorEnabled=!!((z=globalThis.FontInspector)!=null&&z.enabled),this._reader=null,this._textDivProperties=d||new WeakMap,this._canceled=!1,this._capability=new i.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:A.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:C(0,b)};const{pageWidth:c,pageHeight:k,pageX:g,pageY:G}=A.rawDims;this._transform=[1,0,0,-1,-g,G+k],this._pageWidth=c,this._pageHeight=k,(0,p.setLayerDimensions)(w,A),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new i.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new i.AbortException("TextLayer task cancelled."))}_processItems(P,w){for(const A of P){if(A.str===void 0){if(A.type==="beginMarkedContentProps"||A.type==="beginMarkedContent"){const l=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),A.id!==null&&this._container.setAttribute("id",`${A.id}`),l.append(this._container)}else A.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(A.str),I(this,A,w)}}_layoutText(P){const w=this._layoutTextParams.properties=this._textDivProperties.get(P);if(this._layoutTextParams.div=P,O(this._layoutTextParams),w.hasText&&this._container.append(P),w.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),this._container.append(A)}}_render(){const P=new i.PromiseCapability;let w=Object.create(null);if(this._isReadableStream){const A=()=>{this._reader.read().then(({value:l,done:d})=>{if(d){P.resolve();return}Object.assign(w,l.styles),this._processItems(l.items,w),A()},P.reject)};this._reader=this._textContentSource.getReader(),A()}else if(this._textContentSource){const{items:A,styles:l}=this._textContentSource;this._processItems(A,l),P.resolve()}else throw new Error('No "textContentSource" parameter specified.');P.promise.then(()=>{w=null,x(this)},this._capability.reject)}}a.TextLayerRenderTask=E;function v(_){!_.textContentSource&&(_.textContent||_.textContentStream)&&((0,p.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),_.textContentSource=_.textContent||_.textContentStream);const{container:P,viewport:w}=_,A=getComputedStyle(P),l=A.getPropertyValue("visibility"),d=parseFloat(A.getPropertyValue("--scale-factor"));l==="visible"&&(!d||Math.abs(d-w.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const M=new E(_);return M._render(),M}function f({container:_,viewport:P,textDivs:w,textDivProperties:A,isOffscreenCanvasSupported:l,mustRotate:d=!0,mustRescale:M=!0}){if(d&&(0,p.setLayerDimensions)(_,{rotation:P.rotation}),M){const b=C(0,l),k={prevFontSize:null,prevFontFamily:null,div:null,scale:P.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:b};for(const g of w)k.properties=A.get(g),k.div=g,O(k)}}},(D,a,j)=>{var m,I,O,x,E,v,f,_,P,w,A,nn,d,ke,b,sn,k,rn;Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationEditorLayer=void 0;var i=j(1),p=j(4),V=j(28),W=j(33),dt=j(6),F=j(34);const G=class G{constructor({uiManager:T,pageIndex:Y,div:it,accessibilityManager:lt,annotationLayer:$,viewport:ht,l10n:bt}){H(this,A);H(this,d);H(this,b);H(this,k);H(this,m,void 0);H(this,I,!1);H(this,O,null);H(this,x,this.pointerup.bind(this));H(this,E,this.pointerdown.bind(this));H(this,v,new Map);H(this,f,!1);H(this,_,!1);H(this,P,!1);H(this,w,void 0);const St=[V.FreeTextEditor,W.InkEditor,F.StampEditor];if(!G._initialized){G._initialized=!0;for(const wt of St)wt.initialize(bt)}T.registerEditorTypes(St),rt(this,w,T),this.pageIndex=Y,this.div=it,rt(this,m,lt),rt(this,O,$),this.viewport=ht,t(this,w).addLayer(this)}get isEmpty(){return t(this,v).size===0}updateToolbar(T){t(this,w).updateToolbar(T)}updateMode(T=t(this,w).getMode()){q(this,k,rn).call(this),T===i.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),T!==i.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",T===i.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",T===i.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",T===i.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(T){if(!T&&t(this,w).getMode()!==i.AnnotationEditorType.INK)return;if(!T){for(const it of t(this,v).values())if(it.isEmpty()){it.setInBackground();return}}q(this,d,ke).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(T){t(this,w).setEditingState(T)}addCommands(T){t(this,w).addCommands(T)}enable(){this.div.style.pointerEvents="auto";const T=new Set;for(const it of t(this,v).values())it.enableEditing(),it.annotationElementId&&T.add(it.annotationElementId);if(!t(this,O))return;const Y=t(this,O).getEditableAnnotations();for(const it of Y){if(it.hide(),t(this,w).isDeletedAnnotationElement(it.data.id)||T.has(it.data.id))continue;const lt=this.deserialize(it);lt&&(this.addOrRebuild(lt),lt.enableEditing())}}disable(){var Y;rt(this,P,!0),this.div.style.pointerEvents="none";const T=new Set;for(const it of t(this,v).values()){if(it.disableEditing(),!it.annotationElementId||it.serialize()!==null){T.add(it.annotationElementId);continue}(Y=this.getEditableAnnotation(it.annotationElementId))==null||Y.show(),it.remove()}if(t(this,O)){const it=t(this,O).getEditableAnnotations();for(const lt of it){const{id:$}=lt.data;T.has($)||t(this,w).isDeletedAnnotationElement($)||lt.show()}}q(this,k,rn).call(this),this.isEmpty&&(this.div.hidden=!0),rt(this,P,!1)}getEditableAnnotation(T){var Y;return((Y=t(this,O))==null?void 0:Y.getEditableAnnotation(T))||null}setActiveEditor(T){t(this,w).getActive()!==T&&t(this,w).setActiveEditor(T)}enableClick(){this.div.addEventListener("pointerdown",t(this,E)),this.div.addEventListener("pointerup",t(this,x))}disableClick(){this.div.removeEventListener("pointerdown",t(this,E)),this.div.removeEventListener("pointerup",t(this,x))}attach(T){t(this,v).set(T.id,T);const{annotationElementId:Y}=T;Y&&t(this,w).isDeletedAnnotationElement(Y)&&t(this,w).removeDeletedAnnotationElement(T)}detach(T){var Y;t(this,v).delete(T.id),(Y=t(this,m))==null||Y.removePointerInTextLayer(T.contentDiv),!t(this,P)&&T.annotationElementId&&t(this,w).addDeletedAnnotationElement(T)}remove(T){this.detach(T),t(this,w).removeEditor(T),T.div.contains(document.activeElement)&&setTimeout(()=>{t(this,w).focusMainContainer()},0),T.div.remove(),T.isAttachedToDOM=!1,t(this,_)||this.addInkEditorIfNeeded(!1)}changeParent(T){var Y;T.parent!==this&&(T.annotationElementId&&(t(this,w).addDeletedAnnotationElement(T.annotationElementId),p.AnnotationEditor.deleteAnnotationElement(T),T.annotationElementId=null),this.attach(T),(Y=T.parent)==null||Y.detach(T),T.setParent(this),T.div&&T.isAttachedToDOM&&(T.div.remove(),this.div.append(T.div)))}add(T){if(this.changeParent(T),t(this,w).addEditor(T),this.attach(T),!T.isAttachedToDOM){const Y=T.render();this.div.append(Y),T.isAttachedToDOM=!0}T.fixAndSetPosition(),T.onceAdded(),t(this,w).addToAnnotationStorage(T)}moveEditorInDOM(T){var it;if(!T.isAttachedToDOM)return;const{activeElement:Y}=document;T.div.contains(Y)&&(T._focusEventsAllowed=!1,setTimeout(()=>{T.div.contains(document.activeElement)?T._focusEventsAllowed=!0:(T.div.addEventListener("focusin",()=>{T._focusEventsAllowed=!0},{once:!0}),Y.focus())},0)),T._structTreeParentId=(it=t(this,m))==null?void 0:it.moveElementInDOM(this.div,T.div,T.contentDiv,!0)}addOrRebuild(T){T.needsToBeRebuilt()?T.rebuild():this.add(T)}addUndoableEditor(T){const Y=()=>T._uiManager.rebuild(T),it=()=>{T.remove()};this.addCommands({cmd:Y,undo:it,mustExec:!1})}getNextId(){return t(this,w).getId()}pasteEditor(T,Y){t(this,w).updateToolbar(T),t(this,w).updateMode(T);const{offsetX:it,offsetY:lt}=q(this,b,sn).call(this),$=this.getNextId(),ht=q(this,A,nn).call(this,{parent:this,id:$,x:it,y:lt,uiManager:t(this,w),isCentered:!0,...Y});ht&&this.add(ht)}deserialize(T){switch(T.annotationType??T.annotationEditorType){case i.AnnotationEditorType.FREETEXT:return V.FreeTextEditor.deserialize(T,this,t(this,w));case i.AnnotationEditorType.INK:return W.InkEditor.deserialize(T,this,t(this,w));case i.AnnotationEditorType.STAMP:return F.StampEditor.deserialize(T,this,t(this,w))}return null}addNewEditor(){q(this,d,ke).call(this,q(this,b,sn).call(this),!0)}setSelected(T){t(this,w).setSelected(T)}toggleSelected(T){t(this,w).toggleSelected(T)}isSelected(T){return t(this,w).isSelected(T)}unselect(T){t(this,w).unselect(T)}pointerup(T){const{isMac:Y}=i.FeatureTest.platform;if(!(T.button!==0||T.ctrlKey&&Y)&&T.target===this.div&&t(this,f)){if(rt(this,f,!1),!t(this,I)){rt(this,I,!0);return}if(t(this,w).getMode()===i.AnnotationEditorType.STAMP){t(this,w).unselectAll();return}q(this,d,ke).call(this,T,!1)}}pointerdown(T){if(t(this,f)){rt(this,f,!1);return}const{isMac:Y}=i.FeatureTest.platform;if(T.button!==0||T.ctrlKey&&Y||T.target!==this.div)return;rt(this,f,!0);const it=t(this,w).getActive();rt(this,I,!it||it.isEmpty())}findNewParent(T,Y,it){const lt=t(this,w).findParent(Y,it);return lt===null||lt===this?!1:(lt.changeParent(T),!0)}destroy(){var T,Y;((T=t(this,w).getActive())==null?void 0:T.parent)===this&&(t(this,w).commitOrRemove(),t(this,w).setActiveEditor(null));for(const it of t(this,v).values())(Y=t(this,m))==null||Y.removePointerInTextLayer(it.contentDiv),it.setParent(null),it.isAttachedToDOM=!1,it.div.remove();this.div=null,t(this,v).clear(),t(this,w).removeLayer(this)}render({viewport:T}){this.viewport=T,(0,dt.setLayerDimensions)(this.div,T);for(const Y of t(this,w).getEditors(this.pageIndex))this.add(Y);this.updateMode()}update({viewport:T}){t(this,w).commitOrRemove(),this.viewport=T,(0,dt.setLayerDimensions)(this.div,{rotation:T.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:T,pageHeight:Y}=this.viewport.rawDims;return[T,Y]}};m=new WeakMap,I=new WeakMap,O=new WeakMap,x=new WeakMap,E=new WeakMap,v=new WeakMap,f=new WeakMap,_=new WeakMap,P=new WeakMap,w=new WeakMap,A=new WeakSet,nn=function(T){switch(t(this,w).getMode()){case i.AnnotationEditorType.FREETEXT:return new V.FreeTextEditor(T);case i.AnnotationEditorType.INK:return new W.InkEditor(T);case i.AnnotationEditorType.STAMP:return new F.StampEditor(T)}return null},d=new WeakSet,ke=function(T,Y){const it=this.getNextId(),lt=q(this,A,nn).call(this,{parent:this,id:it,x:T.offsetX,y:T.offsetY,uiManager:t(this,w),isCentered:Y});return lt&&this.add(lt),lt},b=new WeakSet,sn=function(){const{x:T,y:Y,width:it,height:lt}=this.div.getBoundingClientRect(),$=Math.max(0,T),ht=Math.max(0,Y),bt=Math.min(window.innerWidth,T+it),St=Math.min(window.innerHeight,Y+lt),wt=($+bt)/2-T,R=(ht+St)/2-Y,[n,o]=this.viewport.rotation%180===0?[wt,R]:[R,wt];return{offsetX:n,offsetY:o}},k=new WeakSet,rn=function(){rt(this,_,!0);for(const T of t(this,v).values())T.isEmpty()&&T.remove();rt(this,_,!1)},ne(G,"_initialized",!1);let C=G;a.AnnotationEditorLayer=C},(D,a,j)=>{var F,C,m,I,O,x,E,v,f,_,Mn,w,Dn,l,Ln,M,ve,c,an,g,In,z,on;Object.defineProperty(a,"__esModule",{value:!0}),a.FreeTextEditor=void 0;var i=j(1),p=j(5),V=j(4),W=j(29);const Y=class Y extends V.AnnotationEditor{constructor($){super({...$,name:"freeTextEditor"});H(this,_);H(this,w);H(this,l);H(this,M);H(this,c);H(this,g);H(this,z);H(this,F,this.editorDivBlur.bind(this));H(this,C,this.editorDivFocus.bind(this));H(this,m,this.editorDivInput.bind(this));H(this,I,this.editorDivKeydown.bind(this));H(this,O,void 0);H(this,x,"");H(this,E,`${this.id}-editor`);H(this,v,void 0);H(this,f,null);rt(this,O,$.color||Y._defaultColor||V.AnnotationEditor._defaultLineColor),rt(this,v,$.fontSize||Y._defaultFontSize)}static get _keyboardManager(){const $=Y.prototype,ht=wt=>wt.isEmpty(),bt=p.AnnotationEditorUIManager.TRANSLATE_SMALL,St=p.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,i.shadow)(this,"_keyboardManager",new p.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],$.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],$.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],$._translateEmpty,{args:[-bt,0],checker:ht}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],$._translateEmpty,{args:[-St,0],checker:ht}],[["ArrowRight","mac+ArrowRight"],$._translateEmpty,{args:[bt,0],checker:ht}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],$._translateEmpty,{args:[St,0],checker:ht}],[["ArrowUp","mac+ArrowUp"],$._translateEmpty,{args:[0,-bt],checker:ht}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],$._translateEmpty,{args:[0,-St],checker:ht}],[["ArrowDown","mac+ArrowDown"],$._translateEmpty,{args:[0,bt],checker:ht}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],$._translateEmpty,{args:[0,St],checker:ht}]]))}static initialize($){V.AnnotationEditor.initialize($,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const ht=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(ht.getPropertyValue("--freetext-padding"))}static updateDefaultParams($,ht){switch($){case i.AnnotationEditorParamsType.FREETEXT_SIZE:Y._defaultFontSize=ht;break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:Y._defaultColor=ht;break}}updateParams($,ht){switch($){case i.AnnotationEditorParamsType.FREETEXT_SIZE:q(this,_,Mn).call(this,ht);break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:q(this,w,Dn).call(this,ht);break}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,Y._defaultFontSize],[i.AnnotationEditorParamsType.FREETEXT_COLOR,Y._defaultColor||V.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,v)],[i.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,O)]]}_translateEmpty($,ht){this._uiManager.translateSelectedEditors($,ht,!0)}getInitialTranslation(){const $=this.parentScale;return[-Y._internalPadding*$,-(Y._internalPadding+t(this,v))*$]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(i.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,I)),this.editorDiv.addEventListener("focus",t(this,C)),this.editorDiv.addEventListener("blur",t(this,F)),this.editorDiv.addEventListener("input",t(this,m)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,E)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,I)),this.editorDiv.removeEventListener("focus",t(this,C)),this.editorDiv.removeEventListener("blur",t(this,F)),this.editorDiv.removeEventListener("input",t(this,m)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin($){this._focusEventsAllowed&&(super.focusin($),$.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var $;if(this.width){q(this,z,on).call(this);return}this.enableEditMode(),this.editorDiv.focus(),($=this._initialOptions)!=null&&$.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const $=t(this,x),ht=rt(this,x,q(this,l,Ln).call(this).trimEnd());if($===ht)return;const bt=St=>{if(rt(this,x,St),!St){this.remove();return}q(this,c,an).call(this),this._uiManager.rebuild(this),q(this,M,ve).call(this)};this.addCommands({cmd:()=>{bt(ht)},undo:()=>{bt($)},mustExec:!1}),q(this,M,ve).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick($){this.enterInEditMode()}keydown($){$.target===this.div&&$.key==="Enter"&&(this.enterInEditMode(),$.preventDefault())}editorDivKeydown($){Y._keyboardManager.exec(this,$)}editorDivFocus($){this.isEditing=!0}editorDivBlur($){this.isEditing=!1}editorDivInput($){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let $,ht;this.width&&($=this.x,ht=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,E)),this.enableEditing(),V.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(St=>{var wt;return(wt=this.editorDiv)==null?void 0:wt.setAttribute("aria-label",St)}),V.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(St=>{var wt;return(wt=this.editorDiv)==null?void 0:wt.setAttribute("default-content",St)}),this.editorDiv.contentEditable=!0;const{style:bt}=this.editorDiv;if(bt.fontSize=`calc(${t(this,v)}px * var(--scale-factor))`,bt.color=t(this,O),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,p.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[St,wt]=this.parentDimensions;if(this.annotationElementId){const{position:R}=t(this,f);let[n,o]=this.getInitialTranslation();[n,o]=this.pageTranslationToScreen(n,o);const[s,h]=this.pageDimensions,[u,S]=this.pageTranslation;let L,U;switch(this.rotation){case 0:L=$+(R[0]-u)/s,U=ht+this.height-(R[1]-S)/h;break;case 90:L=$+(R[0]-u)/s,U=ht-(R[1]-S)/h,[n,o]=[o,-n];break;case 180:L=$-this.width+(R[0]-u)/s,U=ht-(R[1]-S)/h,[n,o]=[-n,-o];break;case 270:L=$+(R[0]-u-this.height*h)/s,U=ht+(R[1]-S-this.width*s)/h,[n,o]=[-o,n];break}this.setAt(L*St,U*wt,n,o)}else this.setAt($*St,ht*wt,this.width*St,this.height*wt);q(this,c,an).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize($,ht,bt){let St=null;if($ instanceof W.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:R,fontColor:n},rect:o,rotation:s,id:h},textContent:u,textPosition:S,parent:{page:{pageNumber:L}}}=$;if(!u||u.length===0)return null;St=$={annotationType:i.AnnotationEditorType.FREETEXT,color:Array.from(n),fontSize:R,value:u.join(`
`),position:S,pageIndex:L-1,rect:o,rotation:s,id:h,deleted:!1}}const wt=super.deserialize($,ht,bt);return rt(wt,v,$.fontSize),rt(wt,O,i.Util.makeHexColor(...$.color)),rt(wt,x,$.value),wt.annotationElementId=$.id||null,rt(wt,f,St),wt}serialize($=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const ht=Y._internalPadding*this.parentScale,bt=this.getRect(ht,ht),St=V.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,O)),wt={annotationType:i.AnnotationEditorType.FREETEXT,color:St,fontSize:t(this,v),value:t(this,x),pageIndex:this.pageIndex,rect:bt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return $?wt:this.annotationElementId&&!q(this,g,In).call(this,wt)?null:(wt.id=this.annotationElementId,wt)}};F=new WeakMap,C=new WeakMap,m=new WeakMap,I=new WeakMap,O=new WeakMap,x=new WeakMap,E=new WeakMap,v=new WeakMap,f=new WeakMap,_=new WeakSet,Mn=function($){const ht=St=>{this.editorDiv.style.fontSize=`calc(${St}px * var(--scale-factor))`,this.translate(0,-(St-t(this,v))*this.parentScale),rt(this,v,St),q(this,M,ve).call(this)},bt=t(this,v);this.addCommands({cmd:()=>{ht($)},undo:()=>{ht(bt)},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},w=new WeakSet,Dn=function($){const ht=t(this,O);this.addCommands({cmd:()=>{rt(this,O,this.editorDiv.style.color=$)},undo:()=>{rt(this,O,this.editorDiv.style.color=ht)},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},l=new WeakSet,Ln=function(){const $=this.editorDiv.getElementsByTagName("div");if($.length===0)return this.editorDiv.innerText;const ht=[];for(const bt of $)ht.push(bt.innerText.replace(/\r\n?|\n/,""));return ht.join(`
`)},M=new WeakSet,ve=function(){const[$,ht]=this.parentDimensions;let bt;if(this.isAttachedToDOM)bt=this.div.getBoundingClientRect();else{const{currentLayer:St,div:wt}=this,R=wt.style.display;wt.style.display="hidden",St.div.append(this.div),bt=wt.getBoundingClientRect(),wt.remove(),wt.style.display=R}this.rotation%180===this.parentRotation%180?(this.width=bt.width/$,this.height=bt.height/ht):(this.width=bt.height/$,this.height=bt.width/ht),this.fixAndSetPosition()},c=new WeakSet,an=function(){if(this.editorDiv.replaceChildren(),!!t(this,x))for(const $ of t(this,x).split(`
`)){const ht=document.createElement("div");ht.append($?document.createTextNode($):document.createElement("br")),this.editorDiv.append(ht)}},g=new WeakSet,In=function($){const{value:ht,fontSize:bt,color:St,rect:wt,pageIndex:R}=t(this,f);return $.value!==ht||$.fontSize!==bt||$.rect.some((n,o)=>Math.abs(n-wt[o])>=1)||$.color.some((n,o)=>n!==St[o])||$.pageIndex!==R},z=new WeakSet,on=function($=!1){if(!this.annotationElementId)return;if(q(this,M,ve).call(this),!$&&(this.width===0||this.height===0)){setTimeout(()=>q(this,z,on).call(this,!0),0);return}const ht=Y._internalPadding*this.parentScale;t(this,f).rect=this.getRect(ht,ht)},ne(Y,"_freeTextDefaultContent",""),ne(Y,"_internalPadding",0),ne(Y,"_defaultColor",null),ne(Y,"_defaultFontSize",10),ne(Y,"_type","freetext");let dt=Y;a.FreeTextEditor=dt},(D,a,j)=>{var o,h,he,S,On,U,st,tt,at,ut,gt,ct,Rt,It,Et,Lt,mt,et,nt,pt,Pt,Ct,Ut,Nn,Ht,Fe,$t,ln,Xt,cn,Z,K,_t,vt,ee,te,Q,hn,Nt,xt,Bt,jt,Bn,At,dn;Object.defineProperty(a,"__esModule",{value:!0}),a.StampAnnotationElement=a.InkAnnotationElement=a.FreeTextAnnotationElement=a.AnnotationLayer=void 0;var i=j(1),p=j(6),V=j(3),W=j(30),dt=j(31),F=j(32);const C=1e3,m=9,I=new WeakSet;function O(Ot){return{width:Ot[2]-Ot[0],height:Ot[3]-Ot[1]}}class x{static create(N){switch(N.data.annotationType){case i.AnnotationType.LINK:return new v(N);case i.AnnotationType.TEXT:return new f(N);case i.AnnotationType.WIDGET:switch(N.data.fieldType){case"Tx":return new P(N);case"Btn":return N.data.radioButton?new l(N):N.data.checkBox?new A(N):new d(N);case"Ch":return new M(N);case"Sig":return new w(N)}return new _(N);case i.AnnotationType.POPUP:return new b(N);case i.AnnotationType.FREETEXT:return new k(N);case i.AnnotationType.LINE:return new g(N);case i.AnnotationType.SQUARE:return new G(N);case i.AnnotationType.CIRCLE:return new z(N);case i.AnnotationType.POLYLINE:return new T(N);case i.AnnotationType.CARET:return new it(N);case i.AnnotationType.INK:return new lt(N);case i.AnnotationType.POLYGON:return new Y(N);case i.AnnotationType.HIGHLIGHT:return new $(N);case i.AnnotationType.UNDERLINE:return new ht(N);case i.AnnotationType.SQUIGGLY:return new bt(N);case i.AnnotationType.STRIKEOUT:return new St(N);case i.AnnotationType.STAMP:return new wt(N);case i.AnnotationType.FILEATTACHMENT:return new R(N);default:return new E(N)}}}const s=class s{constructor(N,{isRenderable:e=!1,ignoreBorder:y=!1,createQuadrilaterals:B=!1}={}){H(this,o,!1);this.isRenderable=e,this.data=N.data,this.layer=N.layer,this.linkService=N.linkService,this.downloadManager=N.downloadManager,this.imageResourcesPath=N.imageResourcesPath,this.renderForms=N.renderForms,this.svgFactory=N.svgFactory,this.annotationStorage=N.annotationStorage,this.enableScripting=N.enableScripting,this.hasJSActions=N.hasJSActions,this._fieldObjects=N.fieldObjects,this.parent=N.parent,e&&(this.container=this._createContainer(y)),B&&this._createQuadrilaterals()}static _hasPopupData({titleObj:N,contentsObj:e,richText:y}){return!!(N!=null&&N.str||e!=null&&e.str||y!=null&&y.str)}get hasPopupData(){return s._hasPopupData(this.data)}_createContainer(N){const{data:e,parent:{page:y,viewport:B}}=this,X=document.createElement("section");X.setAttribute("data-annotation-id",e.id),this instanceof _||(X.tabIndex=C),X.style.zIndex=this.parent.zIndex++,this.data.popupRef&&X.setAttribute("aria-haspopup","dialog"),e.noRotate&&X.classList.add("norotate");const{pageWidth:J,pageHeight:ot,pageX:yt,pageY:Ft}=B.rawDims;if(!e.rect||this instanceof b){const{rotation:Gt}=e;return!e.hasOwnCanvas&&Gt!==0&&this.setRotation(Gt,X),X}const{width:kt,height:qt}=O(e.rect),Mt=i.Util.normalizeRect([e.rect[0],y.view[3]-e.rect[1]+y.view[1],e.rect[2],y.view[3]-e.rect[3]+y.view[1]]);if(!N&&e.borderStyle.width>0){X.style.borderWidth=`${e.borderStyle.width}px`;const Gt=e.borderStyle.horizontalCornerRadius,Yt=e.borderStyle.verticalCornerRadius;if(Gt>0||Yt>0){const Zt=`calc(${Gt}px * var(--scale-factor)) / calc(${Yt}px * var(--scale-factor))`;X.style.borderRadius=Zt}else if(this instanceof l){const Zt=`calc(${kt}px * var(--scale-factor)) / calc(${qt}px * var(--scale-factor))`;X.style.borderRadius=Zt}switch(e.borderStyle.style){case i.AnnotationBorderStyleType.SOLID:X.style.borderStyle="solid";break;case i.AnnotationBorderStyleType.DASHED:X.style.borderStyle="dashed";break;case i.AnnotationBorderStyleType.BEVELED:(0,i.warn)("Unimplemented border style: beveled");break;case i.AnnotationBorderStyleType.INSET:(0,i.warn)("Unimplemented border style: inset");break;case i.AnnotationBorderStyleType.UNDERLINE:X.style.borderBottomStyle="solid";break}const Jt=e.borderColor||null;Jt?(rt(this,o,!0),X.style.borderColor=i.Util.makeHexColor(Jt[0]|0,Jt[1]|0,Jt[2]|0)):X.style.borderWidth=0}X.style.left=`${100*(Mt[0]-yt)/J}%`,X.style.top=`${100*(Mt[1]-Ft)/ot}%`;const{rotation:Dt}=e;return e.hasOwnCanvas||Dt===0?(X.style.width=`${100*kt/J}%`,X.style.height=`${100*qt/ot}%`):this.setRotation(Dt,X),X}setRotation(N,e=this.container){if(!this.data.rect)return;const{pageWidth:y,pageHeight:B}=this.parent.viewport.rawDims,{width:X,height:J}=O(this.data.rect);let ot,yt;N%180===0?(ot=100*X/y,yt=100*J/B):(ot=100*J/y,yt=100*X/B),e.style.width=`${ot}%`,e.style.height=`${yt}%`,e.setAttribute("data-main-rotation",(360-N)%360)}get _commonActions(){const N=(e,y,B)=>{const X=B.detail[e],J=X[0],ot=X.slice(1);B.target.style[y]=W.ColorConverters[`${J}_HTML`](ot),this.annotationStorage.setValue(this.data.id,{[y]:W.ColorConverters[`${J}_rgb`](ot)})};return(0,i.shadow)(this,"_commonActions",{display:e=>{const{display:y}=e.detail,B=y%2===1;this.container.style.visibility=B?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:B,noPrint:y===1||y===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:y}=e.detail;this.container.style.visibility=y?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:y,noView:y})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{N("bgColor","backgroundColor",e)},fillColor:e=>{N("fillColor","backgroundColor",e)},fgColor:e=>{N("fgColor","color",e)},textColor:e=>{N("textColor","color",e)},borderColor:e=>{N("borderColor","borderColor",e)},strokeColor:e=>{N("strokeColor","borderColor",e)},rotation:e=>{const y=e.detail.rotation;this.setRotation(y),this.annotationStorage.setValue(this.data.id,{rotation:y})}})}_dispatchEventFromSandbox(N,e){const y=this._commonActions;for(const B of Object.keys(e.detail)){const X=N[B]||y[B];X==null||X(e)}}_setDefaultPropertiesFromJS(N){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const y=this._commonActions;for(const[B,X]of Object.entries(e)){const J=y[B];if(J){const ot={detail:{[B]:X},target:N};J(ot),delete e[B]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:N}=this.data;if(!N)return;const[e,y,B,X]=this.data.rect;if(N.length===1){const[,{x:Yt,y:Jt},{x:Zt,y:ie}]=N[0];if(B===Yt&&X===Jt&&e===Zt&&y===ie)return}const{style:J}=this.container;let ot;if(t(this,o)){const{borderColor:Yt,borderWidth:Jt}=J;J.borderWidth=0,ot=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Yt}" stroke-width="${Jt}">`],this.container.classList.add("hasBorder")}const yt=B-e,Ft=X-y,{svgFactory:kt}=this,qt=kt.createElement("svg");qt.classList.add("quadrilateralsContainer"),qt.setAttribute("width",0),qt.setAttribute("height",0);const Mt=kt.createElement("defs");qt.append(Mt);const Dt=kt.createElement("clipPath"),Gt=`clippath_${this.data.id}`;Dt.setAttribute("id",Gt),Dt.setAttribute("clipPathUnits","objectBoundingBox"),Mt.append(Dt);for(const[,{x:Yt,y:Jt},{x:Zt,y:ie}]of N){const se=kt.createElement("rect"),re=(Zt-e)/yt,le=(X-Jt)/Ft,ce=(Yt-Zt)/yt,An=(Jt-ie)/Ft;se.setAttribute("x",re),se.setAttribute("y",le),se.setAttribute("width",ce),se.setAttribute("height",An),Dt.append(se),ot==null||ot.push(`<rect vector-effect="non-scaling-stroke" x="${re}" y="${le}" width="${ce}" height="${An}"/>`)}t(this,o)&&(ot.push("</g></svg>')"),J.backgroundImage=ot.join("")),this.container.append(qt),this.container.style.clipPath=`url(#${Gt})`}_createPopup(){const{container:N,data:e}=this;N.setAttribute("aria-haspopup","dialog");const y=new b({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(y.render())}render(){(0,i.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(N,e=null){const y=[];if(this._fieldObjects){const B=this._fieldObjects[N];if(B)for(const{page:X,id:J,exportValues:ot}of B){if(X===-1||J===e)continue;const yt=typeof ot=="string"?ot:null,Ft=document.querySelector(`[data-element-id="${J}"]`);if(Ft&&!I.has(Ft)){(0,i.warn)(`_getElementsByName - element not allowed: ${J}`);continue}y.push({id:J,exportValue:yt,domElement:Ft})}return y}for(const B of document.getElementsByName(N)){const{exportValue:X}=B,J=B.getAttribute("data-element-id");J!==e&&I.has(B)&&y.push({id:J,exportValue:X,domElement:B})}return y}show(){var N;this.container&&(this.container.hidden=!1),(N=this.popup)==null||N.maybeShow()}hide(){var N;this.container&&(this.container.hidden=!0),(N=this.popup)==null||N.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const N=this.getElementsToTriggerPopup();if(Array.isArray(N))for(const e of N)e.classList.add("highlightArea");else N.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:N,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var y;(y=this.linkService.eventBus)==null||y.dispatch("switchannotationeditormode",{source:this,mode:N,editId:e})})}};o=new WeakMap;let E=s;class v extends E{constructor(e,y=null){super(e,{isRenderable:!0,ignoreBorder:!!(y!=null&&y.ignoreBorder),createQuadrilaterals:!0});H(this,h);H(this,S);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:y}=this,B=document.createElement("a");B.setAttribute("data-element-id",e.id);let X=!1;return e.url?(y.addLinkAttributes(B,e.url,e.newWindow),X=!0):e.action?(this._bindNamedAction(B,e.action),X=!0):e.attachment?(this._bindAttachment(B,e.attachment),X=!0):e.setOCGState?(q(this,S,On).call(this,B,e.setOCGState),X=!0):e.dest?(this._bindLink(B,e.dest),X=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(B,e),X=!0),e.resetForm?(this._bindResetFormAction(B,e.resetForm),X=!0):this.isTooltipOnly&&!X&&(this._bindLink(B,""),X=!0)),this.container.classList.add("linkAnnotation"),X&&this.container.append(B),this.container}_bindLink(e,y){e.href=this.linkService.getDestinationHash(y),e.onclick=()=>(y&&this.linkService.goToDestination(y),!1),(y||y==="")&&q(this,h,he).call(this)}_bindNamedAction(e,y){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(y),!1),q(this,h,he).call(this)}_bindAttachment(e,y){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>{var B;return(B=this.downloadManager)==null||B.openOrDownloadData(this.container,y.content,y.filename),!1},q(this,h,he).call(this)}_bindJSAction(e,y){e.href=this.linkService.getAnchorUrl("");const B=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const X of Object.keys(y.actions)){const J=B.get(X);J&&(e[J]=()=>{var ot;return(ot=this.linkService.eventBus)==null||ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:y.id,name:X}}),!1})}e.onclick||(e.onclick=()=>!1),q(this,h,he).call(this)}_bindResetFormAction(e,y){const B=e.onclick;if(B||(e.href=this.linkService.getAnchorUrl("")),q(this,h,he).call(this),!this._fieldObjects){(0,i.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),B||(e.onclick=()=>!1);return}e.onclick=()=>{var qt;B==null||B();const{fields:X,refs:J,include:ot}=y,yt=[];if(X.length!==0||J.length!==0){const Mt=new Set(J);for(const Dt of X){const Gt=this._fieldObjects[Dt]||[];for(const{id:Yt}of Gt)Mt.add(Yt)}for(const Dt of Object.values(this._fieldObjects))for(const Gt of Dt)Mt.has(Gt.id)===ot&&yt.push(Gt)}else for(const Mt of Object.values(this._fieldObjects))yt.push(...Mt);const Ft=this.annotationStorage,kt=[];for(const Mt of yt){const{id:Dt}=Mt;switch(kt.push(Dt),Mt.type){case"text":{const Yt=Mt.defaultValue||"";Ft.setValue(Dt,{value:Yt});break}case"checkbox":case"radiobutton":{const Yt=Mt.defaultValue===Mt.exportValues;Ft.setValue(Dt,{value:Yt});break}case"combobox":case"listbox":{const Yt=Mt.defaultValue||"";Ft.setValue(Dt,{value:Yt});break}default:continue}const Gt=document.querySelector(`[data-element-id="${Dt}"]`);if(Gt){if(!I.has(Gt)){(0,i.warn)(`_bindResetFormAction - element not allowed: ${Dt}`);continue}}else continue;Gt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((qt=this.linkService.eventBus)==null||qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:kt,name:"ResetForm"}})),!1}}}h=new WeakSet,he=function(){this.container.setAttribute("data-internal-link","")},S=new WeakSet,On=function(e,y){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(y),!1),q(this,h,he).call(this)};class f extends E{constructor(N){super(N,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const N=document.createElement("img");return N.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",N.alt="[{{type}} Annotation]",N.dataset.l10nId="text_annotation_type",N.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(N),this.container}}class _ extends E{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(N){var e;this.data.hasOwnCanvas&&(((e=N.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(N.previousSibling.hidden=!0),N.hidden=!1)}_getKeyModifier(N){const{isWin:e,isMac:y}=i.FeatureTest.platform;return e&&N.ctrlKey||y&&N.metaKey}_setEventListener(N,e,y,B,X){y.includes("mouse")?N.addEventListener(y,J=>{var ot;(ot=this.linkService.eventBus)==null||ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:B,value:X(J),shift:J.shiftKey,modifier:this._getKeyModifier(J)}})}):N.addEventListener(y,J=>{var ot;if(y==="blur"){if(!e.focused||!J.relatedTarget)return;e.focused=!1}else if(y==="focus"){if(e.focused)return;e.focused=!0}X&&((ot=this.linkService.eventBus)==null||ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:B,value:X(J)}}))})}_setEventListeners(N,e,y,B){var X,J,ot;for(const[yt,Ft]of y)(Ft==="Action"||(X=this.data.actions)!=null&&X[Ft])&&((Ft==="Focus"||Ft==="Blur")&&(e||(e={focused:!1})),this._setEventListener(N,e,yt,Ft,B),Ft==="Focus"&&!((J=this.data.actions)!=null&&J.Blur)?this._setEventListener(N,e,"blur","Blur",null):Ft==="Blur"&&!((ot=this.data.actions)!=null&&ot.Focus)&&this._setEventListener(N,e,"focus","Focus",null))}_setBackgroundColor(N){const e=this.data.backgroundColor||null;N.style.backgroundColor=e===null?"transparent":i.Util.makeHexColor(e[0],e[1],e[2])}_setTextStyle(N){const e=["left","center","right"],{fontColor:y}=this.data.defaultAppearanceData,B=this.data.defaultAppearanceData.fontSize||m,X=N.style;let J;const ot=2,yt=Ft=>Math.round(10*Ft)/10;if(this.data.multiLine){const Ft=Math.abs(this.data.rect[3]-this.data.rect[1]-ot),kt=Math.round(Ft/(i.LINE_FACTOR*B))||1,qt=Ft/kt;J=Math.min(B,yt(qt/i.LINE_FACTOR))}else{const Ft=Math.abs(this.data.rect[3]-this.data.rect[1]-ot);J=Math.min(B,yt(Ft/i.LINE_FACTOR))}X.fontSize=`calc(${J}px * var(--scale-factor))`,X.color=i.Util.makeHexColor(y[0],y[1],y[2]),this.data.textAlignment!==null&&(X.textAlign=e[this.data.textAlignment])}_setRequired(N,e){e?N.setAttribute("required",!0):N.removeAttribute("required"),N.setAttribute("aria-required",e)}}class P extends _{constructor(N){const e=N.renderForms||!N.data.hasAppearance&&!!N.data.fieldValue;super(N,{isRenderable:e})}setPropertyOnSiblings(N,e,y,B){const X=this.annotationStorage;for(const J of this._getElementsByName(N.name,N.id))J.domElement&&(J.domElement[e]=y),X.setValue(J.id,{[B]:y})}render(){var B,X;const N=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let y=null;if(this.renderForms){const J=N.getValue(e,{value:this.data.fieldValue});let ot=J.value||"";const yt=N.getValue(e,{charLimit:this.data.maxLen}).charLimit;yt&&ot.length>yt&&(ot=ot.slice(0,yt));let Ft=J.formattedValue||((B=this.data.textContent)==null?void 0:B.join(`
`))||null;Ft&&this.data.comb&&(Ft=Ft.replaceAll(/\s+/g,""));const kt={userValue:ot,formattedValue:Ft,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(y=document.createElement("textarea"),y.textContent=Ft??ot,this.data.doNotScroll&&(y.style.overflowY="hidden")):(y=document.createElement("input"),y.type="text",y.setAttribute("value",Ft??ot),this.data.doNotScroll&&(y.style.overflowX="hidden")),this.data.hasOwnCanvas&&(y.hidden=!0),I.add(y),y.setAttribute("data-element-id",e),y.disabled=this.data.readOnly,y.name=this.data.fieldName,y.tabIndex=C,this._setRequired(y,this.data.required),yt&&(y.maxLength=yt),y.addEventListener("input",Mt=>{N.setValue(e,{value:Mt.target.value}),this.setPropertyOnSiblings(y,"value",Mt.target.value,"value"),kt.formattedValue=null}),y.addEventListener("resetform",Mt=>{const Dt=this.data.defaultFieldValue??"";y.value=kt.userValue=Dt,kt.formattedValue=null});let qt=Mt=>{const{formattedValue:Dt}=kt;Dt!=null&&(Mt.target.value=Dt),Mt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){y.addEventListener("focus",Dt=>{if(kt.focused)return;const{target:Gt}=Dt;kt.userValue&&(Gt.value=kt.userValue),kt.lastCommittedValue=Gt.value,kt.commitKey=1,kt.focused=!0}),y.addEventListener("updatefromsandbox",Dt=>{this.showElementAndHideCanvas(Dt.target);const Gt={value(Yt){kt.userValue=Yt.detail.value??"",N.setValue(e,{value:kt.userValue.toString()}),Yt.target.value=kt.userValue},formattedValue(Yt){const{formattedValue:Jt}=Yt.detail;kt.formattedValue=Jt,Jt!=null&&Yt.target!==document.activeElement&&(Yt.target.value=Jt),N.setValue(e,{formattedValue:Jt})},selRange(Yt){Yt.target.setSelectionRange(...Yt.detail.selRange)},charLimit:Yt=>{var se;const{charLimit:Jt}=Yt.detail,{target:Zt}=Yt;if(Jt===0){Zt.removeAttribute("maxLength");return}Zt.setAttribute("maxLength",Jt);let ie=kt.userValue;!ie||ie.length<=Jt||(ie=ie.slice(0,Jt),Zt.value=kt.userValue=ie,N.setValue(e,{value:ie}),(se=this.linkService.eventBus)==null||se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:ie,willCommit:!0,commitKey:1,selStart:Zt.selectionStart,selEnd:Zt.selectionEnd}}))}};this._dispatchEventFromSandbox(Gt,Dt)}),y.addEventListener("keydown",Dt=>{var Jt;kt.commitKey=1;let Gt=-1;if(Dt.key==="Escape"?Gt=0:Dt.key==="Enter"&&!this.data.multiLine?Gt=2:Dt.key==="Tab"&&(kt.commitKey=3),Gt===-1)return;const{value:Yt}=Dt.target;kt.lastCommittedValue!==Yt&&(kt.lastCommittedValue=Yt,kt.userValue=Yt,(Jt=this.linkService.eventBus)==null||Jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:Yt,willCommit:!0,commitKey:Gt,selStart:Dt.target.selectionStart,selEnd:Dt.target.selectionEnd}}))});const Mt=qt;qt=null,y.addEventListener("blur",Dt=>{var Yt;if(!kt.focused||!Dt.relatedTarget)return;kt.focused=!1;const{value:Gt}=Dt.target;kt.userValue=Gt,kt.lastCommittedValue!==Gt&&((Yt=this.linkService.eventBus)==null||Yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:Gt,willCommit:!0,commitKey:kt.commitKey,selStart:Dt.target.selectionStart,selEnd:Dt.target.selectionEnd}})),Mt(Dt)}),(X=this.data.actions)!=null&&X.Keystroke&&y.addEventListener("beforeinput",Dt=>{var le;kt.lastCommittedValue=null;const{data:Gt,target:Yt}=Dt,{value:Jt,selectionStart:Zt,selectionEnd:ie}=Yt;let se=Zt,re=ie;switch(Dt.inputType){case"deleteWordBackward":{const ce=Jt.substring(0,Zt).match(/\w*[^\w]*$/);ce&&(se-=ce[0].length);break}case"deleteWordForward":{const ce=Jt.substring(Zt).match(/^[^\w]*\w*/);ce&&(re+=ce[0].length);break}case"deleteContentBackward":Zt===ie&&(se-=1);break;case"deleteContentForward":Zt===ie&&(re+=1);break}Dt.preventDefault(),(le=this.linkService.eventBus)==null||le.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:Jt,change:Gt||"",willCommit:!1,selStart:se,selEnd:re}})}),this._setEventListeners(y,kt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Dt=>Dt.target.value)}if(qt&&y.addEventListener("blur",qt),this.data.comb){const Dt=(this.data.rect[2]-this.data.rect[0])/yt;y.classList.add("comb"),y.style.letterSpacing=`calc(${Dt}px * var(--scale-factor) - 1ch)`}}else y=document.createElement("div"),y.textContent=this.data.fieldValue,y.style.verticalAlign="middle",y.style.display="table-cell";return this._setTextStyle(y),this._setBackgroundColor(y),this._setDefaultPropertiesFromJS(y),this.container.append(y),this.container}}class w extends _{constructor(N){super(N,{isRenderable:!!N.data.hasOwnCanvas})}}class A extends _{constructor(N){super(N,{isRenderable:N.renderForms})}render(){const N=this.annotationStorage,e=this.data,y=e.id;let B=N.getValue(y,{value:e.exportValue===e.fieldValue}).value;typeof B=="string"&&(B=B!=="Off",N.setValue(y,{value:B})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const X=document.createElement("input");return I.add(X),X.setAttribute("data-element-id",y),X.disabled=e.readOnly,this._setRequired(X,this.data.required),X.type="checkbox",X.name=e.fieldName,B&&X.setAttribute("checked",!0),X.setAttribute("exportValue",e.exportValue),X.tabIndex=C,X.addEventListener("change",J=>{const{name:ot,checked:yt}=J.target;for(const Ft of this._getElementsByName(ot,y)){const kt=yt&&Ft.exportValue===e.exportValue;Ft.domElement&&(Ft.domElement.checked=kt),N.setValue(Ft.id,{value:kt})}N.setValue(y,{value:yt})}),X.addEventListener("resetform",J=>{const ot=e.defaultFieldValue||"Off";J.target.checked=ot===e.exportValue}),this.enableScripting&&this.hasJSActions&&(X.addEventListener("updatefromsandbox",J=>{const ot={value(yt){yt.target.checked=yt.detail.value!=="Off",N.setValue(y,{value:yt.target.checked})}};this._dispatchEventFromSandbox(ot,J)}),this._setEventListeners(X,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],J=>J.target.checked)),this._setBackgroundColor(X),this._setDefaultPropertiesFromJS(X),this.container.append(X),this.container}}class l extends _{constructor(N){super(N,{isRenderable:N.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const N=this.annotationStorage,e=this.data,y=e.id;let B=N.getValue(y,{value:e.fieldValue===e.buttonValue}).value;typeof B=="string"&&(B=B!==e.buttonValue,N.setValue(y,{value:B}));const X=document.createElement("input");if(I.add(X),X.setAttribute("data-element-id",y),X.disabled=e.readOnly,this._setRequired(X,this.data.required),X.type="radio",X.name=e.fieldName,B&&X.setAttribute("checked",!0),X.tabIndex=C,X.addEventListener("change",J=>{const{name:ot,checked:yt}=J.target;for(const Ft of this._getElementsByName(ot,y))N.setValue(Ft.id,{value:!1});N.setValue(y,{value:yt})}),X.addEventListener("resetform",J=>{const ot=e.defaultFieldValue;J.target.checked=ot!=null&&ot===e.buttonValue}),this.enableScripting&&this.hasJSActions){const J=e.buttonValue;X.addEventListener("updatefromsandbox",ot=>{const yt={value:Ft=>{const kt=J===Ft.detail.value;for(const qt of this._getElementsByName(Ft.target.name)){const Mt=kt&&qt.id===y;qt.domElement&&(qt.domElement.checked=Mt),N.setValue(qt.id,{value:Mt})}}};this._dispatchEventFromSandbox(yt,ot)}),this._setEventListeners(X,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ot=>ot.target.checked)}return this._setBackgroundColor(X),this._setDefaultPropertiesFromJS(X),this.container.append(X),this.container}}class d extends v{constructor(N){super(N,{ignoreBorder:N.data.hasAppearance})}render(){const N=super.render();N.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(N.title=this.data.alternativeText);const e=N.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",y=>{this._dispatchEventFromSandbox({},y)})),N}}class M extends _{constructor(N){super(N,{isRenderable:N.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const N=this.annotationStorage,e=this.data.id,y=N.getValue(e,{value:this.data.fieldValue}),B=document.createElement("select");I.add(B),B.setAttribute("data-element-id",e),B.disabled=this.data.readOnly,this._setRequired(B,this.data.required),B.name=this.data.fieldName,B.tabIndex=C;let X=this.data.combo&&this.data.options.length>0;this.data.combo||(B.size=this.data.options.length,this.data.multiSelect&&(B.multiple=!0)),B.addEventListener("resetform",kt=>{const qt=this.data.defaultFieldValue;for(const Mt of B.options)Mt.selected=Mt.value===qt});for(const kt of this.data.options){const qt=document.createElement("option");qt.textContent=kt.displayValue,qt.value=kt.exportValue,y.value.includes(kt.exportValue)&&(qt.setAttribute("selected",!0),X=!1),B.append(qt)}let J=null;if(X){const kt=document.createElement("option");kt.value=" ",kt.setAttribute("hidden",!0),kt.setAttribute("selected",!0),B.prepend(kt),J=()=>{kt.remove(),B.removeEventListener("input",J),J=null},B.addEventListener("input",J)}const ot=kt=>{const qt=kt?"value":"textContent",{options:Mt,multiple:Dt}=B;return Dt?Array.prototype.filter.call(Mt,Gt=>Gt.selected).map(Gt=>Gt[qt]):Mt.selectedIndex===-1?null:Mt[Mt.selectedIndex][qt]};let yt=ot(!1);const Ft=kt=>{const qt=kt.target.options;return Array.prototype.map.call(qt,Mt=>({displayValue:Mt.textContent,exportValue:Mt.value}))};return this.enableScripting&&this.hasJSActions?(B.addEventListener("updatefromsandbox",kt=>{const qt={value(Mt){J==null||J();const Dt=Mt.detail.value,Gt=new Set(Array.isArray(Dt)?Dt:[Dt]);for(const Yt of B.options)Yt.selected=Gt.has(Yt.value);N.setValue(e,{value:ot(!0)}),yt=ot(!1)},multipleSelection(Mt){B.multiple=!0},remove(Mt){const Dt=B.options,Gt=Mt.detail.remove;Dt[Gt].selected=!1,B.remove(Gt),Dt.length>0&&Array.prototype.findIndex.call(Dt,Jt=>Jt.selected)===-1&&(Dt[0].selected=!0),N.setValue(e,{value:ot(!0),items:Ft(Mt)}),yt=ot(!1)},clear(Mt){for(;B.length!==0;)B.remove(0);N.setValue(e,{value:null,items:[]}),yt=ot(!1)},insert(Mt){const{index:Dt,displayValue:Gt,exportValue:Yt}=Mt.detail.insert,Jt=B.children[Dt],Zt=document.createElement("option");Zt.textContent=Gt,Zt.value=Yt,Jt?Jt.before(Zt):B.append(Zt),N.setValue(e,{value:ot(!0),items:Ft(Mt)}),yt=ot(!1)},items(Mt){const{items:Dt}=Mt.detail;for(;B.length!==0;)B.remove(0);for(const Gt of Dt){const{displayValue:Yt,exportValue:Jt}=Gt,Zt=document.createElement("option");Zt.textContent=Yt,Zt.value=Jt,B.append(Zt)}B.options.length>0&&(B.options[0].selected=!0),N.setValue(e,{value:ot(!0),items:Ft(Mt)}),yt=ot(!1)},indices(Mt){const Dt=new Set(Mt.detail.indices);for(const Gt of Mt.target.options)Gt.selected=Dt.has(Gt.index);N.setValue(e,{value:ot(!0)}),yt=ot(!1)},editable(Mt){Mt.target.disabled=!Mt.detail.editable}};this._dispatchEventFromSandbox(qt,kt)}),B.addEventListener("input",kt=>{var Mt;const qt=ot(!0);N.setValue(e,{value:qt}),kt.preventDefault(),(Mt=this.linkService.eventBus)==null||Mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:yt,changeEx:qt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(B,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],kt=>kt.target.value)):B.addEventListener("input",function(kt){N.setValue(e,{value:ot(!0)})}),this.data.combo&&this._setTextStyle(B),this._setBackgroundColor(B),this._setDefaultPropertiesFromJS(B),this.container.append(B),this.container}}class b extends E{constructor(N){const{data:e,elements:y}=N;super(N,{isRenderable:E._hasPopupData(e)}),this.elements=y}render(){this.container.classList.add("popupAnnotation");const N=new c({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const y of this.elements)y.popup=N,e.push(y.data.id),y.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(y=>`${i.AnnotationPrefix}${y}`).join(",")),this.container}}class c{constructor({container:N,color:e,elements:y,titleObj:B,modificationDate:X,contentsObj:J,richText:ot,parent:yt,rect:Ft,parentRect:kt,open:qt}){H(this,Ut);H(this,Ht);H(this,$t);H(this,Xt);H(this,U,null);H(this,st,q(this,Ut,Nn).bind(this));H(this,tt,q(this,Xt,cn).bind(this));H(this,at,q(this,$t,ln).bind(this));H(this,ut,q(this,Ht,Fe).bind(this));H(this,gt,null);H(this,ct,null);H(this,Rt,null);H(this,It,null);H(this,Et,null);H(this,Lt,null);H(this,mt,!1);H(this,et,null);H(this,nt,null);H(this,pt,null);H(this,Pt,null);H(this,Ct,!1);var Dt;rt(this,ct,N),rt(this,Pt,B),rt(this,Rt,J),rt(this,pt,ot),rt(this,Et,yt),rt(this,gt,e),rt(this,nt,Ft),rt(this,Lt,kt),rt(this,It,y);const Mt=p.PDFDateString.toDateObject(X);Mt&&rt(this,U,yt.l10n.get("annotation_date_string",{date:Mt.toLocaleDateString(),time:Mt.toLocaleTimeString()})),this.trigger=y.flatMap(Gt=>Gt.getElementsToTriggerPopup());for(const Gt of this.trigger)Gt.addEventListener("click",t(this,ut)),Gt.addEventListener("mouseenter",t(this,at)),Gt.addEventListener("mouseleave",t(this,tt)),Gt.classList.add("popupTriggerArea");for(const Gt of y)(Dt=Gt.container)==null||Dt.addEventListener("keydown",t(this,st));t(this,ct).hidden=!0,qt&&q(this,Ht,Fe).call(this)}render(){if(t(this,et))return;const{page:{view:N},viewport:{rawDims:{pageWidth:e,pageHeight:y,pageX:B,pageY:X}}}=t(this,Et),J=rt(this,et,document.createElement("div"));if(J.className="popup",t(this,gt)){const se=J.style.outlineColor=i.Util.makeHexColor(...t(this,gt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?J.style.backgroundColor=`color-mix(in srgb, ${se} 30%, white)`:J.style.backgroundColor=i.Util.makeHexColor(...t(this,gt).map(le=>Math.floor(.7*(255-le)+le)))}const ot=document.createElement("span");ot.className="header";const yt=document.createElement("h1");if(ot.append(yt),{dir:yt.dir,str:yt.textContent}=t(this,Pt),J.append(ot),t(this,U)){const se=document.createElement("span");se.classList.add("popupDate"),t(this,U).then(re=>{se.textContent=re}),ot.append(se)}const Ft=t(this,Rt),kt=t(this,pt);if(kt!=null&&kt.str&&(!(Ft!=null&&Ft.str)||Ft.str===kt.str))F.XfaLayer.render({xfaHtml:kt.html,intent:"richText",div:J}),J.lastChild.classList.add("richText","popupContent");else{const se=this._formatContents(Ft);J.append(se)}let qt=!!t(this,Lt),Mt=qt?t(this,Lt):t(this,nt);for(const se of t(this,It))if(!Mt||i.Util.intersect(se.data.rect,Mt)!==null){Mt=se.data.rect,qt=!0;break}const Dt=i.Util.normalizeRect([Mt[0],N[3]-Mt[1]+N[1],Mt[2],N[3]-Mt[3]+N[1]]),Yt=qt?Mt[2]-Mt[0]+5:0,Jt=Dt[0]+Yt,Zt=Dt[1],{style:ie}=t(this,ct);ie.left=`${100*(Jt-B)/e}%`,ie.top=`${100*(Zt-X)/y}%`,t(this,ct).append(J)}_formatContents({str:N,dir:e}){const y=document.createElement("p");y.classList.add("popupContent"),y.dir=e;const B=N.split(/(?:\r\n?|\n)/);for(let X=0,J=B.length;X<J;++X){const ot=B[X];y.append(document.createTextNode(ot)),X<J-1&&y.append(document.createElement("br"))}return y}forceHide(){rt(this,Ct,this.isVisible),t(this,Ct)&&(t(this,ct).hidden=!0)}maybeShow(){t(this,Ct)&&(rt(this,Ct,!1),t(this,ct).hidden=!1)}get isVisible(){return t(this,ct).hidden===!1}}U=new WeakMap,st=new WeakMap,tt=new WeakMap,at=new WeakMap,ut=new WeakMap,gt=new WeakMap,ct=new WeakMap,Rt=new WeakMap,It=new WeakMap,Et=new WeakMap,Lt=new WeakMap,mt=new WeakMap,et=new WeakMap,nt=new WeakMap,pt=new WeakMap,Pt=new WeakMap,Ct=new WeakMap,Ut=new WeakSet,Nn=function(N){N.altKey||N.shiftKey||N.ctrlKey||N.metaKey||(N.key==="Enter"||N.key==="Escape"&&t(this,mt))&&q(this,Ht,Fe).call(this)},Ht=new WeakSet,Fe=function(){rt(this,mt,!t(this,mt)),t(this,mt)?(q(this,$t,ln).call(this),t(this,ct).addEventListener("click",t(this,ut)),t(this,ct).addEventListener("keydown",t(this,st))):(q(this,Xt,cn).call(this),t(this,ct).removeEventListener("click",t(this,ut)),t(this,ct).removeEventListener("keydown",t(this,st)))},$t=new WeakSet,ln=function(){t(this,et)||this.render(),this.isVisible?t(this,mt)&&t(this,ct).classList.add("focused"):(t(this,ct).hidden=!1,t(this,ct).style.zIndex=parseInt(t(this,ct).style.zIndex)+1e3)},Xt=new WeakSet,cn=function(){t(this,ct).classList.remove("focused"),!(t(this,mt)||!this.isVisible)&&(t(this,ct).hidden=!0,t(this,ct).style.zIndex=parseInt(t(this,ct).style.zIndex)-1e3)};class k extends E{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0}),this.textContent=N.data.textContent,this.textPosition=N.data.textPosition,this.annotationEditorType=i.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const N=document.createElement("div");N.classList.add("annotationTextContent"),N.setAttribute("role","comment");for(const e of this.textContent){const y=document.createElement("span");y.textContent=e,N.append(y)}this.container.append(N)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}a.FreeTextAnnotationElement=k;class g extends E{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});H(this,Z,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:y,height:B}=O(e.rect),X=this.svgFactory.create(y,B,!0),J=rt(this,Z,this.svgFactory.createElement("svg:line"));return J.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),J.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),J.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),J.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),J.setAttribute("stroke-width",e.borderStyle.width||1),J.setAttribute("stroke","transparent"),J.setAttribute("fill","transparent"),X.append(J),this.container.append(X),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Z)}addHighlightArea(){this.container.classList.add("highlightArea")}}Z=new WeakMap;class G extends E{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});H(this,K,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:y,height:B}=O(e.rect),X=this.svgFactory.create(y,B,!0),J=e.borderStyle.width,ot=rt(this,K,this.svgFactory.createElement("svg:rect"));return ot.setAttribute("x",J/2),ot.setAttribute("y",J/2),ot.setAttribute("width",y-J),ot.setAttribute("height",B-J),ot.setAttribute("stroke-width",J||1),ot.setAttribute("stroke","transparent"),ot.setAttribute("fill","transparent"),X.append(ot),this.container.append(X),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,K)}addHighlightArea(){this.container.classList.add("highlightArea")}}K=new WeakMap;class z extends E{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});H(this,_t,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:y,height:B}=O(e.rect),X=this.svgFactory.create(y,B,!0),J=e.borderStyle.width,ot=rt(this,_t,this.svgFactory.createElement("svg:ellipse"));return ot.setAttribute("cx",y/2),ot.setAttribute("cy",B/2),ot.setAttribute("rx",y/2-J/2),ot.setAttribute("ry",B/2-J/2),ot.setAttribute("stroke-width",J||1),ot.setAttribute("stroke","transparent"),ot.setAttribute("fill","transparent"),X.append(ot),this.container.append(X),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,_t)}addHighlightArea(){this.container.classList.add("highlightArea")}}_t=new WeakMap;class T extends E{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});H(this,vt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:y,height:B}=O(e.rect),X=this.svgFactory.create(y,B,!0);let J=[];for(const yt of e.vertices){const Ft=yt.x-e.rect[0],kt=e.rect[3]-yt.y;J.push(Ft+","+kt)}J=J.join(" ");const ot=rt(this,vt,this.svgFactory.createElement(this.svgElementName));return ot.setAttribute("points",J),ot.setAttribute("stroke-width",e.borderStyle.width||1),ot.setAttribute("stroke","transparent"),ot.setAttribute("fill","transparent"),X.append(ot),this.container.append(X),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,vt)}addHighlightArea(){this.container.classList.add("highlightArea")}}vt=new WeakMap;class Y extends T{constructor(N){super(N),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class it extends E{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class lt extends E{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});H(this,ee,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=i.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:y,height:B}=O(e.rect),X=this.svgFactory.create(y,B,!0);for(const J of e.inkLists){let ot=[];for(const Ft of J){const kt=Ft.x-e.rect[0],qt=e.rect[3]-Ft.y;ot.push(`${kt},${qt}`)}ot=ot.join(" ");const yt=this.svgFactory.createElement(this.svgElementName);t(this,ee).push(yt),yt.setAttribute("points",ot),yt.setAttribute("stroke-width",e.borderStyle.width||1),yt.setAttribute("stroke","transparent"),yt.setAttribute("fill","transparent"),!e.popupRef&&this.hasPopupData&&this._createPopup(),X.append(yt)}return this.container.append(X),this.container}getElementsToTriggerPopup(){return t(this,ee)}addHighlightArea(){this.container.classList.add("highlightArea")}}ee=new WeakMap,a.InkAnnotationElement=lt;class $ extends E{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class ht extends E{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class bt extends E{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class St extends E{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class wt extends E{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}a.StampAnnotationElement=wt;class R extends E{constructor(e){var X;super(e,{isRenderable:!0});H(this,Q);H(this,te,null);const{filename:y,content:B}=this.data.file;this.filename=(0,p.getFilenameFromUrl)(y,!0),this.content=B,(X=this.linkService.eventBus)==null||X.dispatch("fileattachmentannotation",{source:this,filename:y,content:B})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:y}=this;let B;y.hasAppearance||y.fillAlpha===0?B=document.createElement("div"):(B=document.createElement("img"),B.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(y.name)?"paperclip":"pushpin"}.svg`,y.fillAlpha&&y.fillAlpha<1&&(B.style=`filter: opacity(${Math.round(y.fillAlpha*100)}%);`)),B.addEventListener("dblclick",q(this,Q,hn).bind(this)),rt(this,te,B);const{isMac:X}=i.FeatureTest.platform;return e.addEventListener("keydown",J=>{J.key==="Enter"&&(X?J.metaKey:J.ctrlKey)&&q(this,Q,hn).call(this)}),!y.popupRef&&this.hasPopupData?this._createPopup():B.classList.add("popupTriggerArea"),e.append(B),e}getElementsToTriggerPopup(){return t(this,te)}addHighlightArea(){this.container.classList.add("highlightArea")}}te=new WeakMap,Q=new WeakSet,hn=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.container,this.content,this.filename)};class n{constructor({div:N,accessibilityManager:e,annotationCanvasMap:y,l10n:B,page:X,viewport:J}){H(this,jt);H(this,At);H(this,Nt,null);H(this,xt,null);H(this,Bt,new Map);this.div=N,rt(this,Nt,e),rt(this,xt,y),this.l10n=B,this.page=X,this.viewport=J,this.zIndex=0,this.l10n||(this.l10n=dt.NullL10n)}async render(N){const{annotations:e}=N,y=this.div;(0,p.setLayerDimensions)(y,this.viewport);const B=new Map,X={data:null,layer:y,linkService:N.linkService,downloadManager:N.downloadManager,imageResourcesPath:N.imageResourcesPath||"",renderForms:N.renderForms!==!1,svgFactory:new p.DOMSVGFactory,annotationStorage:N.annotationStorage||new V.AnnotationStorage,enableScripting:N.enableScripting===!0,hasJSActions:N.hasJSActions,fieldObjects:N.fieldObjects,parent:this,elements:null};for(const J of e){if(J.noHTML)continue;const ot=J.annotationType===i.AnnotationType.POPUP;if(ot){const kt=B.get(J.id);if(!kt)continue;X.elements=kt}else{const{width:kt,height:qt}=O(J.rect);if(kt<=0||qt<=0)continue}X.data=J;const yt=x.create(X);if(!yt.isRenderable)continue;if(!ot&&J.popupRef){const kt=B.get(J.popupRef);kt?kt.push(yt):B.set(J.popupRef,[yt])}yt.annotationEditorType>0&&t(this,Bt).set(yt.data.id,yt);const Ft=yt.render();J.hidden&&(Ft.style.visibility="hidden"),q(this,jt,Bn).call(this,Ft,J.id)}q(this,At,dn).call(this),await this.l10n.translate(y)}update({viewport:N}){const e=this.div;this.viewport=N,(0,p.setLayerDimensions)(e,{rotation:N.rotation}),q(this,At,dn).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(t(this,Bt).values())}getEditableAnnotation(N){return t(this,Bt).get(N)}}Nt=new WeakMap,xt=new WeakMap,Bt=new WeakMap,jt=new WeakSet,Bn=function(N,e){var B;const y=N.firstChild||N;y.id=`${i.AnnotationPrefix}${e}`,this.div.append(N),(B=t(this,Nt))==null||B.moveElementInDOM(this.div,N,y,!1)},At=new WeakSet,dn=function(){if(!t(this,xt))return;const N=this.div;for(const[e,y]of t(this,xt)){const B=N.querySelector(`[data-annotation-id="${e}"]`);if(!B)continue;const{firstChild:X}=B;X?X.nodeName==="CANVAS"?X.replaceWith(y):X.before(y):B.append(y)}t(this,xt).clear()},a.AnnotationLayer=n},(D,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ColorConverters=void 0;function j(V){return Math.floor(Math.max(0,Math.min(1,V))*255).toString(16).padStart(2,"0")}function i(V){return Math.max(0,Math.min(255,255*V))}class p{static CMYK_G([W,dt,F,C]){return["G",1-Math.min(1,.3*W+.59*F+.11*dt+C)]}static G_CMYK([W]){return["CMYK",0,0,0,1-W]}static G_RGB([W]){return["RGB",W,W,W]}static G_rgb([W]){return W=i(W),[W,W,W]}static G_HTML([W]){const dt=j(W);return`#${dt}${dt}${dt}`}static RGB_G([W,dt,F]){return["G",.3*W+.59*dt+.11*F]}static RGB_rgb(W){return W.map(i)}static RGB_HTML(W){return`#${W.map(j).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([W,dt,F,C]){return["RGB",1-Math.min(1,W+C),1-Math.min(1,F+C),1-Math.min(1,dt+C)]}static CMYK_rgb([W,dt,F,C]){return[i(1-Math.min(1,W+C)),i(1-Math.min(1,F+C)),i(1-Math.min(1,dt+C))]}static CMYK_HTML(W){const dt=this.CMYK_RGB(W).slice(1);return this.RGB_HTML(dt)}static RGB_CMYK([W,dt,F]){const C=1-W,m=1-dt,I=1-F,O=Math.min(C,m,I);return["CMYK",C,m,I,O]}}a.ColorConverters=p},(D,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.NullL10n=void 0,a.getL10nFallback=i;const j={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};j.print_progress_percent="{{progress}}%";function i(W,dt){switch(W){case"find_match_count":W=`find_match_count[${dt.total===1?"one":"other"}]`;break;case"find_match_count_limit":W=`find_match_count_limit[${dt.limit===1?"one":"other"}]`;break}return j[W]||""}function p(W,dt){return dt?W.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(F,C)=>C in dt?dt[C]:"{{"+C+"}}"):W}const V={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(W,dt=null,F=i(W,dt)){return p(F,dt)},async translate(W){}};a.NullL10n=V},(D,a,j)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.XfaLayer=void 0;var i=j(25);class p{static setupStorage(W,dt,F,C,m){const I=C.getValue(dt,{value:null});switch(F.name){case"textarea":if(I.value!==null&&(W.textContent=I.value),m==="print")break;W.addEventListener("input",O=>{C.setValue(dt,{value:O.target.value})});break;case"input":if(F.attributes.type==="radio"||F.attributes.type==="checkbox"){if(I.value===F.attributes.xfaOn?W.setAttribute("checked",!0):I.value===F.attributes.xfaOff&&W.removeAttribute("checked"),m==="print")break;W.addEventListener("change",O=>{C.setValue(dt,{value:O.target.checked?O.target.getAttribute("xfaOn"):O.target.getAttribute("xfaOff")})})}else{if(I.value!==null&&W.setAttribute("value",I.value),m==="print")break;W.addEventListener("input",O=>{C.setValue(dt,{value:O.target.value})})}break;case"select":if(I.value!==null){W.setAttribute("value",I.value);for(const O of F.children)O.attributes.value===I.value?O.attributes.selected=!0:O.attributes.hasOwnProperty("selected")&&delete O.attributes.selected}W.addEventListener("input",O=>{const x=O.target.options,E=x.selectedIndex===-1?"":x[x.selectedIndex].value;C.setValue(dt,{value:E})});break}}static setAttributes({html:W,element:dt,storage:F=null,intent:C,linkService:m}){const{attributes:I}=dt,O=W instanceof HTMLAnchorElement;I.type==="radio"&&(I.name=`${I.name}-${C}`);for(const[x,E]of Object.entries(I))if(E!=null)switch(x){case"class":E.length&&W.setAttribute(x,E.join(" "));break;case"dataId":break;case"id":W.setAttribute("data-element-id",E);break;case"style":Object.assign(W.style,E);break;case"textContent":W.textContent=E;break;default:(!O||x!=="href"&&x!=="newWindow")&&W.setAttribute(x,E)}O&&m.addLinkAttributes(W,I.href,I.newWindow),F&&I.dataId&&this.setupStorage(W,I.dataId,dt,F)}static render(W){var v;const dt=W.annotationStorage,F=W.linkService,C=W.xfaHtml,m=W.intent||"display",I=document.createElement(C.name);C.attributes&&this.setAttributes({html:I,element:C,intent:m,linkService:F});const O=[[C,-1,I]],x=W.div;if(x.append(I),W.viewport){const f=`matrix(${W.viewport.transform.join(",")})`;x.style.transform=f}m!=="richText"&&x.setAttribute("class","xfaLayer xfaFont");const E=[];for(;O.length>0;){const[f,_,P]=O.at(-1);if(_+1===f.children.length){O.pop();continue}const w=f.children[++O.at(-1)[1]];if(w===null)continue;const{name:A}=w;if(A==="#text"){const d=document.createTextNode(w.value);E.push(d),P.append(d);continue}const l=(v=w==null?void 0:w.attributes)!=null&&v.xmlns?document.createElementNS(w.attributes.xmlns,A):document.createElement(A);if(P.append(l),w.attributes&&this.setAttributes({html:l,element:w,storage:dt,intent:m,linkService:F}),w.children&&w.children.length>0)O.push([w,-1,l]);else if(w.value){const d=document.createTextNode(w.value);i.XfaText.shouldBuildText(A)&&E.push(d),l.append(d)}}for(const f of x.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:E}}static update(W){const dt=`matrix(${W.viewport.transform.join(",")})`;W.div.style.transform=dt,W.div.hidden=!1}}a.XfaLayer=p},(D,a,j)=>{var C,m,I,O,x,E,v,f,_,P,w,A,l,d,M,jn,c,Un,g,Hn,z,Wn,Y,un,lt,Gn,ht,fn,St,$n,R,Vn,o,zn,h,Xn,S,qn,U,oe,tt,pn,ut,Me,ct,De,It,pe,Lt,gn,et,Le,pt,Yn,Ct,mn,Vt,Kn,zt,Jn,Wt,bn,ft,Ie,K,ge;Object.defineProperty(a,"__esModule",{value:!0}),a.InkEditor=void 0;var i=j(1),p=j(4),V=j(29),W=j(6),dt=j(5);const vt=class vt extends p.AnnotationEditor{constructor(Q){super({...Q,name:"inkEditor"});H(this,M);H(this,c);H(this,g);H(this,z);H(this,Y);H(this,lt);H(this,ht);H(this,St);H(this,R);H(this,o);H(this,h);H(this,S);H(this,U);H(this,tt);H(this,ut);H(this,ct);H(this,It);H(this,Lt);H(this,et);H(this,zt);H(this,Wt);H(this,ft);H(this,K);H(this,C,0);H(this,m,0);H(this,I,this.canvasPointermove.bind(this));H(this,O,this.canvasPointerleave.bind(this));H(this,x,this.canvasPointerup.bind(this));H(this,E,this.canvasPointerdown.bind(this));H(this,v,new Path2D);H(this,f,!1);H(this,_,!1);H(this,P,!1);H(this,w,null);H(this,A,0);H(this,l,0);H(this,d,null);this.color=Q.color||null,this.thickness=Q.thickness||null,this.opacity=Q.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Q){p.AnnotationEditor.initialize(Q,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Q,Tt){switch(Q){case i.AnnotationEditorParamsType.INK_THICKNESS:vt._defaultThickness=Tt;break;case i.AnnotationEditorParamsType.INK_COLOR:vt._defaultColor=Tt;break;case i.AnnotationEditorParamsType.INK_OPACITY:vt._defaultOpacity=Tt/100;break}}updateParams(Q,Tt){switch(Q){case i.AnnotationEditorParamsType.INK_THICKNESS:q(this,M,jn).call(this,Tt);break;case i.AnnotationEditorParamsType.INK_COLOR:q(this,c,Un).call(this,Tt);break;case i.AnnotationEditorParamsType.INK_OPACITY:q(this,g,Hn).call(this,Tt);break}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.INK_THICKNESS,vt._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,vt._defaultColor||p.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(vt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[i.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||vt._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,this.color||vt._defaultColor||p.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??vt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(q(this,ut,Me).call(this),q(this,ct,De).call(this)),this.isAttachedToDOM||(this.parent.add(this),q(this,It,pe).call(this)),q(this,K,ge).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,w).disconnect(),rt(this,w,null),super.remove())}setParent(Q){!this.parent&&Q?this._uiManager.removeShouldRescale(this):this.parent&&Q===null&&this._uiManager.addShouldRescale(this),super.setParent(Q)}onScaleChanging(){const[Q,Tt]=this.parentDimensions,Nt=this.width*Q,xt=this.height*Tt;this.setDimensions(Nt,xt)}enableEditMode(){t(this,f)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,E)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,E)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,f)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),rt(this,f,!0),this.div.classList.add("disabled"),q(this,K,ge).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Q){this._focusEventsAllowed&&(super.focusin(Q),this.enableEditMode())}canvasPointerdown(Q){Q.button!==0||!this.isInEditMode()||t(this,f)||(this.setInForeground(),Q.preventDefault(),Q.type!=="mouse"&&this.div.focus(),q(this,lt,Gn).call(this,Q.offsetX,Q.offsetY))}canvasPointermove(Q){Q.preventDefault(),q(this,ht,fn).call(this,Q.offsetX,Q.offsetY)}canvasPointerup(Q){Q.preventDefault(),q(this,tt,pn).call(this,Q)}canvasPointerleave(Q){q(this,tt,pn).call(this,Q)}get isResizable(){return!this.isEmpty()&&t(this,f)}render(){if(this.div)return this.div;let Q,Tt;this.width&&(Q=this.x,Tt=this.y),super.render(),p.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Qt=>{var At;return(At=this.div)==null?void 0:At.setAttribute("aria-label",Qt)});const[Nt,xt,Bt,jt]=q(this,z,Wn).call(this);if(this.setAt(Nt,xt,0,0),this.setDims(Bt,jt),q(this,ut,Me).call(this),this.width){const[Qt,At]=this.parentDimensions;this.setAspectRatio(this.width*Qt,this.height*At),this.setAt(Q*Qt,Tt*At,this.width*Qt,this.height*At),rt(this,P,!0),q(this,It,pe).call(this),this.setDims(this.width*Qt,this.height*At),q(this,U,oe).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return q(this,ct,De).call(this),this.div}setDimensions(Q,Tt){const Nt=Math.round(Q),xt=Math.round(Tt);if(t(this,A)===Nt&&t(this,l)===xt)return;rt(this,A,Nt),rt(this,l,xt),this.canvas.style.visibility="hidden";const[Bt,jt]=this.parentDimensions;this.width=Q/Bt,this.height=Tt/jt,this.fixAndSetPosition(),t(this,f)&&q(this,Lt,gn).call(this,Q,Tt),q(this,It,pe).call(this),q(this,U,oe).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Q,Tt,Nt){var X,J,ot;if(Q instanceof V.InkAnnotationElement)return null;const xt=super.deserialize(Q,Tt,Nt);xt.thickness=Q.thickness,xt.color=i.Util.makeHexColor(...Q.color),xt.opacity=Q.opacity;const[Bt,jt]=xt.pageDimensions,Qt=xt.width*Bt,At=xt.height*jt,Kt=xt.parentScale,Ot=Q.thickness/2;rt(xt,f,!0),rt(xt,A,Math.round(Qt)),rt(xt,l,Math.round(At));const{paths:N,rect:e,rotation:y}=Q;for(let{bezier:yt}of N){yt=q(X=vt,Vt,Kn).call(X,yt,e,y);const Ft=[];xt.paths.push(Ft);let kt=Kt*(yt[0]-Ot),qt=Kt*(yt[1]-Ot);for(let Dt=2,Gt=yt.length;Dt<Gt;Dt+=6){const Yt=Kt*(yt[Dt]-Ot),Jt=Kt*(yt[Dt+1]-Ot),Zt=Kt*(yt[Dt+2]-Ot),ie=Kt*(yt[Dt+3]-Ot),se=Kt*(yt[Dt+4]-Ot),re=Kt*(yt[Dt+5]-Ot);Ft.push([[kt,qt],[Yt,Jt],[Zt,ie],[se,re]]),kt=se,qt=re}const Mt=q(this,pt,Yn).call(this,Ft);xt.bezierPath2D.push(Mt)}const B=q(J=xt,Wt,bn).call(J);return rt(xt,m,Math.max(p.AnnotationEditor.MIN_SIZE,B[2]-B[0])),rt(xt,C,Math.max(p.AnnotationEditor.MIN_SIZE,B[3]-B[1])),q(ot=xt,Lt,gn).call(ot,Qt,At),xt}serialize(){if(this.isEmpty())return null;const Q=this.getRect(0,0),Tt=p.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:i.AnnotationEditorType.INK,color:Tt,thickness:this.thickness,opacity:this.opacity,paths:q(this,zt,Jn).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Q),pageIndex:this.pageIndex,rect:Q,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};C=new WeakMap,m=new WeakMap,I=new WeakMap,O=new WeakMap,x=new WeakMap,E=new WeakMap,v=new WeakMap,f=new WeakMap,_=new WeakMap,P=new WeakMap,w=new WeakMap,A=new WeakMap,l=new WeakMap,d=new WeakMap,M=new WeakSet,jn=function(Q){const Tt=this.thickness;this.addCommands({cmd:()=>{this.thickness=Q,q(this,K,ge).call(this)},undo:()=>{this.thickness=Tt,q(this,K,ge).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},c=new WeakSet,Un=function(Q){const Tt=this.color;this.addCommands({cmd:()=>{this.color=Q,q(this,U,oe).call(this)},undo:()=>{this.color=Tt,q(this,U,oe).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},g=new WeakSet,Hn=function(Q){Q/=100;const Tt=this.opacity;this.addCommands({cmd:()=>{this.opacity=Q,q(this,U,oe).call(this)},undo:()=>{this.opacity=Tt,q(this,U,oe).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},z=new WeakSet,Wn=function(){const{parentRotation:Q,parentDimensions:[Tt,Nt]}=this;switch(Q){case 90:return[0,Nt,Nt,Tt];case 180:return[Tt,Nt,Tt,Nt];case 270:return[Tt,0,Nt,Tt];default:return[0,0,Tt,Nt]}},Y=new WeakSet,un=function(){const{ctx:Q,color:Tt,opacity:Nt,thickness:xt,parentScale:Bt,scaleFactor:jt}=this;Q.lineWidth=xt*Bt/jt,Q.lineCap="round",Q.lineJoin="round",Q.miterLimit=10,Q.strokeStyle=`${Tt}${(0,dt.opacityToHex)(Nt)}`},lt=new WeakSet,Gn=function(Q,Tt){this.canvas.addEventListener("contextmenu",W.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,O)),this.canvas.addEventListener("pointermove",t(this,I)),this.canvas.addEventListener("pointerup",t(this,x)),this.canvas.removeEventListener("pointerdown",t(this,E)),this.isEditing=!0,t(this,P)||(rt(this,P,!0),q(this,It,pe).call(this),this.thickness||(this.thickness=vt._defaultThickness),this.color||(this.color=vt._defaultColor||p.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=vt._defaultOpacity)),this.currentPath.push([Q,Tt]),rt(this,_,!1),q(this,Y,un).call(this),rt(this,d,()=>{q(this,o,zn).call(this),t(this,d)&&window.requestAnimationFrame(t(this,d))}),window.requestAnimationFrame(t(this,d))},ht=new WeakSet,fn=function(Q,Tt){const[Nt,xt]=this.currentPath.at(-1);if(this.currentPath.length>1&&Q===Nt&&Tt===xt)return;const Bt=this.currentPath;let jt=t(this,v);if(Bt.push([Q,Tt]),rt(this,_,!0),Bt.length<=2){jt.moveTo(...Bt[0]),jt.lineTo(Q,Tt);return}Bt.length===3&&(rt(this,v,jt=new Path2D),jt.moveTo(...Bt[0])),q(this,h,Xn).call(this,jt,...Bt.at(-3),...Bt.at(-2),Q,Tt)},St=new WeakSet,$n=function(){if(this.currentPath.length===0)return;const Q=this.currentPath.at(-1);t(this,v).lineTo(...Q)},R=new WeakSet,Vn=function(Q,Tt){rt(this,d,null),Q=Math.min(Math.max(Q,0),this.canvas.width),Tt=Math.min(Math.max(Tt,0),this.canvas.height),q(this,ht,fn).call(this,Q,Tt),q(this,St,$n).call(this);let Nt;if(this.currentPath.length!==1)Nt=q(this,S,qn).call(this);else{const At=[Q,Tt];Nt=[[At,At.slice(),At.slice(),At]]}const xt=t(this,v),Bt=this.currentPath;this.currentPath=[],rt(this,v,new Path2D);const jt=()=>{this.allRawPaths.push(Bt),this.paths.push(Nt),this.bezierPath2D.push(xt),this.rebuild()},Qt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(q(this,ut,Me).call(this),q(this,ct,De).call(this)),q(this,K,ge).call(this))};this.addCommands({cmd:jt,undo:Qt,mustExec:!0})},o=new WeakSet,zn=function(){if(!t(this,_))return;rt(this,_,!1);const Q=Math.ceil(this.thickness*this.parentScale),Tt=this.currentPath.slice(-3),Nt=Tt.map(jt=>jt[0]),xt=Tt.map(jt=>jt[1]);Math.min(...Nt)-Q,Math.max(...Nt)+Q,Math.min(...xt)-Q,Math.max(...xt)+Q;const{ctx:Bt}=this;Bt.save(),Bt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const jt of this.bezierPath2D)Bt.stroke(jt);Bt.stroke(t(this,v)),Bt.restore()},h=new WeakSet,Xn=function(Q,Tt,Nt,xt,Bt,jt,Qt){const At=(Tt+xt)/2,Kt=(Nt+Bt)/2,Ot=(xt+jt)/2,N=(Bt+Qt)/2;Q.bezierCurveTo(At+2*(xt-At)/3,Kt+2*(Bt-Kt)/3,Ot+2*(xt-Ot)/3,N+2*(Bt-N)/3,Ot,N)},S=new WeakSet,qn=function(){const Q=this.currentPath;if(Q.length<=2)return[[Q[0],Q[0],Q.at(-1),Q.at(-1)]];const Tt=[];let Nt,[xt,Bt]=Q[0];for(Nt=1;Nt<Q.length-2;Nt++){const[e,y]=Q[Nt],[B,X]=Q[Nt+1],J=(e+B)/2,ot=(y+X)/2,yt=[xt+2*(e-xt)/3,Bt+2*(y-Bt)/3],Ft=[J+2*(e-J)/3,ot+2*(y-ot)/3];Tt.push([[xt,Bt],yt,Ft,[J,ot]]),[xt,Bt]=[J,ot]}const[jt,Qt]=Q[Nt],[At,Kt]=Q[Nt+1],Ot=[xt+2*(jt-xt)/3,Bt+2*(Qt-Bt)/3],N=[At+2*(jt-At)/3,Kt+2*(Qt-Kt)/3];return Tt.push([[xt,Bt],Ot,N,[At,Kt]]),Tt},U=new WeakSet,oe=function(){if(this.isEmpty()){q(this,et,Le).call(this);return}q(this,Y,un).call(this);const{canvas:Q,ctx:Tt}=this;Tt.setTransform(1,0,0,1,0,0),Tt.clearRect(0,0,Q.width,Q.height),q(this,et,Le).call(this);for(const Nt of this.bezierPath2D)Tt.stroke(Nt)},tt=new WeakSet,pn=function(Q){this.canvas.removeEventListener("pointerleave",t(this,O)),this.canvas.removeEventListener("pointermove",t(this,I)),this.canvas.removeEventListener("pointerup",t(this,x)),this.canvas.addEventListener("pointerdown",t(this,E)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",W.noContextMenu)},10),q(this,R,Vn).call(this,Q.offsetX,Q.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ut=new WeakSet,Me=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",p.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Q=>{var Tt;return(Tt=this.canvas)==null?void 0:Tt.setAttribute("aria-label",Q)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},ct=new WeakSet,De=function(){rt(this,w,new ResizeObserver(Q=>{const Tt=Q[0].contentRect;Tt.width&&Tt.height&&this.setDimensions(Tt.width,Tt.height)})),t(this,w).observe(this.div)},It=new WeakSet,pe=function(){if(!t(this,P))return;const[Q,Tt]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Q),this.canvas.height=Math.ceil(this.height*Tt),q(this,et,Le).call(this)},Lt=new WeakSet,gn=function(Q,Tt){const Nt=q(this,ft,Ie).call(this),xt=(Q-Nt)/t(this,m),Bt=(Tt-Nt)/t(this,C);this.scaleFactor=Math.min(xt,Bt)},et=new WeakSet,Le=function(){const Q=q(this,ft,Ie).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Q,this.translationY*this.scaleFactor+Q)},pt=new WeakSet,Yn=function(Q){const Tt=new Path2D;for(let Nt=0,xt=Q.length;Nt<xt;Nt++){const[Bt,jt,Qt,At]=Q[Nt];Nt===0&&Tt.moveTo(...Bt),Tt.bezierCurveTo(jt[0],jt[1],Qt[0],Qt[1],At[0],At[1])}return Tt},Ct=new WeakSet,mn=function(Q,Tt,Nt){const[xt,Bt,jt,Qt]=Tt;switch(Nt){case 0:for(let At=0,Kt=Q.length;At<Kt;At+=2)Q[At]+=xt,Q[At+1]=Qt-Q[At+1];break;case 90:for(let At=0,Kt=Q.length;At<Kt;At+=2){const Ot=Q[At];Q[At]=Q[At+1]+xt,Q[At+1]=Ot+Bt}break;case 180:for(let At=0,Kt=Q.length;At<Kt;At+=2)Q[At]=jt-Q[At],Q[At+1]+=Bt;break;case 270:for(let At=0,Kt=Q.length;At<Kt;At+=2){const Ot=Q[At];Q[At]=jt-Q[At+1],Q[At+1]=Qt-Ot}break;default:throw new Error("Invalid rotation")}return Q},Vt=new WeakSet,Kn=function(Q,Tt,Nt){const[xt,Bt,jt,Qt]=Tt;switch(Nt){case 0:for(let At=0,Kt=Q.length;At<Kt;At+=2)Q[At]-=xt,Q[At+1]=Qt-Q[At+1];break;case 90:for(let At=0,Kt=Q.length;At<Kt;At+=2){const Ot=Q[At];Q[At]=Q[At+1]-Bt,Q[At+1]=Ot-xt}break;case 180:for(let At=0,Kt=Q.length;At<Kt;At+=2)Q[At]=jt-Q[At],Q[At+1]-=Bt;break;case 270:for(let At=0,Kt=Q.length;At<Kt;At+=2){const Ot=Q[At];Q[At]=Qt-Q[At+1],Q[At+1]=jt-Ot}break;default:throw new Error("Invalid rotation")}return Q},zt=new WeakSet,Jn=function(Q,Tt,Nt,xt){var Kt,Ot;const Bt=[],jt=this.thickness/2,Qt=Q*Tt+jt,At=Q*Nt+jt;for(const N of this.paths){const e=[],y=[];for(let B=0,X=N.length;B<X;B++){const[J,ot,yt,Ft]=N[B],kt=Q*J[0]+Qt,qt=Q*J[1]+At,Mt=Q*ot[0]+Qt,Dt=Q*ot[1]+At,Gt=Q*yt[0]+Qt,Yt=Q*yt[1]+At,Jt=Q*Ft[0]+Qt,Zt=Q*Ft[1]+At;B===0&&(e.push(kt,qt),y.push(kt,qt)),e.push(Mt,Dt,Gt,Yt,Jt,Zt),y.push(Mt,Dt),B===X-1&&y.push(Jt,Zt)}Bt.push({bezier:q(Kt=vt,Ct,mn).call(Kt,e,xt,this.rotation),points:q(Ot=vt,Ct,mn).call(Ot,y,xt,this.rotation)})}return Bt},Wt=new WeakSet,bn=function(){let Q=1/0,Tt=-1/0,Nt=1/0,xt=-1/0;for(const Bt of this.paths)for(const[jt,Qt,At,Kt]of Bt){const Ot=i.Util.bezierBoundingBox(...jt,...Qt,...At,...Kt);Q=Math.min(Q,Ot[0]),Nt=Math.min(Nt,Ot[1]),Tt=Math.max(Tt,Ot[2]),xt=Math.max(xt,Ot[3])}return[Q,Nt,Tt,xt]},ft=new WeakSet,Ie=function(){return t(this,f)?Math.ceil(this.thickness*this.parentScale):0},K=new WeakSet,ge=function(Q=!1){if(this.isEmpty())return;if(!t(this,f)){q(this,U,oe).call(this);return}const Tt=q(this,Wt,bn).call(this),Nt=q(this,ft,Ie).call(this);rt(this,m,Math.max(p.AnnotationEditor.MIN_SIZE,Tt[2]-Tt[0])),rt(this,C,Math.max(p.AnnotationEditor.MIN_SIZE,Tt[3]-Tt[1]));const xt=Math.ceil(Nt+t(this,m)*this.scaleFactor),Bt=Math.ceil(Nt+t(this,C)*this.scaleFactor),[jt,Qt]=this.parentDimensions;this.width=xt/jt,this.height=Bt/Qt,this.setAspectRatio(xt,Bt);const At=this.translationX,Kt=this.translationY;this.translationX=-Tt[0],this.translationY=-Tt[1],q(this,It,pe).call(this),q(this,U,oe).call(this),rt(this,A,xt),rt(this,l,Bt),this.setDims(xt,Bt);const Ot=Q?Nt/this.scaleFactor/2:0;this.translate(At-this.translationX-Ot,Kt-this.translationY-Ot)},H(vt,pt),H(vt,Ct),H(vt,Vt),ne(vt,"_defaultColor",null),ne(vt,"_defaultOpacity",1),ne(vt,"_defaultThickness",1),ne(vt,"_type","ink");let F=vt;a.InkEditor=F},(D,a,j)=>{var F,C,m,I,O,x,E,v,f,_,P,Ee,A,Se,d,Oe,b,yn,k,Qn,G,Zn,T,_n,it,Ne,$,ts;Object.defineProperty(a,"__esModule",{value:!0}),a.StampEditor=void 0;var i=j(1),p=j(4),V=j(6),W=j(29);const bt=class bt extends p.AnnotationEditor{constructor(R){super({...R,name:"stampEditor"});H(this,P);H(this,A);H(this,d);H(this,b);H(this,k);H(this,G);H(this,T);H(this,it);H(this,$);H(this,F,null);H(this,C,null);H(this,m,null);H(this,I,null);H(this,O,null);H(this,x,null);H(this,E,null);H(this,v,null);H(this,f,!1);H(this,_,!1);rt(this,I,R.bitmapUrl),rt(this,O,R.bitmapFile)}static initialize(R){p.AnnotationEditor.initialize(R)}static get supportedTypes(){const R=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,i.shadow)(this,"supportedTypes",R.map(n=>`image/${n}`))}static get supportedTypesStr(){return(0,i.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(R){return this.supportedTypes.includes(R)}static paste(R,n){n.pasteEditor(i.AnnotationEditorType.STAMP,{bitmapFile:R.getAsFile()})}remove(){var R,n;t(this,C)&&(rt(this,F,null),this._uiManager.imageManager.deleteId(t(this,C)),(R=t(this,x))==null||R.remove(),rt(this,x,null),(n=t(this,E))==null||n.disconnect(),rt(this,E,null)),super.remove()}rebuild(){if(!this.parent){t(this,C)&&q(this,d,Oe).call(this);return}super.rebuild(),this.div!==null&&(t(this,C)&&q(this,d,Oe).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,m)||t(this,F)||t(this,I)||t(this,O))}get isResizable(){return!0}render(){if(this.div)return this.div;let R,n;if(this.width&&(R=this.x,n=this.y),super.render(),this.div.hidden=!0,t(this,F)?q(this,b,yn).call(this):q(this,d,Oe).call(this),this.width){const[o,s]=this.parentDimensions;this.setAt(R*o,n*s,this.width*o,this.height*s)}return this.div}static deserialize(R,n,o){if(R instanceof W.StampAnnotationElement)return null;const s=super.deserialize(R,n,o),{rect:h,bitmapUrl:u,bitmapId:S,isSvg:L,accessibilityData:U}=R;S&&o.imageManager.isValidId(S)?rt(s,C,S):rt(s,I,u),rt(s,f,L);const[st,tt]=s.pageDimensions;return s.width=(h[2]-h[0])/st,s.height=(h[3]-h[1])/tt,U&&(s.altTextData=U),s}serialize(R=!1,n=null){if(this.isEmpty())return null;const o={annotationType:i.AnnotationEditorType.STAMP,bitmapId:t(this,C),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,f),structTreeParentId:this._structTreeParentId};if(R)return o.bitmapUrl=q(this,it,Ne).call(this,!0),o.accessibilityData=this.altTextData,o;const{decorative:s,altText:h}=this.altTextData;if(!s&&h&&(o.accessibilityData={type:"Figure",alt:h}),n===null)return o;n.stamps||(n.stamps=new Map);const u=t(this,f)?(o.rect[2]-o.rect[0])*(o.rect[3]-o.rect[1]):null;if(!n.stamps.has(t(this,C)))n.stamps.set(t(this,C),{area:u,serialized:o}),o.bitmap=q(this,it,Ne).call(this,!1);else if(t(this,f)){const S=n.stamps.get(t(this,C));u>S.area&&(S.area=u,S.serialized.bitmap.close(),S.serialized.bitmap=q(this,it,Ne).call(this,!1))}return o}};F=new WeakMap,C=new WeakMap,m=new WeakMap,I=new WeakMap,O=new WeakMap,x=new WeakMap,E=new WeakMap,v=new WeakMap,f=new WeakMap,_=new WeakMap,P=new WeakSet,Ee=function(R,n=!1){if(!R){this.remove();return}rt(this,F,R.bitmap),n||(rt(this,C,R.id),rt(this,f,R.isSvg)),q(this,b,yn).call(this)},A=new WeakSet,Se=function(){rt(this,m,null),this._uiManager.enableWaiting(!1),t(this,x)&&this.div.focus()},d=new WeakSet,Oe=function(){if(t(this,C)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,C)).then(n=>q(this,P,Ee).call(this,n,!0)).finally(()=>q(this,A,Se).call(this));return}if(t(this,I)){const n=t(this,I);rt(this,I,null),this._uiManager.enableWaiting(!0),rt(this,m,this._uiManager.imageManager.getFromUrl(n).then(o=>q(this,P,Ee).call(this,o)).finally(()=>q(this,A,Se).call(this)));return}if(t(this,O)){const n=t(this,O);rt(this,O,null),this._uiManager.enableWaiting(!0),rt(this,m,this._uiManager.imageManager.getFromFile(n).then(o=>q(this,P,Ee).call(this,o)).finally(()=>q(this,A,Se).call(this)));return}const R=document.createElement("input");R.type="file",R.accept=bt.supportedTypesStr,rt(this,m,new Promise(n=>{R.addEventListener("change",async()=>{if(!R.files||R.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const o=await this._uiManager.imageManager.getFromFile(R.files[0]);q(this,P,Ee).call(this,o)}n()}),R.addEventListener("cancel",()=>{this.remove(),n()})}).finally(()=>q(this,A,Se).call(this))),R.click()},b=new WeakSet,yn=function(){const{div:R}=this;let{width:n,height:o}=t(this,F);const[s,h]=this.pageDimensions,u=.75;if(this.width)n=this.width*s,o=this.height*h;else if(n>u*s||o>u*h){const st=Math.min(u*s/n,u*h/o);n*=st,o*=st}const[S,L]=this.parentDimensions;this.setDims(n*S/s,o*L/h),this._uiManager.enableWaiting(!1);const U=rt(this,x,document.createElement("canvas"));R.append(U),R.hidden=!1,q(this,T,_n).call(this,n,o),q(this,$,ts).call(this),t(this,_)||(this.parent.addUndoableEditor(this),rt(this,_,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},k=new WeakSet,Qn=function(R,n){var u;const[o,s]=this.parentDimensions;this.width=R/o,this.height=n/s,this.setDims(R,n),(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,v)!==null&&clearTimeout(t(this,v)),rt(this,v,setTimeout(()=>{rt(this,v,null),q(this,T,_n).call(this,R,n)},200))},G=new WeakSet,Zn=function(R,n){const{width:o,height:s}=t(this,F);let h=o,u=s,S=t(this,F);for(;h>2*R||u>2*n;){const L=h,U=u;h>2*R&&(h=h>=16384?Math.floor(h/2)-1:Math.ceil(h/2)),u>2*n&&(u=u>=16384?Math.floor(u/2)-1:Math.ceil(u/2));const st=new OffscreenCanvas(h,u);st.getContext("2d").drawImage(S,0,0,L,U,0,0,h,u),S=st.transferToImageBitmap()}return S},T=new WeakSet,_n=function(R,n){R=Math.ceil(R),n=Math.ceil(n);const o=t(this,x);if(!o||o.width===R&&o.height===n)return;o.width=R,o.height=n;const s=t(this,f)?t(this,F):q(this,G,Zn).call(this,R,n),h=o.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(s,0,0,s.width,s.height,0,0,R,n)},it=new WeakSet,Ne=function(R){if(R){if(t(this,f)){const s=this._uiManager.imageManager.getSvgUrl(t(this,C));if(s)return s}const n=document.createElement("canvas");return{width:n.width,height:n.height}=t(this,F),n.getContext("2d").drawImage(t(this,F),0,0),n.toDataURL()}if(t(this,f)){const[n,o]=this.pageDimensions,s=Math.round(this.width*n*V.PixelsPerInch.PDF_TO_CSS_UNITS),h=Math.round(this.height*o*V.PixelsPerInch.PDF_TO_CSS_UNITS),u=new OffscreenCanvas(s,h);return u.getContext("2d").drawImage(t(this,F),0,0,t(this,F).width,t(this,F).height,0,0,s,h),u.transferToImageBitmap()}return structuredClone(t(this,F))},$=new WeakSet,ts=function(){rt(this,E,new ResizeObserver(R=>{const n=R[0].contentRect;n.width&&n.height&&q(this,k,Qn).call(this,n.width,n.height)})),t(this,E).observe(this.div)},ne(bt,"_type","stamp");let dt=bt;a.StampEditor=dt}],__webpack_module_cache__={};function __w_pdfjs_require__(D){var a=__webpack_module_cache__[D];if(a!==void 0)return a.exports;var j=__webpack_module_cache__[D]={exports:{}};return __webpack_modules__[D](j,j.exports,__w_pdfjs_require__),j.exports}var __webpack_exports__={};return(()=>{var D=__webpack_exports__;Object.defineProperty(D,"__esModule",{value:!0}),Object.defineProperty(D,"AbortException",{enumerable:!0,get:function(){return a.AbortException}}),Object.defineProperty(D,"AnnotationEditorLayer",{enumerable:!0,get:function(){return V.AnnotationEditorLayer}}),Object.defineProperty(D,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return a.AnnotationEditorParamsType}}),Object.defineProperty(D,"AnnotationEditorType",{enumerable:!0,get:function(){return a.AnnotationEditorType}}),Object.defineProperty(D,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return W.AnnotationEditorUIManager}}),Object.defineProperty(D,"AnnotationLayer",{enumerable:!0,get:function(){return dt.AnnotationLayer}}),Object.defineProperty(D,"AnnotationMode",{enumerable:!0,get:function(){return a.AnnotationMode}}),Object.defineProperty(D,"CMapCompressionType",{enumerable:!0,get:function(){return a.CMapCompressionType}}),Object.defineProperty(D,"DOMSVGFactory",{enumerable:!0,get:function(){return i.DOMSVGFactory}}),Object.defineProperty(D,"FeatureTest",{enumerable:!0,get:function(){return a.FeatureTest}}),Object.defineProperty(D,"GlobalWorkerOptions",{enumerable:!0,get:function(){return F.GlobalWorkerOptions}}),Object.defineProperty(D,"ImageKind",{enumerable:!0,get:function(){return a.ImageKind}}),Object.defineProperty(D,"InvalidPDFException",{enumerable:!0,get:function(){return a.InvalidPDFException}}),Object.defineProperty(D,"MissingPDFException",{enumerable:!0,get:function(){return a.MissingPDFException}}),Object.defineProperty(D,"OPS",{enumerable:!0,get:function(){return a.OPS}}),Object.defineProperty(D,"PDFDataRangeTransport",{enumerable:!0,get:function(){return j.PDFDataRangeTransport}}),Object.defineProperty(D,"PDFDateString",{enumerable:!0,get:function(){return i.PDFDateString}}),Object.defineProperty(D,"PDFWorker",{enumerable:!0,get:function(){return j.PDFWorker}}),Object.defineProperty(D,"PasswordResponses",{enumerable:!0,get:function(){return a.PasswordResponses}}),Object.defineProperty(D,"PermissionFlag",{enumerable:!0,get:function(){return a.PermissionFlag}}),Object.defineProperty(D,"PixelsPerInch",{enumerable:!0,get:function(){return i.PixelsPerInch}}),Object.defineProperty(D,"PromiseCapability",{enumerable:!0,get:function(){return a.PromiseCapability}}),Object.defineProperty(D,"RenderingCancelledException",{enumerable:!0,get:function(){return i.RenderingCancelledException}}),Object.defineProperty(D,"SVGGraphics",{enumerable:!0,get:function(){return j.SVGGraphics}}),Object.defineProperty(D,"UnexpectedResponseException",{enumerable:!0,get:function(){return a.UnexpectedResponseException}}),Object.defineProperty(D,"Util",{enumerable:!0,get:function(){return a.Util}}),Object.defineProperty(D,"VerbosityLevel",{enumerable:!0,get:function(){return a.VerbosityLevel}}),Object.defineProperty(D,"XfaLayer",{enumerable:!0,get:function(){return C.XfaLayer}}),Object.defineProperty(D,"build",{enumerable:!0,get:function(){return j.build}}),Object.defineProperty(D,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return a.createValidAbsoluteUrl}}),Object.defineProperty(D,"getDocument",{enumerable:!0,get:function(){return j.getDocument}}),Object.defineProperty(D,"getFilenameFromUrl",{enumerable:!0,get:function(){return i.getFilenameFromUrl}}),Object.defineProperty(D,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return i.getPdfFilenameFromUrl}}),Object.defineProperty(D,"getXfaPageViewport",{enumerable:!0,get:function(){return i.getXfaPageViewport}}),Object.defineProperty(D,"isDataScheme",{enumerable:!0,get:function(){return i.isDataScheme}}),Object.defineProperty(D,"isPdfFile",{enumerable:!0,get:function(){return i.isPdfFile}}),Object.defineProperty(D,"loadScript",{enumerable:!0,get:function(){return i.loadScript}}),Object.defineProperty(D,"noContextMenu",{enumerable:!0,get:function(){return i.noContextMenu}}),Object.defineProperty(D,"normalizeUnicode",{enumerable:!0,get:function(){return a.normalizeUnicode}}),Object.defineProperty(D,"renderTextLayer",{enumerable:!0,get:function(){return p.renderTextLayer}}),Object.defineProperty(D,"setLayerDimensions",{enumerable:!0,get:function(){return i.setLayerDimensions}}),Object.defineProperty(D,"shadow",{enumerable:!0,get:function(){return a.shadow}}),Object.defineProperty(D,"updateTextLayer",{enumerable:!0,get:function(){return p.updateTextLayer}}),Object.defineProperty(D,"version",{enumerable:!0,get:function(){return j.version}});var a=__w_pdfjs_require__(1),j=__w_pdfjs_require__(2),i=__w_pdfjs_require__(6),p=__w_pdfjs_require__(26),V=__w_pdfjs_require__(27),W=__w_pdfjs_require__(5),dt=__w_pdfjs_require__(29),F=__w_pdfjs_require__(14),C=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule;var __spreadArray=function(D,a,j){if(j||arguments.length===2)for(var i=0,p=a.length,V;i<p;i++)(V||!(i in a))&&(V||(V=Array.prototype.slice.call(a,0,i)),V[i]=a[i]);return D.concat(V||Array.prototype.slice.call(a))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(D,a){var j={};return allEvents.forEach(function(i){var p=D[i];p&&(a?j[i]=function(V){return p(V,a(i))}:j[i]=p)}),j}function makeCancellablePromise(D){var a=!1,j=new Promise(function(i,p){D.then(function(V){return!a&&i(V)}).catch(function(V){return!a&&p(V)})});return{promise:j,cancel:function(){a=!0}}}function r(D){var a,j,i="";if(typeof D=="string"||typeof D=="number")i+=D;else if(typeof D=="object")if(Array.isArray(D)){var p=D.length;for(a=0;a<p;a++)D[a]&&(j=r(D[a]))&&(i&&(i+=" "),i+=j)}else for(j in D)D[j]&&(i&&(i+=" "),i+=j);return i}function clsx(){for(var D,a,j=0,i="",p=arguments.length;j<p;j++)(D=arguments[j])&&(a=r(D))&&(i&&(i+=" "),i+=a);return i}var distExports=requireDist();const DocumentContext=reactExports.createContext(null);function Message({children:D,type:a}){return React.createElement("div",{className:`react-pdf__message react-pdf__message--${a}`},D)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(a){this.pdfDocument=a}setViewer(a){this.pdfViewer=a}setExternalLinkRel(a){this.externalLinkRel=a}setExternalLinkTarget(a){this.externalLinkTarget=a}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(a){invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=a}get rotation(){return 0}set rotation(a){}goToDestination(a){return new Promise(j=>{invariant(this.pdfDocument,"PDF document not loaded."),invariant(a,"Destination is not specified."),typeof a=="string"?this.pdfDocument.getDestination(a).then(j):Array.isArray(a)?j(a):a.then(j)}).then(j=>{invariant(Array.isArray(j),`"${j}" is not a valid destination array.`);const i=j[0];new Promise(p=>{invariant(this.pdfDocument,"PDF document not loaded."),i instanceof Object?this.pdfDocument.getPageIndex(i).then(V=>{p(V)}).catch(()=>{invariant(!1,`"${i}" is not a valid page reference.`)}):typeof i=="number"?p(i):invariant(!1,`"${i}" is not a valid destination reference.`)}).then(p=>{const V=p+1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(V>=1&&V<=this.pagesCount,`"${V}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:j,pageIndex:p,pageNumber:V})})})}navigateTo(a){this.goToDestination(a)}goToPage(a){const j=a-1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(a>=1&&a<=this.pagesCount,`"${a}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:j,pageNumber:a})}addLinkAttributes(a,j,i){a.href=j,a.rel=this.externalLinkRel||DEFAULT_LINK_REL,a.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(D){return typeof D<"u"}function isProvided(D){return isDefined(D)&&D!==null}function isString(D){return typeof D=="string"}function isArrayBuffer(D){return D instanceof ArrayBuffer}function isBlob(D){return invariant(isBrowser,"isBlob can only be used in a browser environment"),D instanceof Blob}function isDataURI(D){return isString(D)&&/^data:/.test(D)}function dataURItoByteString(D){invariant(isDataURI(D),"Invalid data URI.");const[a="",j=""]=D.split(",");return a.split(";").indexOf("base64")!==-1?atob(j):unescape(j)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning$1(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning$1(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(D){D&&D.cancel&&D.cancel()}function makePageCallback(D,a){return Object.defineProperty(D,"width",{get(){return this.view[2]*a},configurable:!0}),Object.defineProperty(D,"height",{get(){return this.view[3]*a},configurable:!0}),Object.defineProperty(D,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(D,"originalHeight",{get(){return this.view[3]},configurable:!0}),D}function isCancelException(D){return D.name==="RenderingCancelledException"}function loadFromFile(D){return new Promise((a,j)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return j(new Error("Error while reading a file."));a(i.result)},i.onerror=p=>{if(!p.target)return j(new Error("Error while reading a file."));const{error:V}=p.target;if(!V)return j(new Error("Error while reading a file."));switch(V.code){case V.NOT_FOUND_ERR:return j(new Error("Error while reading a file: File not found."));case V.SECURITY_ERR:return j(new Error("Error while reading a file: Security error."));case V.ABORT_ERR:return j(new Error("Error while reading a file: Aborted."));default:return j(new Error("Error while reading a file."))}},i.readAsArrayBuffer(D)})}function reducer(D,a){switch(a.type){case"RESOLVE":return{value:a.value,error:void 0};case"REJECT":return{value:!1,error:a.error};case"RESET":return{value:void 0,error:void 0};default:return D}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs,eventProps=(()=>{const D={};return allEvents.forEach(a=>{D[a]=PropTypes.func}),D})(),isTypedArray=PropTypes.oneOfType([PropTypes.instanceOf(Int8Array),PropTypes.instanceOf(Uint8Array),PropTypes.instanceOf(Uint8ClampedArray),PropTypes.instanceOf(Int16Array),PropTypes.instanceOf(Uint16Array),PropTypes.instanceOf(Int32Array),PropTypes.instanceOf(Uint32Array),PropTypes.instanceOf(Float32Array),PropTypes.instanceOf(Float64Array)]),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.arrayOf(PropTypes.number.isRequired),isTypedArray]).isRequired}),PropTypes.shape({range:PropTypes.instanceOf(PDFDataRangeTransport$1).isRequired}),PropTypes.shape({url:PropTypes.string.isRequired})];typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));const isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes);PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired});const isPageIndex=function D(a,j,i){const{[j]:p,pageNumber:V,pdf:W}=a;if(!isDefined(W))return null;if(isDefined(p)){if(typeof p!="number")return new Error(`\`${j}\` of type \`${typeof p}\` supplied to \`${i}\`, expected \`number\`.`);if(p<0)return new Error(`Expected \`${j}\` to be greater or equal to 0.`);const{numPages:dt}=W;if(p+1>dt)return new Error(`Expected \`${j}\` to be less or equal to ${dt-1}.`)}else if(!isDefined(V))return new Error(`\`${j}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${i}\`.`);return null},isPageNumber=function D(a,j,i){const{[j]:p,pageIndex:V,pdf:W}=a;if(!isDefined(W))return null;if(isDefined(p)){if(typeof p!="number")return new Error(`\`${j}\` of type \`${typeof p}\` supplied to \`${i}\`, expected \`number\`.`);if(p<1)return new Error(`Expected \`${j}\` to be greater or equal to 1.`);const{numPages:dt}=W;if(p>dt)return new Error(`Expected \`${j}\` to be less or equal to ${dt}.`)}else if(!isDefined(V))return new Error(`\`${j}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${i}\`.`);return null},isPdf=PropTypes.oneOfType([PropTypes.any,PropTypes.oneOf([!1])]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.exact({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","custom","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]);var __awaiter=function(D,a,j,i){function p(V){return V instanceof j?V:new j(function(W){W(V)})}return new(j||(j=Promise))(function(V,W){function dt(m){try{C(i.next(m))}catch(I){W(I)}}function F(m){try{C(i.throw(m))}catch(I){W(I)}}function C(m){m.done?V(m.value):p(m.value).then(dt,F)}C((i=i.apply(D,a||[])).next())})},__rest$1=function(D,a){var j={};for(var i in D)Object.prototype.hasOwnProperty.call(D,i)&&a.indexOf(i)<0&&(j[i]=D[i]);if(D!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,i=Object.getOwnPropertySymbols(D);p<i.length;p++)a.indexOf(i[p])<0&&Object.prototype.propertyIsEnumerable.call(D,i[p])&&(j[i[p]]=D[i[p]]);return j};const{PDFDataRangeTransport}=pdfjs,defaultOnPassword=(D,a)=>{switch(a){case PasswordResponses.NEED_PASSWORD:{const j=prompt("Enter the password to open this PDF file.");D(j);break}case PasswordResponses.INCORRECT_PASSWORD:{const j=prompt("Invalid password. Please try again.");D(j);break}}};function isParameterObject(D){return typeof D=="object"&&D!==null&&("data"in D||"range"in D||"url"in D)}const Document=reactExports.forwardRef(function D(a,j){var{children:i,className:p,error:V="Failed to load PDF file.",externalLinkRel:W,externalLinkTarget:dt,file:F,inputRef:C,imageResourcesPath:m,loading:I="Loading PDF…",noData:O="No PDF file specified.",onItemClick:x,onLoadError:E,onLoadProgress:v,onLoadSuccess:f,onPassword:_=defaultOnPassword,onSourceError:P,onSourceSuccess:w,options:A,renderMode:l,rotate:d}=a,M=__rest$1(a,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[b,c]=useResolver(),{value:k,error:g}=b,[G,z]=useResolver(),{value:T,error:Y}=G,it=reactExports.useRef(new LinkService),lt=reactExports.useRef([]),$=reactExports.useRef(),ht=reactExports.useRef();reactExports.useEffect(()=>{F&&F!==$.current&&isParameterObject(F)&&(warning$1(!distExports.dequal(F,$.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),$.current=F)},[F]),reactExports.useEffect(()=>{A&&A!==ht.current&&(warning$1(!distExports.dequal(A,ht.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),ht.current=A)},[A]);const bt=reactExports.useRef({scrollPageIntoView:gt=>{const{dest:ct,pageNumber:Rt,pageIndex:It=Rt-1}=gt;if(x){x({dest:ct,pageIndex:It,pageNumber:Rt});return}const Et=lt.current[It];if(Et){Et.scrollIntoView();return}warning$1(!1,`An internal link leading to page ${Rt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(j,()=>({linkService:it,pages:lt,viewer:bt}),[]);function St(){w&&w()}function wt(){g&&(warning$1(!1,g.toString()),P&&P(g))}function R(){c({type:"RESET"})}reactExports.useEffect(R,[F,c]);const n=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!F)return null;if(typeof F=="string")return isDataURI(F)?{data:dataURItoByteString(F)}:(displayCORSWarning(),{url:F});if(F instanceof PDFDataRangeTransport)return{range:F};if(isArrayBuffer(F))return{data:F};if(isBrowser&&isBlob(F))return{data:yield loadFromFile(F)};if(invariant(typeof F=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),invariant(isParameterObject(F),"Invalid parameter object: need either .data, .range or .url"),"url"in F&&typeof F.url=="string"){if(isDataURI(F.url)){const{url:gt}=F,ct=__rest$1(F,["url"]),Rt=dataURItoByteString(gt);return Object.assign({data:Rt},ct)}displayCORSWarning()}return F}),[F]);reactExports.useEffect(()=>{const gt=makeCancellablePromise(n());return gt.promise.then(ct=>{c({type:"RESOLVE",value:ct})}).catch(ct=>{c({type:"REJECT",error:ct})}),()=>{cancelRunningTask(gt)}},[n,c]),reactExports.useEffect(()=>{if(!(typeof k>"u")){if(k===!1){wt();return}St()}},[k]);function o(){T&&(f&&f(T),lt.current=new Array(T.numPages),it.current.setDocument(T))}function s(){Y&&(warning$1(!1,Y.toString()),E&&E(Y))}function h(){z({type:"RESET"})}reactExports.useEffect(h,[z,k]);function u(){if(!k)return;const gt=A?Object.assign(Object.assign({},k),A):k,ct=pdfjs.getDocument(gt);v&&(ct.onProgress=v),_&&(ct.onPassword=_);const Rt=ct;return Rt.promise.then(It=>{z({type:"RESOLVE",value:It})}).catch(It=>{Rt.destroyed||z({type:"REJECT",error:It})}),()=>{Rt.destroy()}}reactExports.useEffect(u,[A,z,k]),reactExports.useEffect(()=>{if(!(typeof T>"u")){if(T===!1){s();return}o()}},[T]);function S(){it.current.setViewer(bt.current),it.current.setExternalLinkRel(W),it.current.setExternalLinkTarget(dt)}reactExports.useEffect(S,[W,dt]);function L(gt,ct){lt.current[gt]=ct}function U(gt){delete lt.current[gt]}const st=reactExports.useMemo(()=>({imageResourcesPath:m,linkService:it.current,onItemClick:x,pdf:T,registerPage:L,renderMode:l,rotate:d,unregisterPage:U}),[m,x,T,l,d]),tt=reactExports.useMemo(()=>makeEventProps(M,()=>T),[M,T]);function at(){return React.createElement(DocumentContext.Provider,{value:st},i)}function ut(){return F?T==null?React.createElement(Message,{type:"loading"},typeof I=="function"?I():I):T===!1?React.createElement(Message,{type:"error"},typeof V=="function"?V():V):at():React.createElement(Message,{type:"no-data"},typeof O=="function"?O():O)}return React.createElement("div",Object.assign({className:clsx("react-pdf__Document",p),ref:C,style:{"--scale-factor":"1"}},tt),ut())}),isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,options:PropTypes.shape({canvasFactory:PropTypes.any,canvasMaxAreaInBytes:PropTypes.number,cMapPacked:PropTypes.bool,CMapReaderFactory:PropTypes.any,cMapUrl:PropTypes.string,disableAutoFetch:PropTypes.bool,disableFontFace:PropTypes.bool,disableRange:PropTypes.bool,disableStream:PropTypes.bool,docBaseUrl:PropTypes.string,enableXfa:PropTypes.bool,filterFactory:PropTypes.any,fontExtraProperties:PropTypes.bool,httpHeaders:PropTypes.object,isEvalSupported:PropTypes.bool,isOffscreenCanvasSupported:PropTypes.bool,length:PropTypes.number,maxImageSize:PropTypes.number,ownerDocument:PropTypes.any,password:PropTypes.string,pdfBug:PropTypes.bool,rangeChunkSize:PropTypes.number,StandardFontDataFactory:PropTypes.any,standardFontDataUrl:PropTypes.string,stopAtErrors:PropTypes.bool,useSystemFonts:PropTypes.bool,useWorkerFetch:PropTypes.bool,verbosity:PropTypes.number,withCredentials:PropTypes.bool,worker:PropTypes.any}),rotate:PropTypes.number});const Document$1=Document;function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var D=[],a=0;a<arguments.length;a++)D[a]=arguments[a];var j=D.filter(Boolean);if(j.length<=1){var i=j[0];return i||null}return function(V){j.forEach(function(W){typeof W=="function"?W(V):W&&(W.current=V)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(D){return D in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(D){return"children"in D}function isStructTreeNodeWithOnlyContentChild(D){return isStructTreeNode(D)?D.children.length===1&&0 in D.children&&"id"in D.children[0]:!1}function getRoleAttributes(D){const a={};if(isStructTreeNode(D)){const{role:j}=D,i=j.match(HEADING_PATTERN);if(i)a.role="heading",a["aria-level"]=Number(i[1]);else if(isPdfRole(j)){const p=PDF_ROLE_TO_HTML_ROLE[j];p&&(a.role=p)}}return a}function getBaseAttributes(D){const a={};if(isStructTreeNode(D)){if(D.alt!==void 0&&(a["aria-label"]=D.alt),D.lang!==void 0&&(a.lang=D.lang),isStructTreeNodeWithOnlyContentChild(D)){const[j]=D.children;if(j){const i=getBaseAttributes(j);return Object.assign(Object.assign({},a),i)}}}else"id"in D&&(a["aria-owns"]=D.id);return a}function getAttributes(D){return D?Object.assign(Object.assign({},getRoleAttributes(D)),getBaseAttributes(D)):null}function StructTreeItem({className:D,node:a}){const j=reactExports.useMemo(()=>getAttributes(a),[a]),i=reactExports.useMemo(()=>!isStructTreeNode(a)||isStructTreeNodeWithOnlyContentChild(a)?null:a.children.map((p,V)=>React.createElement(StructTreeItem,{key:V,node:p})),[a]);return React.createElement("span",Object.assign({className:D},j),i)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const D=usePageContext();invariant(D,"Unable to find Page context.");const{onGetStructTreeError:a,onGetStructTreeSuccess:j}=D,[i,p]=useResolver(),{value:V,error:W}=i,{customTextRenderer:dt,page:F}=D;function C(){V&&j&&j(V)}function m(){W&&(warning$1(!1,W.toString()),a&&a(W))}function I(){p({type:"RESET"})}reactExports.useEffect(I,[p,F]);function O(){if(dt||!F)return;const x=makeCancellablePromise(F.getStructTree()),E=x;return x.promise.then(v=>{p({type:"RESOLVE",value:v})}).catch(v=>{p({type:"REJECT",error:v})}),()=>cancelRunningTask(E)}return reactExports.useEffect(O,[dt,F,p]),reactExports.useEffect(()=>{if(V!==void 0){if(V===!1){m();return}C()}},[V]),V?React.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:V}):null}const ANNOTATION_MODE=pdfjs.AnnotationMode;function PageCanvas(D){const a=usePageContext();invariant(a,"Unable to find Page context.");const j=Object.assign(Object.assign({},a),D),{_className:i,canvasBackground:p,devicePixelRatio:V=getDevicePixelRatio(),onRenderError:W,onRenderSuccess:dt,page:F,renderForms:C,renderTextLayer:m,rotate:I,scale:O}=j,{canvasRef:x}=D;invariant(F,"Attempted to render page canvas, but no page was specified.");const E=reactExports.useRef(null);function v(){F&&dt&&dt(makePageCallback(F,O))}function f(l){isCancelException(l)||(warning$1(!1,l.toString()),W&&W(l))}const _=reactExports.useMemo(()=>F.getViewport({scale:O*V,rotation:I}),[V,F,I,O]),P=reactExports.useMemo(()=>F.getViewport({scale:O,rotation:I}),[F,I,O]);function w(){if(!F)return;F.cleanup();const{current:l}=E;if(!l)return;l.width=_.width,l.height=_.height,l.style.width=`${Math.floor(P.width)}px`,l.style.height=`${Math.floor(P.height)}px`,l.style.visibility="hidden";const d={annotationMode:C?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:l.getContext("2d",{alpha:!1}),viewport:_};p&&(d.background=p);const M=F.render(d),b=M;return M.promise.then(()=>{l.style.visibility="",v()}).catch(f),()=>cancelRunningTask(b)}reactExports.useEffect(w,[p,E,V,F,C,_,P]);const A=reactExports.useCallback(()=>{const{current:l}=E;l&&(l.width=0,l.height=0)},[E]);return reactExports.useEffect(()=>A,[A]),React.createElement("canvas",{className:`${i}__canvas`,dir:"ltr",ref:mergeRefs(x,E),style:{display:"block",userSelect:"none"}},m?React.createElement(StructTree,null):null)}function PageSVG(){const D=usePageContext();invariant(D,"Unable to find Page context.");const{_className:a,onRenderSuccess:j,onRenderError:i,page:p,rotate:V,scale:W}=D;invariant(p,"Attempted to render page SVG, but no page was specified.");const[dt,F]=useResolver(),{value:C,error:m}=dt;function I(){p&&j&&j(makePageCallback(p,W))}function O(){m&&(isCancelException(m)||(warning$1(!1,m.toString()),i&&i(m)))}const x=reactExports.useMemo(()=>p.getViewport({scale:W,rotation:V}),[p,V,W]);function E(){F({type:"RESET"})}reactExports.useEffect(E,[p,F,x]);function v(){if(!p)return;const w=makeCancellablePromise(p.getOperatorList());return w.promise.then(A=>{new pdfjs.SVGGraphics(p.commonObjs,p.objs).getSVG(A,x).then(d=>{if(!(d instanceof SVGElement))throw new Error("getSVG returned unexpected result.");F({type:"RESOLVE",value:d})}).catch(d=>{F({type:"REJECT",error:d})})}).catch(A=>{F({type:"REJECT",error:A})}),()=>cancelRunningTask(w)}reactExports.useEffect(v,[p,F,x]),reactExports.useEffect(()=>{if(C!==void 0){if(C===!1){O();return}I()}},[C]);function f(w){if(!w||!C)return;w.firstElementChild||w.appendChild(C);const{width:A,height:l}=x;C.setAttribute("width",`${A}`),C.setAttribute("height",`${l}`)}const{width:_,height:P}=x;return React.createElement("div",{className:`${a}__svg`,ref:w=>f(w),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:_,height:P,userSelect:"none"}})}function isTextItem(D){return"str"in D}function TextLayer(){const D=usePageContext();invariant(D,"Unable to find Page context.");const{customTextRenderer:a,onGetTextError:j,onGetTextSuccess:i,onRenderTextLayerError:p,onRenderTextLayerSuccess:V,page:W,pageIndex:dt,pageNumber:F,rotate:C,scale:m}=D;invariant(W,"Attempted to load page text content, but no page was specified.");const[I,O]=useResolver(),{value:x,error:E}=I,v=reactExports.useRef(null),f=reactExports.useRef();warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function _(){x&&i&&i(x)}function P(){E&&(warning$1(!1,E.toString()),j&&j(E))}function w(){O({type:"RESET"})}reactExports.useEffect(w,[W,O]);function A(){if(!W)return;const g=makeCancellablePromise(W.getTextContent()),G=g;return g.promise.then(z=>{O({type:"RESOLVE",value:z})}).catch(z=>{O({type:"REJECT",error:z})}),()=>cancelRunningTask(G)}reactExports.useEffect(A,[W,O]),reactExports.useEffect(()=>{if(x!==void 0){if(x===!1){P();return}_()}},[x]);const l=reactExports.useCallback(()=>{V&&V()},[V]),d=reactExports.useCallback(g=>{warning$1(!1,g.toString()),p&&p(g)},[p]);function M(){const g=f.current;g&&g.classList.add("active")}function b(){const g=f.current;g&&g.classList.remove("active")}const c=reactExports.useMemo(()=>W.getViewport({scale:m,rotation:C}),[W,C,m]);function k(){if(!W||!x)return;const{current:g}=v;if(!g)return;g.innerHTML="";const G=W.streamTextContent({includeMarkedContent:!0}),z={container:g,textContentSource:G,viewport:c},T=pdfjs.renderTextLayer(z),Y=T;return T.promise.then(()=>{const it=document.createElement("div");it.className="endOfContent",g.append(it),f.current=it;const lt=g.querySelectorAll('[role="presentation"]');if(a){let $=0;x.items.forEach((ht,bt)=>{if(!isTextItem(ht))return;const St=lt[$];if(!St)return;const wt=a(Object.assign({pageIndex:dt,pageNumber:F,itemIndex:bt},ht));St.innerHTML=wt,$+=ht.str&&ht.hasEOL?2:1})}l()}).catch(d),()=>cancelRunningTask(Y)}return reactExports.useLayoutEffect(k,[a,d,l,W,dt,F,x,c]),React.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:b,onMouseDown:M,ref:v})}function AnnotationLayer(){const D=useDocumentContext();invariant(D,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const a=usePageContext();invariant(a,"Unable to find Page context.");const j=Object.assign(Object.assign({},D),a),{imageResourcesPath:i,linkService:p,onGetAnnotationsError:V,onGetAnnotationsSuccess:W,onRenderAnnotationLayerError:dt,onRenderAnnotationLayerSuccess:F,page:C,pdf:m,renderForms:I,rotate:O,scale:x=1}=j;invariant(C,"Attempted to load page annotations, but no page was specified.");const[E,v]=useResolver(),{value:f,error:_}=E,P=reactExports.useRef(null);warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function w(){f&&W&&W(f)}function A(){_&&(warning$1(!1,_.toString()),V&&V(_))}function l(){v({type:"RESET"})}reactExports.useEffect(l,[v,C]);function d(){if(!C)return;const g=makeCancellablePromise(C.getAnnotations()),G=g;return g.promise.then(z=>{v({type:"RESOLVE",value:z})}).catch(z=>{v({type:"REJECT",error:z})}),()=>{cancelRunningTask(G)}}reactExports.useEffect(d,[v,C,I]),reactExports.useEffect(()=>{if(f!==void 0){if(f===!1){A();return}w()}},[f]);function M(){F&&F()}function b(g){warning$1(!1,`${g}`),dt&&dt(g)}const c=reactExports.useMemo(()=>C.getViewport({scale:x,rotation:O}),[C,O,x]);function k(){if(!m||!C||!f)return;const{current:g}=P;if(!g)return;const G=c.clone({dontFlip:!0}),z={accessibilityManager:null,annotationCanvasMap:null,div:g,l10n:null,page:C,viewport:G},T={annotations:f,annotationStorage:m.annotationStorage,div:g,downloadManager:null,imageResourcesPath:i,linkService:p,page:C,renderForms:I,viewport:G};g.innerHTML="";try{new pdfjs.AnnotationLayer(z).render(T),M()}catch(Y){b(Y)}return()=>{}}return reactExports.useEffect(k,[f,i,p,C,I,c]),React.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:P})}var __rest=function(D,a){var j={};for(var i in D)Object.prototype.hasOwnProperty.call(D,i)&&a.indexOf(i)<0&&(j[i]=D[i]);if(D!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,i=Object.getOwnPropertySymbols(D);p<i.length;p++)a.indexOf(i[p])<0&&Object.prototype.propertyIsEnumerable.call(D,i[p])&&(j[i[p]]=D[i[p]]);return j};const defaultScale=1,Page=function D(a){const j=useDocumentContext();invariant(j,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const i=Object.assign(Object.assign({},j),a),{_className:p="react-pdf__Page",_enableRegisterUnregisterPage:V=!0,canvasBackground:W,canvasRef:dt,children:F,className:C,customRenderer:m,customTextRenderer:I,devicePixelRatio:O,error:x="Failed to load the page.",height:E,inputRef:v,loading:f="Loading page…",noData:_="No page specified.",onGetAnnotationsError:P,onGetAnnotationsSuccess:w,onGetStructTreeError:A,onGetStructTreeSuccess:l,onGetTextError:d,onGetTextSuccess:M,onLoadError:b,onLoadSuccess:c,onRenderAnnotationLayerError:k,onRenderAnnotationLayerSuccess:g,onRenderError:G,onRenderSuccess:z,onRenderTextLayerError:T,onRenderTextLayerSuccess:Y,pageIndex:it,pageNumber:lt,pdf:$,registerPage:ht,renderAnnotationLayer:bt=!0,renderForms:St=!1,renderMode:wt="canvas",renderTextLayer:R=!0,rotate:n,scale:o=defaultScale,unregisterPage:s,width:h}=i,u=__rest(i,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[S,L]=useResolver(),{value:U,error:st}=S,tt=reactExports.useRef(null);invariant($,"Attempted to load a page, but no document was specified.");const at=isProvided(lt)?lt-1:it??null,ut=lt??(isProvided(it)?it+1:null),gt=n??(U?U.rotate:null),ct=reactExports.useMemo(()=>{if(!U)return null;let $t=1;const Wt=o??defaultScale;if(h||E){const Xt=U.getViewport({scale:1,rotation:gt});h?$t=h/Xt.width:E&&($t=E/Xt.height)}return Wt*$t},[E,U,gt,o,h]);function Rt(){return()=>{isProvided(at)&&V&&s&&s(at)}}reactExports.useEffect(Rt,[V,$,at,s]);function It(){if(c){if(!U||!ct)return;c(makePageCallback(U,ct))}if(V&&ht){if(!isProvided(at)||!tt.current)return;ht(at,tt.current)}}function Et(){st&&(warning$1(!1,st.toString()),b&&b(st))}function Lt(){L({type:"RESET"})}reactExports.useEffect(Lt,[L,$,at]);function mt(){if(!$||!ut)return;const $t=makeCancellablePromise($.getPage(ut)),Wt=$t;return $t.promise.then(Xt=>{L({type:"RESOLVE",value:Xt})}).catch(Xt=>{L({type:"REJECT",error:Xt})}),()=>cancelRunningTask(Wt)}reactExports.useEffect(mt,[L,$,at,ut,ht]),reactExports.useEffect(()=>{if(U!==void 0){if(U===!1){Et();return}It()}},[U,ct]);const et=reactExports.useMemo(()=>U&&isProvided(at)&&ut&&isProvided(gt)&&isProvided(ct)?{_className:p,canvasBackground:W,customTextRenderer:I,devicePixelRatio:O,onGetAnnotationsError:P,onGetAnnotationsSuccess:w,onGetStructTreeError:A,onGetStructTreeSuccess:l,onGetTextError:d,onGetTextSuccess:M,onRenderAnnotationLayerError:k,onRenderAnnotationLayerSuccess:g,onRenderError:G,onRenderSuccess:z,onRenderTextLayerError:T,onRenderTextLayerSuccess:Y,page:U,pageIndex:at,pageNumber:ut,renderForms:St,renderTextLayer:R,rotate:gt,scale:ct}:null,[p,W,I,O,P,w,A,l,d,M,k,g,G,z,T,Y,U,at,ut,St,R,gt,ct]),nt=reactExports.useMemo(()=>makeEventProps(u,()=>U&&(ct?makePageCallback(U,ct):void 0)),[u,U,ct]),pt=`${at}@${ct}/${gt}`,Pt=`${at}/${gt}`;function Ct(){switch(wt){case"custom":return invariant(m,'renderMode was set to "custom", but no customRenderer was passed.'),React.createElement(m,{key:`${pt}_custom`});case"none":return null;case"svg":return React.createElement(PageSVG,{key:`${Pt}_svg`});case"canvas":default:return React.createElement(PageCanvas,{key:`${pt}_canvas`,canvasRef:dt})}}function Ut(){return R?React.createElement(TextLayer,{key:`${pt}_text`}):null}function Vt(){return bt?React.createElement(AnnotationLayer,{key:`${pt}_annotations`}):null}function Ht(){return React.createElement(PageContext.Provider,{value:et},Ct(),Ut(),Vt(),F)}function zt(){return ut?$===null||U===void 0||U===null?React.createElement(Message,{type:"loading"},typeof f=="function"?f():f):$===!1||U===!1?React.createElement(Message,{type:"error"},typeof x=="function"?x():x):Ht():React.createElement(Message,{type:"no-data"},typeof _=="function"?_():_)}return React.createElement("div",Object.assign({className:clsx(p,C),"data-page-number":ut,ref:mergeRefs(v,tt),style:{"--scale-factor":`${ct}`,backgroundColor:W||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},nt),zt())},isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:PropTypes.string,canvasRef:isRef,children:PropTypes.node,className:isClassName,customRenderer:PropTypes.func,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,width:PropTypes.number});const Page$1=Page;displayWorkerWarning();pdfjs.GlobalWorkerOptions.workerSrc="pdf.worker.js";pdfjs.GlobalWorkerOptions.workerSrc=`//unpkg.com/pdfjs-dist@${pdfjs.version}/build/pdf.worker.min.js`;const LazyDocument=D=>{const[a,j]=reactExports.useState(!1),[i,p]=reactExports.useState(!1),[V,W]=reactExports.useState(!D.preview),[dt,F]=reactExports.useState(!1),C=reactExports.useCallback((m=null)=>{const I=[];return m&&I.push(m),V||I.push("hidden"),I.join(" ")},[V]);return dt?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Transition,{duration:D.duration,visible:!0,children:jsxRuntimeExports.jsxs(Dimmer.Dimmable,{as:Segment,className:"lazy-document",compact:!0,onBlur:()=>j(!1),onMouseEnter:()=>j(!0),onMouseLeave:()=>j(!1),children:[!V&&jsxRuntimeExports.jsx(LazyLoader,{active:!0,size:D.size}),!i&&D.preview&&jsxRuntimeExports.jsx(Image$1,{...D.image,className:C(),onError:()=>{p(!0),W(!0)},onLoad:()=>{p(!1),W(!0)},src:D.preview,size:D.size}),!i&&V&&!D.preview&&D.src&&D.pdf&&jsxRuntimeExports.jsx(Image$1,{...D.image,className:C(),size:D.size,children:jsxRuntimeExports.jsx(Document$1,{file:D.src,onLoadError:m=>console.log(m.message),children:jsxRuntimeExports.jsx(Page$1,{pageNumber:1,renderTextLayer:!1,renderAnnotationLayer:!1})})}),(i||!D.preview&&!(D.src&&D.pdf))&&jsxRuntimeExports.jsx(Image$1,{...D.image,className:C("placeholder-image"),size:D.size,children:jsxRuntimeExports.jsx(Icon,{name:"file alternate outline",size:"big"})}),(D.download||D.src||D.children)&&D.dimmable&&jsxRuntimeExports.jsx(Dimmer,{active:a,children:jsxRuntimeExports.jsxs("div",{className:"buttons",children:[D.download&&jsxRuntimeExports.jsx(DownloadButton,{primary:!0,url:D.download||D.src}),D.children]})})]})})}):jsxRuntimeExports.jsx(Visibility,{as:"span",fireOnMount:!0,onTopVisible:()=>F(!0),children:jsxRuntimeExports.jsx(Loader,{active:!0,inline:"centered",size:D.size})})};LazyDocument.defaultProps={dimmable:!0,duration:1e3,pdf:!1,preview:void 0,size:"medium",src:void 0};LazyDocument.__docgenInfo={description:"",methods:[],displayName:"LazyDocument",props:{children:{required:!1,flowType:{name:"Node"},description:""},dimmable:{required:!1,flowType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},download:{required:!1,flowType:{name:"string"},description:""},duration:{required:!1,flowType:{name:"number"},description:"",defaultValue:{value:"1000",computed:!1}},image:{required:!1,flowType:{name:"any"},description:""},pdf:{required:!1,flowType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},preview:{required:!1,flowType:{name:"string",nullable:!0},description:"",defaultValue:{value:"undefined",computed:!0}},size:{required:!1,flowType:{name:"string"},description:"",defaultValue:{value:"'medium'",computed:!1}},src:{required:!1,flowType:{name:"string"},description:"",defaultValue:{value:"undefined",computed:!0}}}};export{LazyDocument as L};
