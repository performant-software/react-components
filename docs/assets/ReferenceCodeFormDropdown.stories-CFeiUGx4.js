import{j as o,r as y}from"./iframe-CBVnS_gz.js";import{F as l}from"./Form-Do77273i.js";import{D,t as M,h as v}from"./index.es99-CkNlN2IQ.js";import{r as a,o as x}from"./index.es28-Dw5WpxTH.js";import{R as F}from"./ReferenceCodeDropdown-qUtzjTQi.js";import{i as s,R as q}from"./ReferenceCodeFormLabel-Bz3kpBPP.js";import{H as $}from"./Header-Dr2ltggj.js";import{M as c}from"./Modal-HnkfqseB.js";import{s as I}from"./index.es15-VHNLxWt2.js";import{u as S}from"./DragDrop-CcMMEejU.js";import"./extends-CCbyfPlC.js";import"./inheritsLoose-1HkgTRWY.js";import"./setPrototypeOf-DgZC2w_0.js";import"./getElementType-Bjb0ertt.js";import"./Button-7qBb4VYW.js";import"./Icon-BZ3eAMfw.js";import"./Label-U9VHjmjO.js";import"./ModernAutoControlledComponent-DVKlBc-y.js";import"./assertThisInitialized-B9jnkVVz.js";import"./includes-DZnQI2ww.js";import"./toFinite-B6NhHma2.js";import"./forEach-Bzy9_EBR.js";import"./Dimmer-Dp0zIHSX.js";import"./Portal-BlGvxlD6.js";import"./keyboardKey-o62cP7Iz.js";import"./map-DlHA86TE.js";import"./Checkbox-C74Tntbd.js";import"./_baseSet-DIcQIHLm.js";import"./_baseAssignValue-8Q0krCXH.js";import"./Dropdown-CPiIg0y1.js";import"./without-CH_BgMvr.js";import"./isArrayLikeObject-CKcKx5N9.js";import"./isEmpty-BYfO-h2O.js";import"./deburr-XG8rtojb.js";import"./index-D9NXjPfP.js";import"./_arrayReduce-CrxnWFSq.js";import"./filter-9DG6Xxvy.js";import"./Input-CxqNqYl_.js";import"./index.es35-NGGuPWEW.js";import"./index.es33-BbGNIlHM.js";import"./index.es29-BttlFuE4.js";import"./index.es12-BoZgPIpS.js";import"./index.es3-B5t9sEvB.js";import"./useDrop-DcjkJ2f0.js";import"./index-__O0XiL7.js";import"./index.es26-CiEK4yG9.js";import"./Popup-CxqAbk3T.js";import"./index-BCLYeJHS.js";import"./createClass-CGi6Kyeu.js";import"./toPropertyKey-BdisF6oo.js";import"./i18next-eNuDfwAU.js";import"./redux-1N3yOUoT.js";import"./objectSpread2-xTxB_n9c.js";import"./defineProperty-BhpcgfZc.js";const P=(e,r)=>e&&r&&e.toString().toLowerCase().includes(r.toString().toLowerCase()),k=e=>a.isNumber(e)||a.isBoolean(e)?e:e||"",K=(e,r)=>e?!r||r>e.length?e:e.substring(0,r).trim():null,A={includes:P,toString:k,truncate:K},h=(e,r,n,i)=>{if(!a.has(n,i))return;const t=n[i];a.isArray(t)?a.each(t,(d,m)=>h(e,`${r}[${i}]`,t,m)):a.isObject(t)&&!a.isFunction(t)?a.each(a.keys(t),d=>h(e,`${r}[${i}]`,t,d)):e.append(`${r}[${i}]`,A.toString(t))},E={setAttribute:h};class g{constructor(){if(this.constructor===g)throw new TypeError('Abstract class "NestedAttributesTransform" cannot be instantiated directly.')}getPayloadKeys(){return[]}toFormData(r,n,i,t){a.each(i[t],(d,m)=>{a.each(this.getPayloadKeys(),u=>{E.setAttribute(r,`${n}[${t}][${m}]`,d,u)})})}toPayload(r,n){return{[n]:a.map(r[n],(i,t)=>({order:t,...a.pick(i,this.getPayloadKeys())}))}}}const _=e=>o.jsx(x.Consumer,{children:r=>o.jsxs(c,{as:l,centered:!1,mountNode:r,open:!0,children:[o.jsx(c.Header,{content:e.item.id?s.t("ReferenceCodeModal.title.edit"):s.t("ReferenceCodeModal.title.add")}),o.jsx(c.Content,{children:o.jsx(l.Input,{autoFocus:!0,error:e.isError("name"),label:s.t("ReferenceCodeModal.labels.name"),onChange:e.onTextInputChange.bind(void 0,"name"),required:e.isRequired("name"),value:e.item.name||""})}),e.children]})});_.__docgenInfo={description:"",methods:[],displayName:"ReferenceCodeModal"};const T=e=>o.jsx(x.Consumer,{children:r=>o.jsxs(c,{as:l,centered:!1,className:"reference-table-modal",mountNode:r,open:!0,children:[o.jsx(c.Header,{content:e.item.id?s.t("ReferenceTableModal.title.edit"):s.t("ReferenceTableModal.title.add")}),o.jsxs(c.Content,{children:[o.jsx(l.Input,{autoFocus:!0,error:e.isError("name"),label:s.t("ReferenceTableModal.labels.name"),onChange:e.onTextInputChange.bind(void 0,"name"),required:e.isRequired("name"),value:e.item.name||""}),o.jsx(l.Input,{error:e.isError("key"),label:s.t("ReferenceTableModal.labels.key"),onChange:e.onTextInputChange.bind(void 0,"key"),required:e.isRequired("key"),value:e.item.key||""}),o.jsx($,{content:s.t("ReferenceTableModal.labels.referenceCodes")}),o.jsx(D,{actions:[{name:"edit"},{name:"copy"},{name:"delete"}],columns:[{name:"name",label:s.t("ReferenceTableModal.referenceCodes.columns.name")}],items:e.item.reference_codes,modal:{component:_,props:{required:["name"]}},onDelete:e.onDeleteChildAssociation.bind(void 0,"reference_codes"),onSave:e.onSaveChildAssociation.bind(void 0,"reference_codes")})]}),e.children]})});T.__docgenInfo={description:"",methods:[],displayName:"ReferenceTableModal"};class N extends g{getPayloadKeys(){return["id","name","_destroy"]}toPayload(r,n="reference_codes"){return super.toPayload(r,n)}}const L=new N;class O extends M{getParameterName(){return"reference_table"}getPayloadKeys(){return["name","key"]}toPayload(r,n={}){return super.toPayload(r,{...n,...L.toPayload(r)})}}const B=new O;class H extends I{fetchByKey(r){return this.getAxios().get(`${this.getBaseUrl()}/find_by_key`,{params:{key:r}})}getBaseUrl(){return"/controlled_vocabulary/reference_tables"}getTransform(){return B}}const R=new H,C=e=>{const{error:r,label:n,required:i,referenceTable:t,...d}=e,[m,u]=y.useState(!1),[j,w]=y.useState(0);return o.jsxs(o.Fragment,{children:[o.jsx(l.Input,{error:r,label:o.jsx(q,{label:n,onClick:()=>u(!0),referenceTable:t}),required:i,children:y.createElement(F,{...d,id:t,referenceTable:t,key:j})}),m&&o.jsx(v,{component:T,item:{id:t,key:t},onClose:()=>u(!1),onInitialize:b=>R.fetchByKey(b).then(({data:f})=>({...f.reference_table,key:b})),onSave:b=>R.save(b).then(({data:f})=>f.reference_table).then(()=>w(f=>f+1)).finally(()=>u(!1))})]})};C.__docgenInfo={description:"",methods:[],displayName:"ReferenceCodeFormDropdown",props:{error:{required:!1,flowType:{name:"boolean"},description:""},label:{required:!1,flowType:{name:"string"},description:""},required:{required:!1,flowType:{name:"boolean"},description:""},referenceTable:{required:!0,flowType:{name:"string"},description:""}}};const{action:U}=__STORYBOOK_MODULE_ACTIONS__,ze={title:"Components/Controlled Vocabulary/ReferenceCodeFormDropdown",component:C},p=S(()=>o.jsx(l,{children:o.jsx(C,{fluid:!0,label:"Locations",required:!0,onChange:U("change"),referenceTable:"locations",value:""})}));p.__docgenInfo={description:"",methods:[],displayName:"Default"};p.parameters={...p.parameters,docs:{...p.parameters?.docs,source:{originalSource:`useDragDrop(() => <Form>
    <ReferenceCodeFormDropdown fluid label='Locations' required onChange={action('change')} referenceTable='locations' value='' />
  </Form>)`,...p.parameters?.docs?.source}}};const Ve=["Default"];export{p as Default,Ve as __namedExportsOrder,ze as default};
