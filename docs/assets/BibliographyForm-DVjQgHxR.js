import{j as t}from"./jsx-runtime-D9TvR9R2.js";import{r as n}from"./index-C0dDX-lL.js";import{F as s}from"./Form-WfNl3YLh.js";import{_ as l}from"./index-default-C_maRo4o.js";import{B as b}from"./Bibliography-isW7v-pd.js";import{D as f}from"./Dropdown-DwNow7wJ.js";import{i as h}from"./i18n-axRemAo9.js";const y={single:0,full:1},C=e=>{const i=n.useCallback((r,u,{value:a})=>e.onUpdate({...e.creator||{},[r]:a}),[e.creator,e.onUpdate]),c=n.useCallback(r=>e.onUpdate({...e.creator||{},...r}),[e.creator,e.onUpdate]),d=n.useMemo(()=>t.jsx("label",{children:t.jsx(f,{onChange:i.bind(void 0,"creatorType"),options:l.map(e.creatorTypes,r=>({key:r.value,value:r.value,text:r.label})),value:e.creator.creatorType})}),[e.creator.creatorType,e.creatorTypes]);return n.useEffect(()=>{l.has(e.creator,"nameType")||c({nameType:y.full})},[e.creator,c]),n.useEffect(()=>{if(e.creator.name&&e.creator.nameType===y.full){const[r,u]=e.creator.name.split(" ");c({name:null,firstName:r,lastName:u})}else if((e.creator.firstName||e.creator.lastName)&&e.creator.nameType===y.single){const r=l.compact([e.creator.firstName,e.creator.lastName]).join(" ");c({firstName:null,lastName:null,name:r})}},[e.creator.nameType]),t.jsxs(s.Group,{className:"creator-field",children:[e.creator.nameType===y.full&&t.jsxs(t.Fragment,{children:[t.jsx(s.Input,{className:"flex",label:d,onChange:i.bind(void 0,"firstName"),placeholder:h.t("CreatorField.labels.firstName"),value:e.creator.firstName}),t.jsx(s.Input,{className:"flex",onChange:i.bind(void 0,"lastName"),placeholder:h.t("CreatorField.labels.lastName"),value:e.creator.lastName}),t.jsx(s.Button,{icon:"exchange",onClick:()=>c({nameType:y.single})})]}),e.creator.nameType===y.single&&t.jsxs(t.Fragment,{children:[t.jsx(s.Input,{className:"flex",label:d,onChange:i.bind(void 0,"name"),placeholder:h.t("CreatorField.labels.name"),value:e.creator.name}),t.jsx(s.Button,{icon:"exchange",onClick:()=>c({nameType:y.full})})]}),t.jsx(s.Button,{icon:"plus",onClick:e.onAdd}),t.jsx(s.Button,{disabled:!e.allowDelete,icon:"minus",onClick:e.onDelete})]})};C.__docgenInfo={description:"",methods:[],displayName:"CreatorField",props:{allowDelete:{required:!1,flowType:{name:"boolean"},description:""},creatorTypes:{required:!0,flowType:{name:"Array",elements:[{name:"any"}],raw:"Array<any>"},description:""},creator:{required:!0,flowType:{name:"any"},description:""},onAdd:{required:!0,flowType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onDelete:{required:!0,flowType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onUpdate:{required:!0,flowType:{name:"signature",type:"function",raw:"(props: any) => void",signature:{arguments:[{name:"props",type:{name:"any"}}],return:{name:"void"}}},description:""}}};const x=e=>{const i=n.useMemo(()=>e.creatorTypes&&e.creatorTypes.length&&e.creatorTypes[0].value,[e.creatorTypes]),c=n.useCallback(()=>e.onChange([...e.value||[],{creatorType:i}]),[e.onChange,e.value]),d=n.useCallback(a=>e.onChange(l.filter(e.value,(o,m)=>m!==a)),[e.onChange,e.value]),r=n.useCallback((a,o)=>e.onChange(l.map(e.value,(m,g)=>g===a?o:m)),[e.onChange,e.value]),u=n.useCallback(a=>l.findWhere(e.creatorTypes,{value:a.creatorType})?a:{...a,creatorType:i},[e.creatorTypes,i]);return n.useEffect(()=>{c()},[]),n.useEffect(()=>{e.value&&e.value.length&&e.onChange(l.map(e.value,u))},[u,e.creatorTypes]),l.map(e.value,(a,o)=>t.jsx(C,{allowDelete:e.value.length>1,creator:a,creatorTypes:e.creatorTypes,onAdd:()=>c(),onDelete:()=>d(o),onUpdate:m=>r(o,m)},o))},k="abstractNote",N="creators",j="extra",F="itemType",v=e=>{const[i,c]=n.useState([]),[d,r]=n.useState([]),u=n.useCallback(a=>a.key===F?t.jsx(s.Dropdown,{disabled:a.readonly,label:a.label,onChange:e.onTextInputChange.bind(void 0,a.key),options:l.map(a.options,o=>({key:o.value,value:o.value,text:o.label})),selectOnBlur:!1,selection:!0,value:e.item[a.key]||""},a.key):a.key===N?t.jsx(x,{creatorTypes:i,onChange:o=>e.onSetState({[a.key]:o}),value:e.item[a.key]||[]},a.key):a.key===k||a.key===j?t.jsx(s.TextArea,{disabled:a.readonly,label:a.label,onChange:e.onTextInputChange.bind(void 0,a.key),value:e.item[a.key]||""},a.key):t.jsx(s.Input,{disabled:a.readonly,label:a.label,onChange:e.onTextInputChange.bind(void 0,a.key),value:e.item[a.key]||""},a.key),[i,e.item]);return n.useEffect(()=>{b.getItemTypeMeta(e.item.itemType).then(a=>{const o=l.map(a.itemTypes,T=>({value:T.itemType,label:T.localized})),m=l.map(a.itemTypeCreatorTypes,T=>({value:T.creatorType,label:T.localized}));c(m);const g=b.getFieldsAndItem(e.item,a.itemTypeFields,o);r(g.fields)})},[e.item.itemType]),t.jsx(t.Fragment,{children:l.map(d,u)})},_=v;v.__docgenInfo={description:"This component can be used in conjunction with the `useEditContainer` higher-order component to create a form\nused to enter bibliographic data.",methods:[],displayName:"BibliographyForm",props:{item:{required:!0,flowType:{name:"any"},description:"A JSON representation of the bibliographic item."}}};export{_ as B};
