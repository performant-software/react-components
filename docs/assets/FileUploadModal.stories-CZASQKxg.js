import{j as n}from"./jsx-runtime-D9TvR9R2.js";import{a as z}from"./chunk-WFFRPTHA-B2vgThZf.js";import{R as P,r as i}from"./index-C0dDX-lL.js";import{F as A}from"./Form-WfNl3YLh.js";import{B as E}from"./Button-CJhT71wt.js";import{I as x}from"./Item-DsGqipCH.js";import{M as T}from"./Message-smmiVK7n.js";import{L as ge}from"./Loader-lqR_Ikjg.js";import{D as Se}from"./Dimmer-DP3fvqlo.js";import{M as $}from"./Modal-BWgkEMr1.js";import{_ as m}from"./index-default-C_maRo4o.js";import{F as we}from"./FileUpload-BwyhFlVF.js";import{I as fe}from"./Icon-C_3d7-zE.js";import{L as Ue}from"./Label-aEFd48OX.js";import{H as J}from"./Header-BHdMo175.js";import{_ as Fe}from"./extends-CCbyfPlC.js";import{_ as Me}from"./inheritsLoose-1HkgTRWY.js";import{a5 as Pe,V as ee,p as te,a6 as Te,n as Ne,u as S,s as ke,m as qe,o as Le}from"./getElementType-BSRayMAs.js";import{t as _e}from"./includes-Cc_HXDPA.js";import{a as H}from"./toFinite-C3oJXAtX.js";import{i as w}from"./ModernAutoControlledComponent-C211dBIC.js";import{i as j}from"./i18n-CM1tepcX.js";import{M as Ee}from"./ModalContext-CLCyDZFr.js";import"./preview-errors-CzpZmerH.js";import"./index-CKJfshIT.js";import"./v4-D8aEg3BZ.js";import"./_commonjsHelpers-BosuxZz1.js";import"./Checkbox-B3tsCUtI.js";import"./_baseSet-BllfnHSO.js";import"./_baseAssignValue-UQlBDUKN.js";import"./Portal-B8DXQ6EK.js";import"./keyboardKey-OMDgGVm3.js";import"./index-DOYXiIEK.js";import"./objectWithoutPropertiesLoose-1QL-frMM.js";import"./Dropdown-DwNow7wJ.js";import"./map-DWKMCCtW.js";import"./without-Duh6Zu7H.js";import"./isArrayLikeObject-Bl_bAmop.js";import"./isEmpty-CY-Bv0TY.js";import"./deburr-CNLr_JRW.js";import"./index-mbjjMjCk.js";import"./_arrayReduce-CrxnWFSq.js";import"./filter-B6f9p5im.js";import"./Input-Bwh_HEb3.js";import"./Trans-BYRLofKo.js";import"./objectWithoutProperties--RY0eV0u.js";import"./toPropertyKey-BcUJYDQU.js";import"./defineProperty-DcNpp85p.js";import"./utils-DCllE6BU.js";import"./createClass-D0eOxKhW.js";import"./forEach-CLeEMxs1.js";import"./setPrototypeOf-DgZC2w_0.js";import"./assertThisInitialized-B9jnkVVz.js";import"./i18next-CwS9wMM1.js";import"./inherits-CWPG5jll.js";import"./createClass-CV9nCQMI.js";import"./getPrototypeOf-BYVhAdwF.js";function Ae(e,t,o){return e===e&&(o!==void 0&&(e=e<=o?e:o),t!==void 0&&(e=e>=t?e:t)),e}var Re=Pe.isFinite,Oe=Math.min;function De(e){var t=Math[e];return function(o,a){if(o=H(o),a=a==null?0:Oe(_e(a),292),a&&Re(o)){var d=(ee(o)+"e").split("e"),h=t(d[0]+"e"+(+d[1]+a));return d=(ee(h)+"e").split("e"),+(d[0]+"e"+(+d[1]-a))}return t(o)}}var Ve=De("round");function $e(e,t,o){return o===void 0&&(o=t,t=void 0),o!==void 0&&(o=H(o),o=o===o?o:0),t!==void 0&&(t=H(t),t=t===t?t:0),Ae(H(e),t,o)}var Q=function(e){Me(t,e);function t(){for(var a,d=arguments.length,h=new Array(d),I=0;I<d;I++)h[I]=arguments[I];return a=e.call.apply(e,[this].concat(h))||this,a.calculatePercent=function(){var l=a.props,u=l.percent,g=l.total,f=l.value;if(!w(u))return u;if(!w(g)&&!w(f))return f/g*100},a.computeValueText=function(l){var u=a.props,g=u.progress,f=u.total,v=u.value;return g==="value"?v:g==="ratio"?v+"/"+f:l+"%"},a.getPercent=function(){var l=a.props,u=l.precision,g=l.progress,f=l.total,v=l.value,U=$e(a.calculatePercent(),0,100);return!w(f)&&!w(v)&&g==="value"?v/f*100:g==="value"?v:w(u)?U:Ve(U,u)},a.isAutoSuccess=function(){var l=a.props,u=l.autoSuccess,g=l.percent,f=l.total,v=l.value;return u&&(g>=100||v>=f)},a.renderLabel=function(){var l=a.props,u=l.children,g=l.content,f=l.label;return te(u)?te(g)?Te(f,{autoGenerateKey:!1,defaultProps:{className:"label"}}):P.createElement("div",{className:"label"},g):P.createElement("div",{className:"label"},u)},a.renderProgress=function(l){var u=a.props,g=u.precision,f=u.progress;if(!(!f&&w(g)))return P.createElement("div",{className:"progress"},a.computeValueText(l))},a}var o=t.prototype;return o.render=function(){var d=this.props,h=d.active,I=d.attached,l=d.className,u=d.color,g=d.disabled,f=d.error,v=d.indicating,U=d.inverted,O=d.size,D=d.success,G=d.warning,F=Ne("ui",u,O,S(h||v,"active"),S(g,"disabled"),S(f,"error"),S(v,"indicating"),S(U,"inverted"),S(D||this.isAutoSuccess(),"success"),S(G,"warning"),ke(I,"attached"),"progress",l),V=qe(t,this.props),K=Le(t,this.props),M=this.getPercent()||0;return P.createElement(K,Fe({},V,{className:F,"data-percent":Math.floor(M)}),P.createElement("div",{className:"bar",style:{width:M+"%"}},this.renderProgress(M)),this.renderLabel())},t}(i.Component);Q.handledProps=["active","as","attached","autoSuccess","children","className","color","content","disabled","error","indicating","inverted","label","percent","precision","progress","size","success","total","value","warning"];Q.propTypes={};const Be=Q,C={pending:"pending",processing:"processing",complete:"complete",error:"error"},He={[C.processing]:"black",[C.complete]:"green",[C.error]:"red"},ze={[C.pending]:"clock outline",[C.complete]:"checkmark",[C.error]:"warning circle"},We={[C.pending]:"Pending",[C.processing]:"Processing",[C.complete]:"Complete",[C.error]:"Error"},he=({status:e=C.pending})=>{const t=i.useMemo(()=>He[e],[e]),o=i.useMemo(()=>ze[e],[e]),a=i.useMemo(()=>We[e],[e]);return n.jsxs(Ue,{className:"file-upload-status",color:t,children:[e===C.processing&&n.jsx(ge,{active:!0,inline:!0,inverted:!0,size:"mini"}),o&&n.jsx(fe,{name:o}),a]})};he.__docgenInfo={description:"",methods:[],displayName:"FileUploadStatus",props:{status:{required:!1,flowType:{name:"string"},description:"",defaultValue:{value:"'pending'",computed:!1}}}};const ve=e=>{const t=i.useMemo(()=>e.completed>0&&e.completed===e.total,[e.completed,e.total]),o=i.useMemo(()=>e.total>0?e.completed/e.total:0,[e.completed,e.total]),a=i.useMemo(()=>Number(o).toLocaleString(void 0,{style:"percent",minimumFractionDigits:0}),[o]);return n.jsxs("div",{className:"file-upload-progress",children:[n.jsx(fe,{color:"blue",name:"cloud upload",size:"big"}),n.jsxs("div",{className:"progress-container",children:[n.jsxs(J,{children:[n.jsx(J.Content,{content:a}),n.jsxs(J.Subheader,{children:[!(e.uploading||t)&&"Getting Started",e.uploading&&"Uploading...",t&&"Completed"]})]}),n.jsx(Be,{color:"blue",percent:o*100})]})]})};ve.__docgenInfo={description:"",methods:[],displayName:"FileUploadProgress",props:{completed:{required:!0,flowType:{name:"number"},description:""},total:{required:!0,flowType:{name:"number"},description:""},uploading:{required:!1,flowType:{name:"boolean"},description:""}}};const N={batch:"batch",single:"single"},B={pending:"pending",processing:"processing",complete:"complete",error:"error"},X=e=>{const[t,o]=i.useState([]),[a,d]=i.useState(0),[h,I]=i.useState(!1),[l,u]=i.useState({}),g=i.useMemo(()=>!!m.find(t,r=>!m.isEmpty(r.errors)),[t]),f=i.useMemo(()=>!!m.find(m.values(l),r=>r===B.error),[l]),v=i.useCallback(r=>o(s=>[...s,...m.map(r,e.onAddFile)]),[]),U=i.useCallback((r,s,p,c)=>o(y=>m.map(y,b=>b!==r?b:{...b,[s]:c.id,[p]:c,errors:m.without(r.errors,s)})),[]),O=i.useCallback(()=>e.onSave(t).then(()=>d(1)),[t]),D=i.useCallback(()=>{I(!1),e.onComplete&&e.onComplete(),e.closeOnComplete&&e.onClose()},[e.closeOnComplete,e.onClose]),G=i.useCallback(r=>o(s=>m.filter(s,p=>p!==r)),[]),F=i.useCallback((r,s)=>u(p=>({...p,[r]:s}))),V=i.useCallback(async()=>{for(let r=0;r<t.length;r+=1){const s=t[r];F(r,B.processing);let p;try{await e.onSave(s)}catch(c){p=c}p?F(r,B.error):F(r,B.complete),d(c=>c+1)}return Promise.resolve()},[t,e.onSave]),K=i.useCallback((r,s)=>o(p=>m.map(p,c=>c!==r?c:{...c,...s,errors:[]})),[]),M=i.useCallback((r,s,p,{value:c})=>o(y=>m.map(y,b=>b!==r?b:{...b,[s]:c,errors:m.without(r.errors,s)})),[]),Ce=i.useCallback((r,s)=>o(p=>m.map(p,c=>c!==r?c:{...c,...s})),[]),ye=i.useCallback(r=>{const s=[];return m.each(m.keys(e.required),p=>{const c=r[p];let y;m.isNumber(c)?y=m.isEmpty(c.toString()):y=m.isEmpty(c),y&&s.push(p)}),{...r,errors:s}},[e.required]),Y=i.useCallback(()=>new Promise((r,s)=>{let p=!1;const c=m.map(t,y=>{const b=ye(y);return m.isEmpty(b.errors)||(p=!0),b});o(c),p?s():r()}),[t]),be=i.useCallback(()=>{I(!0),Y().then(()=>e.strategy===N.batch?O():V()).finally(D)},[O,D,V,Y,e.strategy]),xe=i.useCallback((r,s)=>{if(m.isEmpty(r.errors))return null;const p=m.isEmpty(r.name)?s:r.name,c=m.map(r.errors,y=>e.required[y]).join(", ");return n.jsx(T.Item,{content:j.t("FileUploadModal.errors.required",{filename:p,fields:c})},s)},[]),Ie=i.useCallback(r=>e.strategy!==N.single?null:n.jsx(he,{status:l[r]}),[l,e.strategy]),Z=i.useMemo(()=>e.headerComponent,[e.headerComponent]),je=i.useMemo(()=>e.itemComponent,[e.itemComponent]);return n.jsx(Ee.Consumer,{children:r=>n.jsxs($,{centered:!1,className:"serial-upload-modal",mountNode:r,open:!0,children:[e.showPageLoader&&n.jsx(Se,{active:h,inverted:!0,children:n.jsx(ge,{content:j.t("FileUploadModal.loader")})}),n.jsxs($.Header,{children:[e.strategy===N.batch&&j.t("FileUploadModal.title"),e.strategy===N.single&&n.jsx(ve,{completed:a,total:t.length,uploading:h})]}),n.jsxs($.Content,{scrolling:!0,children:[g&&n.jsxs(T,{error:!0,children:[n.jsx(T.Header,{content:j.t("FileUploadModal.errors.header")}),n.jsx(T.List,{children:m.map(t,xe)})]}),f&&n.jsx(T,{content:j.t("FileUploadModal.errors.upload.content"),header:j.t("FileUploadModal.errors.upload.header"),error:!0}),n.jsx(we,{onFilesAdded:v}),Z&&n.jsx(Z,{items:t,onSetItems:o,uploading:h}),n.jsx(x.Group,{as:A,divided:!0,noValidate:!0,relaxed:"very",children:m.map(t,(s,p)=>n.jsx(je,{isError:c=>m.contains(s.errors,c),isRequired:c=>!!(e.required&&e.required[c]),item:s,onAssociationInputChange:U.bind(void 0,s),onDelete:G.bind(void 0,s),onSetState:K.bind(void 0,s),onTextInputChange:M.bind(void 0,s),onUpdate:Ce.bind(void 0,s),renderStatus:Ie.bind(void 0,p)},p))})]}),n.jsxs($.Actions,{children:[n.jsx(E,{content:j.t("Common.buttons.upload"),disabled:h||a>0||m.isEmpty(t),icon:"cloud upload",loading:h&&!e.showPageLoader,onClick:be,primary:!0}),n.jsx(E,{content:a>0?j.t("Common.buttons.close"):j.t("Common.buttons.cancel"),disabled:h,onClick:e.onClose})]})]})})};X.defaultProps={closeOnComplete:!0,strategy:N.batch,showPageLoader:!0};const R=X;X.__docgenInfo={description:`The <code>FileUploadModal</code> is a convenience wrapper for the <code>FileUpload</code> component, allowing
it to render in a modal.`,methods:[],displayName:"FileUploadModal",props:{closeOnComplete:{required:!1,flowType:{name:"boolean"},description:"If <code>true</code>, the modal will close once the upload has completed.",defaultValue:{value:"true",computed:!1}},headerComponent:{required:!1,flowType:{name:"ComponentType",elements:[{name:"any"}],raw:"ComponentType<any>"},description:"Component to render at top of modal."},itemComponent:{required:!0,flowType:{name:"ComponentType",elements:[{name:"any"}],raw:"ComponentType<any>"},description:"Component to render within the modal."},onAddFile:{required:!0,flowType:{name:"signature",type:"function",raw:"(file: File) => any",signature:{arguments:[{name:"file",type:{name:"File"}}],return:{name:"any"}}},description:"Callback fired when a file is added."},onClose:{required:!0,flowType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback fired when the close button is clicked."},onComplete:{required:!0,flowType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback fired when the upload has completed."},onSave:{required:!0,flowType:{name:"signature",type:"function",raw:"(items: Array<any>) => Promise<any>",signature:{arguments:[{name:"items",type:{name:"Array",elements:[{name:"any"}],raw:"Array<any>"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}}},description:"Callback fired when the save button is clicked. See <code>strategy</code> prop."},required:{required:!1,flowType:{name:"signature",type:"object",raw:"{ [key: string]: string }",signature:{properties:[{key:{name:"string"},value:{name:"string",required:!0}}]}},description:"An object with keys containing the names of properties that are required."},showPageLoader:{required:!1,flowType:{name:"boolean"},description:"If <code>true</code>, a full page loader will display while uploading is in progress.",defaultValue:{value:"true",computed:!1}},strategy:{required:!1,flowType:{name:"string"},description:`The upload strategy to use. If <code>batch</code>, we'll execute one <code>onSave</code> request with each item
as an array in the body. If <code>single</code>, we'll execute an <code>onSave</code> request for each item.`,defaultValue:{value:"'batch'",computed:!1}}}};const Qt={title:"Components/Semantic UI/FileUploadModal",component:R},W=e=>t=>{const[o,a]=i.useState(!1);return n.jsxs(n.Fragment,{children:[n.jsx(E,{content:"Open",primary:!0,onClick:()=>a(!0)}),o&&n.jsx(e,{...t,onClose:()=>a(!1)})]})},k=W(e=>n.jsx(R,{itemComponent:({item:t})=>n.jsx(A.Input,{label:"Name",value:t.name||""}),onAddFile:t=>({name:t.name,content:t,type:t.type}),onClose:e.onClose,onSave:()=>(z("save")(),Promise.resolve())})),q=W(e=>n.jsx(R,{closeOnComplete:!1,itemComponent:({item:t,isError:o,isRequired:a,onDelete:d,onTextInputChange:h})=>n.jsxs(x,{children:[n.jsx(x.Image,{src:URL.createObjectURL(t.content)}),n.jsxs(x.Content,{children:[n.jsx(A.Input,{error:o("name"),label:"Name",onChange:h.bind(void 0,"name"),required:a("name"),value:t.name||""}),n.jsx(E,{basic:!0,color:"red",icon:"trash",onClick:d})]})]}),onAddFile:t=>({name:t.name,content:t,content_type:t.type}),onClose:e.onClose,onSave:()=>(z("save")(),Promise.resolve()),required:{name:"Name"}})),L=W(e=>n.jsx(R,{itemComponent:({item:t,onTextInputChange:o})=>n.jsxs(x,{children:[n.jsx(x.Image,{src:URL.createObjectURL(t.content)}),n.jsx(x.Content,{children:n.jsx(A.Input,{label:"Name",onChange:o.bind(void 0,"name"),value:t.name})})]}),onAddFile:t=>({name:t.name,content:t,type:t.type}),onClose:e.onClose,onSave:()=>(z("save")(),Promise.resolve())})),_=W(e=>n.jsx(R,{closeOnComplete:!1,itemComponent:({item:t,onDelete:o,onTextInputChange:a,renderStatus:d})=>n.jsxs(x,{children:[n.jsx(x.Image,{src:URL.createObjectURL(t.content)}),n.jsxs(x.Content,{children:[n.jsx(A.Input,{label:"Name",onChange:a.bind(void 0,"name"),value:t.name}),n.jsx(E,{basic:!0,color:"red",icon:"trash",onClick:o}),d()]})]}),onAddFile:t=>({name:t.name,content:t,type:t.type}),onClose:e.onClose,onSave:()=>(z("save")(),Promise.resolve()),showPageLoader:!1,strategy:"single"}));k.__docgenInfo={description:"",methods:[],displayName:"Default"};q.__docgenInfo={description:"",methods:[],displayName:"Errors"};L.__docgenInfo={description:"",methods:[],displayName:"Images"};_.__docgenInfo={description:"",methods:[],displayName:"SingleUpload"};var ne,oe,re;k.parameters={...k.parameters,docs:{...(ne=k.parameters)==null?void 0:ne.docs,source:{originalSource:`withWrapper(props => <FileUploadModal itemComponent={({
  item
}) => <Form.Input label='Name' value={item.name || ''} />} onAddFile={file => ({
  name: file.name,
  content: file,
  type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} />)`,...(re=(oe=k.parameters)==null?void 0:oe.docs)==null?void 0:re.source}}};var ae,se,ie;q.parameters={...q.parameters,docs:{...(ae=q.parameters)==null?void 0:ae.docs,source:{originalSource:`withWrapper(props => <FileUploadModal closeOnComplete={false} itemComponent={({
  item,
  isError,
  isRequired,
  onDelete,
  onTextInputChange
}) => <Item>
        <Item.Image src={URL.createObjectURL(item.content)} />
        <Item.Content>
          <Form.Input error={isError('name')} label='Name' onChange={onTextInputChange.bind(this, 'name')} required={isRequired('name')} value={item.name || ''} />
          <Button basic color='red' icon='trash' onClick={onDelete} />
        </Item.Content>
      </Item>} onAddFile={file => ({
  name: file.name,
  content: file,
  content_type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} required={{
  name: 'Name'
}} />)`,...(ie=(se=q.parameters)==null?void 0:se.docs)==null?void 0:ie.source}}};var le,ce,de;L.parameters={...L.parameters,docs:{...(le=L.parameters)==null?void 0:le.docs,source:{originalSource:`withWrapper(props => <FileUploadModal itemComponent={({
  item,
  onTextInputChange
}) => <Item>
        <Item.Image src={URL.createObjectURL(item.content)} />
        <Item.Content>
          <Form.Input label='Name' onChange={onTextInputChange.bind(this, 'name')} value={item.name} />
        </Item.Content>
      </Item>} onAddFile={file => ({
  name: file.name,
  content: file,
  type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} />)`,...(de=(ce=L.parameters)==null?void 0:ce.docs)==null?void 0:de.source}}};var me,pe,ue;_.parameters={..._.parameters,docs:{...(me=_.parameters)==null?void 0:me.docs,source:{originalSource:`withWrapper(props => <FileUploadModal closeOnComplete={false} itemComponent={({
  item,
  onDelete,
  onTextInputChange,
  renderStatus
}) => <Item>
        <Item.Image src={URL.createObjectURL(item.content)} />
        <Item.Content>
          <Form.Input label='Name' onChange={onTextInputChange.bind(this, 'name')} value={item.name} />
          <Button basic color='red' icon='trash' onClick={onDelete} />
          {renderStatus()}
        </Item.Content>
      </Item>} onAddFile={file => ({
  name: file.name,
  content: file,
  type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} showPageLoader={false} strategy='single' />)`,...(ue=(pe=_.parameters)==null?void 0:pe.docs)==null?void 0:ue.source}}};const Xt=["Default","Errors","Images","SingleUpload"];export{k as Default,q as Errors,L as Images,_ as SingleUpload,Xt as __namedExportsOrder,Qt as default};
