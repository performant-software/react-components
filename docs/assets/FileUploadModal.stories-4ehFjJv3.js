import{j as n}from"./jsx-runtime-D9TvR9R2.js";import{a as V}from"./chunk-WFFRPTHA-B2vgThZf.js";import{R as k,r as i}from"./index-C0dDX-lL.js";import{F as P}from"./Form-WfNl3YLh.js";import{B as O}from"./Button-CJhT71wt.js";import{I}from"./Item-DsGqipCH.js";import{c as Pe}from"./index.es33-DzLdile2.js";import{M as S}from"./Message-smmiVK7n.js";import{L as Ce}from"./Loader-lqR_Ikjg.js";import{D as Me}from"./Dimmer-DP3fvqlo.js";import{M as W}from"./Modal-BWgkEMr1.js";import{_ as d}from"./index-default-C_maRo4o.js";import{F as Te}from"./FileUpload-W4MGEdmU.js";import{I as ye}from"./Icon-C_3d7-zE.js";import{L as Ne}from"./Label-aEFd48OX.js";import{H as Q}from"./Header-BHdMo175.js";import{_ as ke}from"./extends-CCbyfPlC.js";import{_ as qe}from"./inheritsLoose-1HkgTRWY.js";import{a5 as Ee,V as te,p as ne,a6 as Le,n as _e,u as w,s as Ae,m as Re,o as Oe}from"./getElementType-BSRayMAs.js";import{t as Ve}from"./includes-Cc_HXDPA.js";import{a as G}from"./toFinite-C3oJXAtX.js";import{i as U}from"./ModernAutoControlledComponent-C211dBIC.js";import{i as x}from"./i18n-C9xJ7SCg.js";import"./preview-errors-CzpZmerH.js";import"./index-CKJfshIT.js";import"./v4-D8aEg3BZ.js";import"./_commonjsHelpers-BosuxZz1.js";import"./Checkbox-B3tsCUtI.js";import"./_baseSet-BllfnHSO.js";import"./_baseAssignValue-UQlBDUKN.js";import"./Portal-B8DXQ6EK.js";import"./keyboardKey-OMDgGVm3.js";import"./index-DOYXiIEK.js";import"./objectWithoutPropertiesLoose-1QL-frMM.js";import"./Dropdown-DwNow7wJ.js";import"./map-DWKMCCtW.js";import"./without-Duh6Zu7H.js";import"./isArrayLikeObject-Bl_bAmop.js";import"./isEmpty-CY-Bv0TY.js";import"./deburr-CNLr_JRW.js";import"./index-mbjjMjCk.js";import"./_arrayReduce-CrxnWFSq.js";import"./filter-B6f9p5im.js";import"./Input-Bwh_HEb3.js";import"./iframe-B9MQw29J.js";import"../sb-preview/runtime.js";import"./Trans-BYRLofKo.js";import"./objectWithoutProperties--RY0eV0u.js";import"./toPropertyKey-BcUJYDQU.js";import"./defineProperty-DcNpp85p.js";import"./utils-DCllE6BU.js";import"./createClass-D0eOxKhW.js";import"./forEach-CLeEMxs1.js";import"./setPrototypeOf-DgZC2w_0.js";import"./assertThisInitialized-B9jnkVVz.js";import"./i18next-CwS9wMM1.js";import"./inherits-CWPG5jll.js";import"./createClass-CV9nCQMI.js";import"./getPrototypeOf-BYVhAdwF.js";function De(e,t,o){return e===e&&(o!==void 0&&(e=e<=o?e:o),t!==void 0&&(e=e>=t?e:t)),e}var $e=Ee.isFinite,Be=Math.min;function He(e){var t=Math[e];return function(o,a){if(o=G(o),a=a==null?0:Be(Ve(a),292),a&&$e(o)){var m=(te(o)+"e").split("e"),h=t(m[0]+"e"+(+m[1]+a));return m=(te(h)+"e").split("e"),+(m[0]+"e"+(+m[1]-a))}return t(o)}}var We=He("round");function ze(e,t,o){return o===void 0&&(o=t,t=void 0),o!==void 0&&(o=G(o),o=o===o?o:0),t!==void 0&&(t=G(t),t=t===t?t:0),De(G(e),t,o)}var X=function(e){qe(t,e);function t(){for(var a,m=arguments.length,h=new Array(m),j=0;j<m;j++)h[j]=arguments[j];return a=e.call.apply(e,[this].concat(h))||this,a.calculatePercent=function(){var l=a.props,u=l.percent,f=l.total,g=l.value;if(!U(u))return u;if(!U(f)&&!U(g))return g/f*100},a.computeValueText=function(l){var u=a.props,f=u.progress,g=u.total,v=u.value;return f==="value"?v:f==="ratio"?v+"/"+g:l+"%"},a.getPercent=function(){var l=a.props,u=l.precision,f=l.progress,g=l.total,v=l.value,F=ze(a.calculatePercent(),0,100);return!U(g)&&!U(v)&&f==="value"?v/g*100:f==="value"?v:U(u)?F:We(F,u)},a.isAutoSuccess=function(){var l=a.props,u=l.autoSuccess,f=l.percent,g=l.total,v=l.value;return u&&(f>=100||v>=g)},a.renderLabel=function(){var l=a.props,u=l.children,f=l.content,g=l.label;return ne(u)?ne(f)?Le(g,{autoGenerateKey:!1,defaultProps:{className:"label"}}):k.createElement("div",{className:"label"},f):k.createElement("div",{className:"label"},u)},a.renderProgress=function(l){var u=a.props,f=u.precision,g=u.progress;if(!(!g&&U(f)))return k.createElement("div",{className:"progress"},a.computeValueText(l))},a}var o=t.prototype;return o.render=function(){var m=this.props,h=m.active,j=m.attached,l=m.className,u=m.color,f=m.disabled,g=m.error,v=m.indicating,F=m.inverted,$=m.size,B=m.success,K=m.warning,T=_e("ui",u,$,w(h||v,"active"),w(f,"disabled"),w(g,"error"),w(v,"indicating"),w(F,"inverted"),w(B||this.isAutoSuccess(),"success"),w(K,"warning"),Ae(j,"attached"),"progress",l),H=Re(t,this.props),J=Oe(t,this.props),N=this.getPercent()||0;return k.createElement(J,ke({},H,{className:T,"data-percent":Math.floor(N)}),k.createElement("div",{className:"bar",style:{width:N+"%"}},this.renderProgress(N)),this.renderLabel())},t}(i.Component);X.handledProps=["active","as","attached","autoSuccess","children","className","color","content","disabled","error","indicating","inverted","label","percent","precision","progress","size","success","total","value","warning"];X.propTypes={};const Ge=X,y={pending:"pending",processing:"processing",complete:"complete",error:"error"},Ke={[y.processing]:"black",[y.complete]:"green",[y.error]:"red"},Je={[y.pending]:"clock outline",[y.complete]:"checkmark",[y.error]:"warning circle"},Qe={[y.pending]:"Pending",[y.processing]:"Processing",[y.complete]:"Complete",[y.error]:"Error"},be=({status:e=y.pending})=>{const t=i.useMemo(()=>Ke[e],[e]),o=i.useMemo(()=>Je[e],[e]),a=i.useMemo(()=>Qe[e],[e]);return n.jsxs(Ne,{className:"file-upload-status",color:t,children:[e===y.processing&&n.jsx(Ce,{active:!0,inline:!0,inverted:!0,size:"mini"}),o&&n.jsx(ye,{name:o}),a]})};be.__docgenInfo={description:"",methods:[],displayName:"FileUploadStatus",props:{status:{required:!1,flowType:{name:"string"},description:"",defaultValue:{value:"'pending'",computed:!1}}}};const xe=e=>{const t=i.useMemo(()=>e.completed>0&&e.completed===e.total,[e.completed,e.total]),o=i.useMemo(()=>e.total>0?e.completed/e.total:0,[e.completed,e.total]),a=i.useMemo(()=>Number(o).toLocaleString(void 0,{style:"percent",minimumFractionDigits:0}),[o]);return n.jsxs("div",{className:"file-upload-progress",children:[n.jsx(ye,{color:"blue",name:"cloud upload",size:"big"}),n.jsxs("div",{className:"progress-container",children:[n.jsxs(Q,{children:[n.jsx(Q.Content,{content:a}),n.jsxs(Q.Subheader,{children:[!(e.uploading||t)&&"Getting Started",e.uploading&&"Uploading...",t&&"Completed"]})]}),n.jsx(Ge,{color:"blue",percent:o*100})]})]})};xe.__docgenInfo={description:"",methods:[],displayName:"FileUploadProgress",props:{completed:{required:!0,flowType:{name:"number"},description:""},total:{required:!0,flowType:{name:"number"},description:""},uploading:{required:!1,flowType:{name:"boolean"},description:""}}};const q={batch:"batch",single:"single"},z={pending:"pending",processing:"processing",complete:"complete",error:"error"},Y=e=>{const[t,o]=i.useState([]),[a,m]=i.useState(0),[h,j]=i.useState(!1),[l,u]=i.useState({}),f=i.useMemo(()=>!!d.find(t,r=>!d.isEmpty(r.errors)),[t]),g=i.useMemo(()=>!!d.find(d.values(l),r=>r===z.error),[l]),v=i.useCallback(r=>o(s=>[...s,...d.map(r,e.onAddFile)]),[]),F=i.useCallback((r,s,p,c)=>o(C=>d.map(C,b=>b!==r?b:{...b,[s]:c.id,[p]:c,errors:d.without(r.errors,s)})),[]),$=i.useCallback(()=>e.onSave(t).then(()=>m(1)),[t]),B=i.useCallback(()=>{j(!1),e.onComplete&&e.onComplete(),e.closeOnComplete&&e.onClose()},[e.closeOnComplete,e.onClose]),K=i.useCallback(r=>o(s=>d.filter(s,p=>p!==r)),[]),T=i.useCallback((r,s)=>u(p=>({...p,[r]:s}))),H=i.useCallback(async()=>{for(let r=0;r<t.length;r+=1){const s=t[r];T(r,z.processing);let p;try{await e.onSave(s)}catch(c){p=c}p?T(r,z.error):T(r,z.complete),m(c=>c+1)}return Promise.resolve()},[t,e.onSave]),J=i.useCallback((r,s)=>o(p=>d.map(p,c=>c!==r?c:{...c,...s,errors:[]})),[]),N=i.useCallback((r,s,p,{value:c})=>o(C=>d.map(C,b=>b!==r?b:{...b,[s]:c,errors:d.without(r.errors,s)})),[]),Ie=i.useCallback((r,s)=>o(p=>d.map(p,c=>c!==r?c:{...c,...s})),[]),je=i.useCallback(r=>{const s=[];return d.each(d.keys(e.required),p=>{const c=r[p];let C;e.onValidate?C=e.onValidate(r,p):d.isNumber(c)?C=d.isEmpty(c.toString()):C=d.isEmpty(c),C&&s.push(p)}),{...r,errors:s}},[e.onValidate,e.required]),Z=i.useCallback(()=>new Promise((r,s)=>{let p=!1;const c=d.map(t,C=>{const b=je(C);return d.isEmpty(b.errors)||(p=!0),b});o(c),p?s():r()}),[t]),Se=i.useCallback(()=>{j(!0),Z().then(()=>e.strategy===q.batch?$():H()).finally(B)},[$,B,H,Z,e.strategy]),we=i.useCallback((r,s)=>{if(d.isEmpty(r.errors))return null;const p=d.isEmpty(r.name)?s:r.name,c=d.map(r.errors,C=>e.required[C]).join(", ");return n.jsx(S.Item,{content:x.t("FileUploadModal.errors.required",{filename:p,fields:c})},s)},[]),Ue=i.useCallback(r=>e.strategy!==q.single?null:n.jsx(be,{status:l[r]}),[l,e.strategy]),ee=i.useMemo(()=>e.headerComponent,[e.headerComponent]),Fe=i.useMemo(()=>e.itemComponent,[e.itemComponent]);return n.jsx(Pe.Consumer,{children:r=>n.jsxs(W,{centered:!1,className:"serial-upload-modal",mountNode:r,open:!0,children:[e.showPageLoader&&n.jsx(Me,{active:h,inverted:!0,children:n.jsx(Ce,{content:x.t("FileUploadModal.loader")})}),n.jsxs(W.Header,{children:[e.strategy===q.batch&&x.t("FileUploadModal.title"),e.strategy===q.single&&n.jsx(xe,{completed:a,total:t.length,uploading:h})]}),n.jsxs(W.Content,{scrolling:!0,children:[f&&n.jsxs(S,{error:!0,children:[n.jsx(S.Header,{content:x.t("FileUploadModal.errors.header")}),n.jsx(S.List,{children:d.map(t,we)})]}),!d.isEmpty(e.errors)&&n.jsxs(S,{error:!0,children:[n.jsx(S.Header,{content:x.t("FileUploadModal.errors.header")}),n.jsx(S.List,{items:e.errors})]}),g&&n.jsx(S,{content:x.t("FileUploadModal.errors.upload.content"),header:x.t("FileUploadModal.errors.upload.header"),error:!0}),n.jsx(Te,{onFilesAdded:v}),ee&&n.jsx(ee,{items:t,onSetItems:o,uploading:h}),n.jsx(I.Group,{as:P,divided:!0,noValidate:!0,relaxed:"very",children:d.map(t,(s,p)=>i.createElement(Fe,{...e.itemComponentProps,isError:c=>d.contains(s.errors,c),isRequired:c=>!!(e.required&&e.required[c]),item:s,key:p,onAssociationInputChange:F.bind(void 0,s),onDelete:K.bind(void 0,s),onSetState:J.bind(void 0,s),onTextInputChange:N.bind(void 0,s),onUpdate:Ie.bind(void 0,s),renderStatus:Ue.bind(void 0,p)}))})]}),n.jsxs(W.Actions,{children:[n.jsx(O,{content:x.t("Common.buttons.upload"),disabled:h||a>0||d.isEmpty(t),icon:"cloud upload",loading:h&&!e.showPageLoader,onClick:Se,primary:!0}),n.jsx(O,{content:a>0?x.t("Common.buttons.close"):x.t("Common.buttons.cancel"),disabled:h,onClick:e.onClose})]})]})})};Y.defaultProps={closeOnComplete:!0,itemComponentProps:{},strategy:q.batch,showPageLoader:!0};const M=Y;Y.__docgenInfo={description:`The <code>FileUploadModal</code> is a convenience wrapper for the <code>FileUpload</code> component, allowing
it to render in a modal.`,methods:[],displayName:"FileUploadModal",props:{closeOnComplete:{required:!1,flowType:{name:"boolean"},description:"If <code>true</code>, the modal will close once the upload has completed.",defaultValue:{value:"true",computed:!1}},errors:{required:!1,flowType:{name:"string"},description:"An error message to display at the top of the modal."},headerComponent:{required:!1,flowType:{name:"ComponentType",elements:[{name:"any"}],raw:"ComponentType<any>"},description:"Component to render at top of modal."},itemComponent:{required:!0,flowType:{name:"ComponentType",elements:[{name:"any"}],raw:"ComponentType<any>"},description:"Component to render within the modal."},itemComponentProps:{required:!1,flowType:{name:"any"},description:'Additional props to provide to the "itemComponent".',defaultValue:{value:"{}",computed:!1}},onAddFile:{required:!0,flowType:{name:"signature",type:"function",raw:"(file: File) => any",signature:{arguments:[{name:"file",type:{name:"File"}}],return:{name:"any"}}},description:"Callback fired when a file is added."},onClose:{required:!0,flowType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback fired when the close button is clicked."},onComplete:{required:!0,flowType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback fired when the upload has completed."},onSave:{required:!0,flowType:{name:"signature",type:"function",raw:"(items: Array<any>) => Promise<any>",signature:{arguments:[{name:"items",type:{name:"Array",elements:[{name:"any"}],raw:"Array<any>"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}}},description:"Callback fired when the save button is clicked. See <code>strategy</code> prop."},onValidate:{required:!1,flowType:{name:"signature",type:"function",raw:"(item: any, key: string) => boolean",signature:{arguments:[{name:"item",type:{name:"any"}},{name:"key",type:{name:"string"}}],return:{name:"boolean"}}},description:`Callback fired when an item is validated. If the return value is \`true\`, the item will pass validation.

@param item
@param key`},required:{required:!1,flowType:{name:"signature",type:"object",raw:"{ [key: string]: string }",signature:{properties:[{key:{name:"string"},value:{name:"string",required:!0}}]}},description:"An object with keys containing the names of properties that are required."},showPageLoader:{required:!1,flowType:{name:"boolean"},description:"If <code>true</code>, a full page loader will display while uploading is in progress.",defaultValue:{value:"true",computed:!1}},strategy:{required:!1,flowType:{name:"string"},description:`The upload strategy to use. If <code>batch</code>, we'll execute one <code>onSave</code> request with each item
as an array in the body. If <code>single</code>, we'll execute an <code>onSave</code> request for each item.`,defaultValue:{value:"'batch'",computed:!1}}}};const nn={title:"Components/Semantic UI/FileUploadModal",component:M},D=e=>t=>{const[o,a]=i.useState(!1);return n.jsxs(n.Fragment,{children:[n.jsx(O,{content:"Open",primary:!0,onClick:()=>a(!0)}),o&&n.jsx(e,{...t,onClose:()=>a(!1)})]})},E=D(e=>n.jsx(M,{itemComponent:({item:t})=>n.jsx(P.Input,{label:"Name",value:t.name||""}),onAddFile:t=>({name:t.name,content:t,type:t.type}),onClose:e.onClose,onSave:()=>(V("save")(),Promise.resolve())})),L=D(e=>n.jsx(M,{closeOnComplete:!1,itemComponent:({item:t,isError:o,isRequired:a,onDelete:m,onTextInputChange:h})=>n.jsxs(I,{children:[n.jsx(I.Image,{src:URL.createObjectURL(t.content)}),n.jsxs(I.Content,{children:[n.jsx(P.Input,{error:o("name"),label:"Name",onChange:h.bind(void 0,"name"),required:a("name"),value:t.name||""}),n.jsx(O,{basic:!0,color:"red",icon:"trash",onClick:m})]})]}),onAddFile:t=>({name:t.name,content:t,content_type:t.type}),onClose:e.onClose,onSave:()=>(V("save")(),Promise.resolve()),required:{name:"Name"}})),_=D(e=>n.jsx(M,{errors:["File too large."],itemComponent:({item:t})=>n.jsx(P.Input,{label:"Name",value:t.name||""}),onAddFile:t=>({name:t.name,content:t,type:t.type}),onClose:e.onClose,onSave:()=>(V("save")(),Promise.resolve())})),A=D(e=>n.jsx(M,{itemComponent:({item:t,onTextInputChange:o})=>n.jsxs(I,{children:[n.jsx(I.Image,{src:URL.createObjectURL(t.content)}),n.jsx(I.Content,{children:n.jsx(P.Input,{label:"Name",onChange:o.bind(void 0,"name"),value:t.name})})]}),onAddFile:t=>({name:t.name,content:t,type:t.type}),onClose:e.onClose,onSave:()=>(V("save")(),Promise.resolve())})),R=D(e=>n.jsx(M,{closeOnComplete:!1,itemComponent:({item:t,onDelete:o,onTextInputChange:a,renderStatus:m})=>n.jsxs(I,{children:[n.jsx(I.Image,{src:URL.createObjectURL(t.content)}),n.jsxs(I.Content,{children:[n.jsx(P.Input,{label:"Name",onChange:a.bind(void 0,"name"),value:t.name}),n.jsx(O,{basic:!0,color:"red",icon:"trash",onClick:o}),m()]})]}),onAddFile:t=>({name:t.name,content:t,type:t.type}),onClose:e.onClose,onSave:()=>(V("save")(),Promise.resolve()),showPageLoader:!1,strategy:"single"}));E.__docgenInfo={description:"",methods:[],displayName:"Default"};L.__docgenInfo={description:"",methods:[],displayName:"InputErrors"};_.__docgenInfo={description:"",methods:[],displayName:"UploadErrors"};A.__docgenInfo={description:"",methods:[],displayName:"Images"};R.__docgenInfo={description:"",methods:[],displayName:"SingleUpload"};var oe,re,ae;E.parameters={...E.parameters,docs:{...(oe=E.parameters)==null?void 0:oe.docs,source:{originalSource:`withWrapper(props => <FileUploadModal itemComponent={({
  item
}) => <Form.Input label='Name' value={item.name || ''} />} onAddFile={file => ({
  name: file.name,
  content: file,
  type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} />)`,...(ae=(re=E.parameters)==null?void 0:re.docs)==null?void 0:ae.source}}};var se,ie,le;L.parameters={...L.parameters,docs:{...(se=L.parameters)==null?void 0:se.docs,source:{originalSource:`withWrapper(props => <FileUploadModal closeOnComplete={false} itemComponent={({
  item,
  isError,
  isRequired,
  onDelete,
  onTextInputChange
}) => <Item>
        <Item.Image src={URL.createObjectURL(item.content)} />
        <Item.Content>
          <Form.Input error={isError('name')} label='Name' onChange={onTextInputChange.bind(this, 'name')} required={isRequired('name')} value={item.name || ''} />
          <Button basic color='red' icon='trash' onClick={onDelete} />
        </Item.Content>
      </Item>} onAddFile={file => ({
  name: file.name,
  content: file,
  content_type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} required={{
  name: 'Name'
}} />)`,...(le=(ie=L.parameters)==null?void 0:ie.docs)==null?void 0:le.source}}};var ce,me,de;_.parameters={..._.parameters,docs:{...(ce=_.parameters)==null?void 0:ce.docs,source:{originalSource:`withWrapper(props => <FileUploadModal errors={['File too large.']} itemComponent={({
  item
}) => <Form.Input label='Name' value={item.name || ''} />} onAddFile={file => ({
  name: file.name,
  content: file,
  type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} />)`,...(de=(me=_.parameters)==null?void 0:me.docs)==null?void 0:de.source}}};var pe,ue,fe;A.parameters={...A.parameters,docs:{...(pe=A.parameters)==null?void 0:pe.docs,source:{originalSource:`withWrapper(props => <FileUploadModal itemComponent={({
  item,
  onTextInputChange
}) => <Item>
        <Item.Image src={URL.createObjectURL(item.content)} />
        <Item.Content>
          <Form.Input label='Name' onChange={onTextInputChange.bind(this, 'name')} value={item.name} />
        </Item.Content>
      </Item>} onAddFile={file => ({
  name: file.name,
  content: file,
  type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} />)`,...(fe=(ue=A.parameters)==null?void 0:ue.docs)==null?void 0:fe.source}}};var ge,he,ve;R.parameters={...R.parameters,docs:{...(ge=R.parameters)==null?void 0:ge.docs,source:{originalSource:`withWrapper(props => <FileUploadModal closeOnComplete={false} itemComponent={({
  item,
  onDelete,
  onTextInputChange,
  renderStatus
}) => <Item>
        <Item.Image src={URL.createObjectURL(item.content)} />
        <Item.Content>
          <Form.Input label='Name' onChange={onTextInputChange.bind(this, 'name')} value={item.name} />
          <Button basic color='red' icon='trash' onClick={onDelete} />
          {renderStatus()}
        </Item.Content>
      </Item>} onAddFile={file => ({
  name: file.name,
  content: file,
  type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} showPageLoader={false} strategy='single' />)`,...(ve=(he=R.parameters)==null?void 0:he.docs)==null?void 0:ve.source}}};const on=["Default","InputErrors","UploadErrors","Images","SingleUpload"];export{E as Default,A as Images,L as InputErrors,R as SingleUpload,_ as UploadErrors,on as __namedExportsOrder,nn as default};
