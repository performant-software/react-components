import{j as n}from"./jsx-runtime-D9TvR9R2.js";import{a as z}from"./chunk-WFFRPTHA-B2vgThZf.js";import{R as T,r as i}from"./index-C0dDX-lL.js";import{F as A}from"./Form-WfNl3YLh.js";import{B as _}from"./Button-CJhT71wt.js";import{I}from"./Item-DsGqipCH.js";import{M as S}from"./Message-smmiVK7n.js";import{L as fe}from"./Loader-lqR_Ikjg.js";import{D as Se}from"./Dimmer-DP3fvqlo.js";import{M as $}from"./Modal-BWgkEMr1.js";import{_ as m}from"./index-default-C_maRo4o.js";import{F as we}from"./FileUpload-BwyhFlVF.js";import{I as ge}from"./Icon-C_3d7-zE.js";import{L as Ue}from"./Label-aEFd48OX.js";import{H as J}from"./Header-BHdMo175.js";import{_ as Fe}from"./extends-CCbyfPlC.js";import{_ as Me}from"./inheritsLoose-1HkgTRWY.js";import{a5 as Pe,V as ee,p as te,a6 as Te,n as ke,u as w,s as qe,m as Ne,o as Le}from"./getElementType-BSRayMAs.js";import{t as Ee}from"./includes-Cc_HXDPA.js";import{a as H}from"./toFinite-C3oJXAtX.js";import{i as U}from"./ModernAutoControlledComponent-C211dBIC.js";import{i as x}from"./i18n-CM1tepcX.js";import{M as _e}from"./ModalContext-CLCyDZFr.js";import"./preview-errors-CzpZmerH.js";import"./index-CKJfshIT.js";import"./v4-D8aEg3BZ.js";import"./_commonjsHelpers-BosuxZz1.js";import"./Checkbox-B3tsCUtI.js";import"./_baseSet-BllfnHSO.js";import"./_baseAssignValue-UQlBDUKN.js";import"./Portal-B8DXQ6EK.js";import"./keyboardKey-OMDgGVm3.js";import"./index-DOYXiIEK.js";import"./objectWithoutPropertiesLoose-1QL-frMM.js";import"./Dropdown-DwNow7wJ.js";import"./map-DWKMCCtW.js";import"./without-Duh6Zu7H.js";import"./isArrayLikeObject-Bl_bAmop.js";import"./isEmpty-CY-Bv0TY.js";import"./deburr-CNLr_JRW.js";import"./index-mbjjMjCk.js";import"./_arrayReduce-CrxnWFSq.js";import"./filter-B6f9p5im.js";import"./Input-Bwh_HEb3.js";import"./Trans-BYRLofKo.js";import"./objectWithoutProperties--RY0eV0u.js";import"./toPropertyKey-BcUJYDQU.js";import"./defineProperty-DcNpp85p.js";import"./utils-DCllE6BU.js";import"./createClass-D0eOxKhW.js";import"./forEach-CLeEMxs1.js";import"./setPrototypeOf-DgZC2w_0.js";import"./assertThisInitialized-B9jnkVVz.js";import"./i18next-CwS9wMM1.js";import"./inherits-CWPG5jll.js";import"./createClass-CV9nCQMI.js";import"./getPrototypeOf-BYVhAdwF.js";function Ae(e,t,o){return e===e&&(o!==void 0&&(e=e<=o?e:o),t!==void 0&&(e=e>=t?e:t)),e}var Re=Pe.isFinite,Oe=Math.min;function Ve(e){var t=Math[e];return function(o,a){if(o=H(o),a=a==null?0:Oe(Ee(a),292),a&&Re(o)){var d=(ee(o)+"e").split("e"),h=t(d[0]+"e"+(+d[1]+a));return d=(ee(h)+"e").split("e"),+(d[0]+"e"+(+d[1]-a))}return t(o)}}var De=Ve("round");function $e(e,t,o){return o===void 0&&(o=t,t=void 0),o!==void 0&&(o=H(o),o=o===o?o:0),t!==void 0&&(t=H(t),t=t===t?t:0),Ae(H(e),t,o)}var Q=function(e){Me(t,e);function t(){for(var a,d=arguments.length,h=new Array(d),j=0;j<d;j++)h[j]=arguments[j];return a=e.call.apply(e,[this].concat(h))||this,a.calculatePercent=function(){var l=a.props,u=l.percent,f=l.total,g=l.value;if(!U(u))return u;if(!U(f)&&!U(g))return g/f*100},a.computeValueText=function(l){var u=a.props,f=u.progress,g=u.total,v=u.value;return f==="value"?v:f==="ratio"?v+"/"+g:l+"%"},a.getPercent=function(){var l=a.props,u=l.precision,f=l.progress,g=l.total,v=l.value,F=$e(a.calculatePercent(),0,100);return!U(g)&&!U(v)&&f==="value"?v/g*100:f==="value"?v:U(u)?F:De(F,u)},a.isAutoSuccess=function(){var l=a.props,u=l.autoSuccess,f=l.percent,g=l.total,v=l.value;return u&&(f>=100||v>=g)},a.renderLabel=function(){var l=a.props,u=l.children,f=l.content,g=l.label;return te(u)?te(f)?Te(g,{autoGenerateKey:!1,defaultProps:{className:"label"}}):T.createElement("div",{className:"label"},f):T.createElement("div",{className:"label"},u)},a.renderProgress=function(l){var u=a.props,f=u.precision,g=u.progress;if(!(!g&&U(f)))return T.createElement("div",{className:"progress"},a.computeValueText(l))},a}var o=t.prototype;return o.render=function(){var d=this.props,h=d.active,j=d.attached,l=d.className,u=d.color,f=d.disabled,g=d.error,v=d.indicating,F=d.inverted,O=d.size,V=d.success,G=d.warning,M=ke("ui",u,O,w(h||v,"active"),w(f,"disabled"),w(g,"error"),w(v,"indicating"),w(F,"inverted"),w(V||this.isAutoSuccess(),"success"),w(G,"warning"),qe(j,"attached"),"progress",l),D=Ne(t,this.props),K=Le(t,this.props),P=this.getPercent()||0;return T.createElement(K,Fe({},D,{className:M,"data-percent":Math.floor(P)}),T.createElement("div",{className:"bar",style:{width:P+"%"}},this.renderProgress(P)),this.renderLabel())},t}(i.Component);Q.handledProps=["active","as","attached","autoSuccess","children","className","color","content","disabled","error","indicating","inverted","label","percent","precision","progress","size","success","total","value","warning"];Q.propTypes={};const Be=Q,y={pending:"pending",processing:"processing",complete:"complete",error:"error"},He={[y.processing]:"black",[y.complete]:"green",[y.error]:"red"},ze={[y.pending]:"clock outline",[y.complete]:"checkmark",[y.error]:"warning circle"},We={[y.pending]:"Pending",[y.processing]:"Processing",[y.complete]:"Complete",[y.error]:"Error"},he=({status:e=y.pending})=>{const t=i.useMemo(()=>He[e],[e]),o=i.useMemo(()=>ze[e],[e]),a=i.useMemo(()=>We[e],[e]);return n.jsxs(Ue,{className:"file-upload-status",color:t,children:[e===y.processing&&n.jsx(fe,{active:!0,inline:!0,inverted:!0,size:"mini"}),o&&n.jsx(ge,{name:o}),a]})};he.__docgenInfo={description:"",methods:[],displayName:"FileUploadStatus",props:{status:{required:!1,flowType:{name:"string"},description:"",defaultValue:{value:"'pending'",computed:!1}}}};const ve=e=>{const t=i.useMemo(()=>e.completed>0&&e.completed===e.total,[e.completed,e.total]),o=i.useMemo(()=>e.total>0?e.completed/e.total:0,[e.completed,e.total]),a=i.useMemo(()=>Number(o).toLocaleString(void 0,{style:"percent",minimumFractionDigits:0}),[o]);return n.jsxs("div",{className:"file-upload-progress",children:[n.jsx(ge,{color:"blue",name:"cloud upload",size:"big"}),n.jsxs("div",{className:"progress-container",children:[n.jsxs(J,{children:[n.jsx(J.Content,{content:a}),n.jsxs(J.Subheader,{children:[!(e.uploading||t)&&"Getting Started",e.uploading&&"Uploading...",t&&"Completed"]})]}),n.jsx(Be,{color:"blue",percent:o*100})]})]})};ve.__docgenInfo={description:"",methods:[],displayName:"FileUploadProgress",props:{completed:{required:!0,flowType:{name:"number"},description:""},total:{required:!0,flowType:{name:"number"},description:""},uploading:{required:!1,flowType:{name:"boolean"},description:""}}};const k={batch:"batch",single:"single"},B={pending:"pending",processing:"processing",complete:"complete",error:"error"},X=e=>{const[t,o]=i.useState([]),[a,d]=i.useState(0),[h,j]=i.useState(!1),[l,u]=i.useState({}),f=i.useMemo(()=>!!m.find(t,r=>!m.isEmpty(r.errors)),[t]),g=i.useMemo(()=>!!m.find(m.values(l),r=>r===B.error),[l]),v=i.useCallback(r=>o(s=>[...s,...m.map(r,e.onAddFile)]),[]),F=i.useCallback((r,s,p,c)=>o(C=>m.map(C,b=>b!==r?b:{...b,[s]:c.id,[p]:c,errors:m.without(r.errors,s)})),[]),O=i.useCallback(()=>e.onSave(t).then(()=>d(1)),[t]),V=i.useCallback(()=>{j(!1),e.onComplete&&e.onComplete(),e.closeOnComplete&&e.onClose()},[e.closeOnComplete,e.onClose]),G=i.useCallback(r=>o(s=>m.filter(s,p=>p!==r)),[]),M=i.useCallback((r,s)=>u(p=>({...p,[r]:s}))),D=i.useCallback(async()=>{for(let r=0;r<t.length;r+=1){const s=t[r];M(r,B.processing);let p;try{await e.onSave(s)}catch(c){p=c}p?M(r,B.error):M(r,B.complete),d(c=>c+1)}return Promise.resolve()},[t,e.onSave]),K=i.useCallback((r,s)=>o(p=>m.map(p,c=>c!==r?c:{...c,...s,errors:[]})),[]),P=i.useCallback((r,s,p,{value:c})=>o(C=>m.map(C,b=>b!==r?b:{...b,[s]:c,errors:m.without(r.errors,s)})),[]),Ce=i.useCallback((r,s)=>o(p=>m.map(p,c=>c!==r?c:{...c,...s})),[]),ye=i.useCallback(r=>{const s=[];return m.each(m.keys(e.required),p=>{const c=r[p];let C;e.onValidate?C=e.onValidate(r,p):m.isNumber(c)?C=m.isEmpty(c.toString()):C=m.isEmpty(c),C&&s.push(p)}),{...r,errors:s}},[e.onValidate,e.required]),Y=i.useCallback(()=>new Promise((r,s)=>{let p=!1;const c=m.map(t,C=>{const b=ye(C);return m.isEmpty(b.errors)||(p=!0),b});o(c),p?s():r()}),[t]),be=i.useCallback(()=>{j(!0),Y().then(()=>e.strategy===k.batch?O():D()).finally(V)},[O,V,D,Y,e.strategy]),xe=i.useCallback((r,s)=>{if(m.isEmpty(r.errors))return null;const p=m.isEmpty(r.name)?s:r.name,c=m.map(r.errors,C=>e.required[C]).join(", ");return n.jsx(S.Item,{content:x.t("FileUploadModal.errors.required",{filename:p,fields:c})},s)},[]),Ie=i.useCallback(r=>e.strategy!==k.single?null:n.jsx(he,{status:l[r]}),[l,e.strategy]),Z=i.useMemo(()=>e.headerComponent,[e.headerComponent]),je=i.useMemo(()=>e.itemComponent,[e.itemComponent]);return n.jsx(_e.Consumer,{children:r=>n.jsxs($,{centered:!1,className:"serial-upload-modal",mountNode:r,open:!0,children:[e.showPageLoader&&n.jsx(Se,{active:h,inverted:!0,children:n.jsx(fe,{content:x.t("FileUploadModal.loader")})}),n.jsxs($.Header,{children:[e.strategy===k.batch&&x.t("FileUploadModal.title"),e.strategy===k.single&&n.jsx(ve,{completed:a,total:t.length,uploading:h})]}),n.jsxs($.Content,{scrolling:!0,children:[f&&n.jsxs(S,{error:!0,children:[n.jsx(S.Header,{content:x.t("FileUploadModal.errors.header")}),n.jsx(S.List,{children:m.map(t,xe)})]}),e.errors&&n.jsxs(S,{error:!0,children:[n.jsx(S.Header,{content:x.t("FileUploadModal.errors.header")}),n.jsx(S.List,{items:e.errors})]}),g&&n.jsx(S,{content:x.t("FileUploadModal.errors.upload.content"),header:x.t("FileUploadModal.errors.upload.header"),error:!0}),n.jsx(we,{onFilesAdded:v}),Z&&n.jsx(Z,{items:t,onSetItems:o,uploading:h}),n.jsx(I.Group,{as:A,divided:!0,noValidate:!0,relaxed:"very",children:m.map(t,(s,p)=>i.createElement(je,{...e.itemComponentProps,isError:c=>m.contains(s.errors,c),isRequired:c=>!!(e.required&&e.required[c]),item:s,key:p,onAssociationInputChange:F.bind(void 0,s),onDelete:G.bind(void 0,s),onSetState:K.bind(void 0,s),onTextInputChange:P.bind(void 0,s),onUpdate:Ce.bind(void 0,s),renderStatus:Ie.bind(void 0,p)}))})]}),n.jsxs($.Actions,{children:[n.jsx(_,{content:x.t("Common.buttons.upload"),disabled:h||a>0||m.isEmpty(t),icon:"cloud upload",loading:h&&!e.showPageLoader,onClick:be,primary:!0}),n.jsx(_,{content:a>0?x.t("Common.buttons.close"):x.t("Common.buttons.cancel"),disabled:h,onClick:e.onClose})]})]})})};X.defaultProps={closeOnComplete:!0,itemComponentProps:{},strategy:k.batch,showPageLoader:!0};const R=X;X.__docgenInfo={description:`The <code>FileUploadModal</code> is a convenience wrapper for the <code>FileUpload</code> component, allowing
it to render in a modal.`,methods:[],displayName:"FileUploadModal",props:{closeOnComplete:{required:!1,flowType:{name:"boolean"},description:"If <code>true</code>, the modal will close once the upload has completed.",defaultValue:{value:"true",computed:!1}},errors:{required:!1,flowType:{name:"string"},description:"An error message to display at the top of the modal."},headerComponent:{required:!1,flowType:{name:"ComponentType",elements:[{name:"any"}],raw:"ComponentType<any>"},description:"Component to render at top of modal."},itemComponent:{required:!0,flowType:{name:"ComponentType",elements:[{name:"any"}],raw:"ComponentType<any>"},description:"Component to render within the modal."},itemComponentProps:{required:!1,flowType:{name:"any"},description:'Additional props to provide to the "itemComponent".',defaultValue:{value:"{}",computed:!1}},onAddFile:{required:!0,flowType:{name:"signature",type:"function",raw:"(file: File) => any",signature:{arguments:[{name:"file",type:{name:"File"}}],return:{name:"any"}}},description:"Callback fired when a file is added."},onClose:{required:!0,flowType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback fired when the close button is clicked."},onComplete:{required:!0,flowType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback fired when the upload has completed."},onSave:{required:!0,flowType:{name:"signature",type:"function",raw:"(items: Array<any>) => Promise<any>",signature:{arguments:[{name:"items",type:{name:"Array",elements:[{name:"any"}],raw:"Array<any>"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}}},description:"Callback fired when the save button is clicked. See <code>strategy</code> prop."},onValidate:{required:!1,flowType:{name:"signature",type:"function",raw:"(item: any, key: string) => boolean",signature:{arguments:[{name:"item",type:{name:"any"}},{name:"key",type:{name:"string"}}],return:{name:"boolean"}}},description:`Callback fired when an item is validated. If the return value is \`true\`, the item will pass validation.

@param item
@param key`},required:{required:!1,flowType:{name:"signature",type:"object",raw:"{ [key: string]: string }",signature:{properties:[{key:{name:"string"},value:{name:"string",required:!0}}]}},description:"An object with keys containing the names of properties that are required."},showPageLoader:{required:!1,flowType:{name:"boolean"},description:"If <code>true</code>, a full page loader will display while uploading is in progress.",defaultValue:{value:"true",computed:!1}},strategy:{required:!1,flowType:{name:"string"},description:`The upload strategy to use. If <code>batch</code>, we'll execute one <code>onSave</code> request with each item
as an array in the body. If <code>single</code>, we'll execute an <code>onSave</code> request for each item.`,defaultValue:{value:"'batch'",computed:!1}}}};const Qt={title:"Components/Semantic UI/FileUploadModal",component:R},W=e=>t=>{const[o,a]=i.useState(!1);return n.jsxs(n.Fragment,{children:[n.jsx(_,{content:"Open",primary:!0,onClick:()=>a(!0)}),o&&n.jsx(e,{...t,onClose:()=>a(!1)})]})},q=W(e=>n.jsx(R,{itemComponent:({item:t})=>n.jsx(A.Input,{label:"Name",value:t.name||""}),onAddFile:t=>({name:t.name,content:t,type:t.type}),onClose:e.onClose,onSave:()=>(z("save")(),Promise.resolve())})),N=W(e=>n.jsx(R,{closeOnComplete:!1,itemComponent:({item:t,isError:o,isRequired:a,onDelete:d,onTextInputChange:h})=>n.jsxs(I,{children:[n.jsx(I.Image,{src:URL.createObjectURL(t.content)}),n.jsxs(I.Content,{children:[n.jsx(A.Input,{error:o("name"),label:"Name",onChange:h.bind(void 0,"name"),required:a("name"),value:t.name||""}),n.jsx(_,{basic:!0,color:"red",icon:"trash",onClick:d})]})]}),onAddFile:t=>({name:t.name,content:t,content_type:t.type}),onClose:e.onClose,onSave:()=>(z("save")(),Promise.resolve()),required:{name:"Name"}})),L=W(e=>n.jsx(R,{itemComponent:({item:t,onTextInputChange:o})=>n.jsxs(I,{children:[n.jsx(I.Image,{src:URL.createObjectURL(t.content)}),n.jsx(I.Content,{children:n.jsx(A.Input,{label:"Name",onChange:o.bind(void 0,"name"),value:t.name})})]}),onAddFile:t=>({name:t.name,content:t,type:t.type}),onClose:e.onClose,onSave:()=>(z("save")(),Promise.resolve())})),E=W(e=>n.jsx(R,{closeOnComplete:!1,itemComponent:({item:t,onDelete:o,onTextInputChange:a,renderStatus:d})=>n.jsxs(I,{children:[n.jsx(I.Image,{src:URL.createObjectURL(t.content)}),n.jsxs(I.Content,{children:[n.jsx(A.Input,{label:"Name",onChange:a.bind(void 0,"name"),value:t.name}),n.jsx(_,{basic:!0,color:"red",icon:"trash",onClick:o}),d()]})]}),onAddFile:t=>({name:t.name,content:t,type:t.type}),onClose:e.onClose,onSave:()=>(z("save")(),Promise.resolve()),showPageLoader:!1,strategy:"single"}));q.__docgenInfo={description:"",methods:[],displayName:"Default"};N.__docgenInfo={description:"",methods:[],displayName:"Errors"};L.__docgenInfo={description:"",methods:[],displayName:"Images"};E.__docgenInfo={description:"",methods:[],displayName:"SingleUpload"};var ne,oe,re;q.parameters={...q.parameters,docs:{...(ne=q.parameters)==null?void 0:ne.docs,source:{originalSource:`withWrapper(props => <FileUploadModal itemComponent={({
  item
}) => <Form.Input label='Name' value={item.name || ''} />} onAddFile={file => ({
  name: file.name,
  content: file,
  type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} />)`,...(re=(oe=q.parameters)==null?void 0:oe.docs)==null?void 0:re.source}}};var ae,se,ie;N.parameters={...N.parameters,docs:{...(ae=N.parameters)==null?void 0:ae.docs,source:{originalSource:`withWrapper(props => <FileUploadModal closeOnComplete={false} itemComponent={({
  item,
  isError,
  isRequired,
  onDelete,
  onTextInputChange
}) => <Item>
        <Item.Image src={URL.createObjectURL(item.content)} />
        <Item.Content>
          <Form.Input error={isError('name')} label='Name' onChange={onTextInputChange.bind(this, 'name')} required={isRequired('name')} value={item.name || ''} />
          <Button basic color='red' icon='trash' onClick={onDelete} />
        </Item.Content>
      </Item>} onAddFile={file => ({
  name: file.name,
  content: file,
  content_type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} required={{
  name: 'Name'
}} />)`,...(ie=(se=N.parameters)==null?void 0:se.docs)==null?void 0:ie.source}}};var le,ce,de;L.parameters={...L.parameters,docs:{...(le=L.parameters)==null?void 0:le.docs,source:{originalSource:`withWrapper(props => <FileUploadModal itemComponent={({
  item,
  onTextInputChange
}) => <Item>
        <Item.Image src={URL.createObjectURL(item.content)} />
        <Item.Content>
          <Form.Input label='Name' onChange={onTextInputChange.bind(this, 'name')} value={item.name} />
        </Item.Content>
      </Item>} onAddFile={file => ({
  name: file.name,
  content: file,
  type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} />)`,...(de=(ce=L.parameters)==null?void 0:ce.docs)==null?void 0:de.source}}};var me,pe,ue;E.parameters={...E.parameters,docs:{...(me=E.parameters)==null?void 0:me.docs,source:{originalSource:`withWrapper(props => <FileUploadModal closeOnComplete={false} itemComponent={({
  item,
  onDelete,
  onTextInputChange,
  renderStatus
}) => <Item>
        <Item.Image src={URL.createObjectURL(item.content)} />
        <Item.Content>
          <Form.Input label='Name' onChange={onTextInputChange.bind(this, 'name')} value={item.name} />
          <Button basic color='red' icon='trash' onClick={onDelete} />
          {renderStatus()}
        </Item.Content>
      </Item>} onAddFile={file => ({
  name: file.name,
  content: file,
  type: file.type
})} onClose={props.onClose} onSave={() => {
  action('save')();
  return Promise.resolve();
}} showPageLoader={false} strategy='single' />)`,...(ue=(pe=E.parameters)==null?void 0:pe.docs)==null?void 0:ue.source}}};const Xt=["Default","Errors","Images","SingleUpload"];export{q as Default,N as Errors,L as Images,E as SingleUpload,Xt as __namedExportsOrder,Qt as default};
