var C=Object.defineProperty;var k=(u,e,t)=>e in u?C(u,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[e]=t;var b=(u,e,t)=>(k(u,typeof e!="symbol"?e+"":e,t),t);import{j as a}from"./jsx-runtime-BTCK_S7S.js";import{b as D,o as x}from"./index.es28-Bd1vIgGd.js";import{r as j}from"./index-CBqU2yxZ.js";import{F as o,T as S}from"./Form-fErk-qk_.js";import{B as m}from"./Button-Blq7Z6RX.js";import{I as z}from"./Input--hQVCRQV.js";import{C as g}from"./Checkbox-C9uAfnsM.js";import{D as v}from"./Dropdown-Di2cPjwR.js";import{M as y}from"./Modal-Bz2VEyQG.js";import{_ as d}from"./index-default-C_maRo4o.js";import{i as s}from"./i18n-C8zWlANG.js";import{D as w}from"./DateInput-BO57_F9J.js";import{M as E}from"./ModalContext-Bu-D9kD-.js";const p=2,h=1,l=0,q=10,M=6;class f extends j.Component{constructor(e){super(e),this.state={...this.getInitialState(),calendar:new D(e.locale,e.calendar)}}componentDidMount(){this.initializeDate()}componentDidUpdate(e){(this.props.locale!==e.locale||this.props.calendar!==e.calendar)&&this.setState({calendar:new D(this.props.locale,this.props.calendar)}),this.props.date&&(this.props.date.startDate!==e.date.startDate||this.props.date.endDate!==e.date.endDate)&&this.initializeDate()}getDisplayDate(e){const t=this.state.calendar.convertToDate(e);return this.state.calendar.format(t,this.state.accuracy)}getInitialState(){return{accuracy:l,description:"",display:"",endDate:{},modal:!1,range:!1,startDate:{}}}initializeDate(){if(this.props.date){const{accuracy:e=l,description:t="",range:r=!1}=this.props.date;let n={},i={};this.props.date.startDate&&(n=this.state.calendar.parseDate(this.props.date.startDate)),this.props.date.endDate&&(i=this.state.calendar.parseDate(this.props.date.endDate)),this.setState({accuracy:e,description:t,range:r,startDate:n,endDate:i},this.setDisplay.bind(this))}else this.onAccuracyChange(null,{value:l})}onAccuracyChange(e,{value:t}){const r=t;this.setState(n=>{let i={...n.endDate},c={...n.startDate};return r===h?(i={...i,date:n.calendar.getDefaultDate()},c={...c,date:n.calendar.getDefaultDate()}):t===l&&(i={...i,date:n.calendar.getDefaultDate(),month:n.calendar.getDefaultMonth()},c={...c,date:n.calendar.getDefaultDate(),month:n.calendar.getDefaultMonth()}),{accuracy:r,endDate:i,startDate:c}},this.setEndDate.bind(this))}onClear(){this.setState(this.getInitialState(),this.onSave.bind(this))}onClose(){this.setState({modal:!1},this.initializeDate.bind(this))}onDateChange(e,t,{value:r}){this.setState(n=>({[e]:{...n[e],date:r}}),this.setEndDate.bind(this))}onDescriptionChange(e,{value:t}){this.setState({description:t})}onEdit(){this.setState({modal:!0})}onMonthChange(e,t,{value:r}){this.setState(n=>({[e]:{...n[e],month:r}}),this.setEndDate.bind(this))}onRangeChange(){this.setState(e=>({range:!e.range}),this.setEndDate.bind(this))}onSave(){this.setDisplay();let e,t;d.isEmpty(this.state.startDate)||(e=this.state.calendar.convertToDate(this.state.startDate).toDate()),d.isEmpty(this.state.endDate)||(t=this.state.calendar.convertToDate(this.state.endDate).toDate());const{accuracy:r,description:n,range:i}=this.state;this.props.onChange({accuracy:r,description:n,range:i,startDate:e,endDate:t}),this.setState({modal:!1})}onYearChange(e,t,{value:r}){r&&r.length>M||this.setState(n=>({[e]:{...n[e],year:parseInt(r,q)}}),this.setEndDate.bind(this))}render(){return a.jsxs(a.Fragment,{children:[a.jsx(w,{display:this.state.display,onClick:this.onEdit.bind(this),onChange:this.onClear.bind(this)}),a.jsx(E.Consumer,{children:e=>a.jsxs(y,{as:o,className:"fuzzy-date-modal",mountNode:e,open:this.state.modal,onClose:this.onClose.bind(this),children:[a.jsx(y.Header,{content:this.props.title||s.t("FuzzyDate.title")}),a.jsxs(y.Content,{children:[a.jsxs(o.Input,{className:"accuracy-container",label:s.t("FuzzyDate.labels.accuracy"),children:[a.jsx(g,{checked:this.state.accuracy===l,id:"accuracy-year",label:s.t("FuzzyDate.accuracy.year"),name:"accuracy",onChange:this.onAccuracyChange.bind(this),radio:!0,value:l}),a.jsx(g,{checked:this.state.accuracy===h,id:"accuracy-month",label:s.t("FuzzyDate.accuracy.month"),name:"accuracy",onChange:this.onAccuracyChange.bind(this),radio:!0,value:h}),a.jsx(g,{checked:this.state.accuracy===p,id:"accuracy-date",label:s.t("FuzzyDate.accuracy.date"),name:"accuracy",onChange:this.onAccuracyChange.bind(this),radio:!0,value:p})]}),a.jsxs(o.Group,{children:[this.renderYear("startDate"),this.renderMonth("startDate"),this.renderDate("startDate"),!this.state.range&&a.jsx("div",{className:"button-container",children:a.jsx(m,{basic:!0,content:s.t("FuzzyDate.buttons.addRange"),icon:"plus",onClick:this.onRangeChange.bind(this)})})]}),this.state.range&&a.jsxs(o.Group,{children:[this.renderYear("endDate"),this.renderMonth("endDate"),this.renderDate("endDate"),a.jsx("div",{className:"button-container",children:a.jsx(m,{basic:!0,content:s.t("FuzzyDate.buttons.removeRange"),icon:"times",onClick:this.onRangeChange.bind(this)})})]}),this.props.description&&a.jsx(o.Input,{id:"description",label:s.t("FuzzyDate.labels.description"),children:a.jsx(S,{id:"description",onChange:this.onDescriptionChange.bind(this),value:this.state.description})})]}),a.jsxs(y.Actions,{children:[a.jsx(m,{onClick:this.onSave.bind(this),primary:!0,size:"medium",type:"submit",children:s.t("Common.buttons.save")}),a.jsx(m,{basic:!0,onClick:this.onClose.bind(this),size:"medium",type:"button",children:s.t("Common.buttons.cancel")})]})]})})]})}renderDate(e){if(this.state.accuracy!==p)return null;const t=this.state[e],r=this.state.calendar.daysInMonth(t.year,t.month);return a.jsx(o.Input,{id:"date-dropdown",label:s.t("FuzzyDate.labels.date"),children:a.jsx(v,{id:"date-dropdown",onChange:this.onDateChange.bind(this,e),options:d.range(1,r+1).map(n=>({key:n,value:n,text:n})),selection:!0,value:t.date||this.state.calendar.getDefaultDate()})})}renderMonth(e){return this.state.accuracy!==p&&this.state.accuracy!==h?null:a.jsx(o.Input,{id:"month-dropdown",label:s.t("FuzzyDate.labels.month"),children:a.jsx(v,{id:"month-dropdown",onChange:this.onMonthChange.bind(this,e),options:d.map(this.state.calendar.listMonths(),(t,r)=>({key:r,value:r,text:t})),selection:!0,value:this.state[e].month||this.state.calendar.getDefaultMonth()})})}renderYear(e){return a.jsx(o.Input,{id:"year",label:s.t("FuzzyDate.labels.year"),children:a.jsx(z,{id:"year",onChange:this.onYearChange.bind(this,e),type:"number",value:this.state[e].year||""})})}setDisplay(){const e=[];this.state.startDate&&!d.isEmpty(this.state.startDate)&&e.push(this.getDisplayDate(this.state.startDate)),this.state.range&&this.state.endDate&&!d.isEmpty(this.state.endDate)&&(e.push(" - "),e.push(this.getDisplayDate(this.state.endDate))),this.setState({display:e.join(" ")})}setEndDate(){this.state.range||!this.state.startDate||d.isEmpty(this.state.startDate)||this.setState(e=>{let t=e.calendar.convertToDate(e.startDate);return e.accuracy===l?t=e.calendar.addYear(t,1):e.accuracy===h?t=e.calendar.addMonth(t,1):e.accuracy===p&&(t=e.calendar.addDate(t,1)),{endDate:e.calendar.parseDate(t)}})}}b(f,"defaultProps");f.defaultProps={calendar:D.Calendars.gregorian,description:!0,locale:x.isBrowser()&&navigator.language,title:void 0};f.__docgenInfo={description:"",methods:[{name:"getDisplayDate",docblock:`Returns the display string for the passed date component.

@param dateComponent

@returns {*}`,modifiers:[],params:[{name:"dateComponent",optional:!1,type:{name:"signature",type:"object",raw:`{
  date: number,
  month: number,
  year: number
}`,signature:{properties:[{key:"date",value:{name:"number",required:!0}},{key:"month",value:{name:"number",required:!0}},{key:"year",value:{name:"number",required:!0}}]},alias:"DateComponent"}}],returns:{type:{name:"mixed"}},description:"Returns the display string for the passed date component."},{name:"initializeDate",docblock:"Initializes the date.",modifiers:[],params:[],returns:null,description:"Initializes the date."},{name:"onAccuracyChange",docblock:`Sets the accuracy value on the state. The start and end date values are also adjusted based on the accuracy.

@param e
@param value`,modifiers:[],params:[{name:"e",optional:!1,type:{name:"Event",nullable:!0}},{name:"{ value }: { value: number }",optional:!1,type:{name:"signature",type:"object",raw:"{ value: number }",signature:{properties:[{key:"value",value:{name:"number",required:!0}}]}}}],returns:null,description:"Sets the accuracy value on the state. The start and end date values are also adjusted based on the accuracy."},{name:"onClear",docblock:"Clears the input date(s).",modifiers:[],params:[],returns:null,description:"Clears the input date(s)."},{name:"onClose",docblock:"Closes the edit modal.",modifiers:[],params:[],returns:null,description:"Closes the edit modal."},{name:"onDateChange",docblock:`Sets the date value on the state.

@param property
@param e
@param value`,modifiers:[],params:[{name:"property",optional:!1,type:{name:"string"}},{name:"e",optional:!1,type:{name:"Event",nullable:!0}},{name:"{ value }: { value: string }",optional:!1,type:{name:"signature",type:"object",raw:"{ value: string }",signature:{properties:[{key:"value",value:{name:"string",required:!0}}]}}}],returns:null,description:"Sets the date value on the state."},{name:"onDescriptionChange",docblock:`Sets the date description on the state.

@param e
@param value`,modifiers:[],params:[{name:"e",optional:!1,type:{name:"Event",alias:"Event"}},{name:"{ value }: { value: string }",optional:!1,type:{name:"signature",type:"object",raw:"{ value: string }",signature:{properties:[{key:"value",value:{name:"string",required:!0}}]}}}],returns:null,description:"Sets the date description on the state."},{name:"onEdit",docblock:"Opens the edit modal.",modifiers:[],params:[],returns:null,description:"Opens the edit modal."},{name:"onMonthChange",docblock:`Sets the month value on the state.

@param property
@param e
@param value`,modifiers:[],params:[{name:"property",optional:!1,type:{name:"string"}},{name:"e",optional:!1,type:{name:"Event",nullable:!0}},{name:"{ value }: { value: string }",optional:!1,type:{name:"signature",type:"object",raw:"{ value: string }",signature:{properties:[{key:"value",value:{name:"string",required:!0}}]}}}],returns:null,description:"Sets the month value on the state."},{name:"onRangeChange",docblock:"Sets the range value on the set.",modifiers:[],params:[],returns:null,description:"Sets the range value on the set."},{name:"onSave",docblock:"Sets the display value and closes the edit modal.",modifiers:[],params:[],returns:null,description:"Sets the display value and closes the edit modal."},{name:"onYearChange",docblock:`Sets the year value on the state.

@param property
@param e
@param value`,modifiers:[],params:[{name:"property",optional:!1,type:{name:"string"}},{name:"e",optional:!1,type:{name:"Event",nullable:!0}},{name:"{ value }: { value: string }",optional:!1,type:{name:"signature",type:"object",raw:"{ value: string }",signature:{properties:[{key:"value",value:{name:"string",required:!0}}]}}}],returns:null,description:"Sets the year value on the state."},{name:"renderDate",docblock:`Renders the date dropdown for the passed property.

@param property

@returns {null|*}`,modifiers:[],params:[{name:"property",optional:!1,type:{name:"string"}}],returns:{type:{name:"union",elements:[{name:"mixed"}]}},description:"Renders the date dropdown for the passed property."},{name:"renderMonth",docblock:`Renders the month dropdown for the passed property.

@param property

@returns {null|*}`,modifiers:[],params:[{name:"property",optional:!1,type:{name:"string"}}],returns:{type:{name:"union",elements:[{name:"mixed"}]}},description:"Renders the month dropdown for the passed property."},{name:"renderYear",docblock:`Renders the year dropdown for the passed property.

@param property

@returns {*}`,modifiers:[],params:[{name:"property",optional:!1,type:{name:"string"}}],returns:{type:{name:"mixed"}},description:"Renders the year dropdown for the passed property."},{name:"setDisplay",docblock:"Sets the display value.",modifiers:[],params:[],returns:null,description:"Sets the display value."},{name:"setEndDate",docblock:"Sets the end date value.",modifiers:[],params:[],returns:null,description:"Sets the end date value."}],displayName:"FuzzyDate",props:{calendar:{required:!1,flowType:{name:"string"},description:"",defaultValue:{value:"Calendar.Calendars.gregorian",computed:!0}},date:{required:!0,flowType:{name:"signature",type:"object",raw:`{
  accuracy: number,
  description: string,
  endDate: string,
  range: boolean,
  startDate: string
}`,signature:{properties:[{key:"accuracy",value:{name:"number",required:!0}},{key:"description",value:{name:"string",required:!0}},{key:"endDate",value:{name:"string",required:!0}},{key:"range",value:{name:"boolean",required:!0}},{key:"startDate",value:{name:"string",required:!0}}]}},description:""},description:{required:!1,flowType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},locale:{required:!1,flowType:{name:"string"},description:"",defaultValue:{value:"Browser.isBrowser() && navigator.language",computed:!1}},onChange:{required:!0,flowType:{name:"signature",type:"function",raw:"(data: DateOutput) => void",signature:{arguments:[{name:"data",type:{name:"signature",type:"object",raw:`{
  accuracy: number,
  description: string,
  endDate?: Date,
  range: boolean,
  startDate?: Date
}`,signature:{properties:[{key:"accuracy",value:{name:"number",required:!0}},{key:"description",value:{name:"string",required:!0}},{key:"endDate",value:{name:"Date",required:!1}},{key:"range",value:{name:"boolean",required:!0}},{key:"startDate",value:{name:"Date",required:!1}}]}}}],return:{name:"void"}}},description:""},title:{required:!1,flowType:{name:"string"},description:"",defaultValue:{value:"undefined",computed:!0}}}};export{f as F};
