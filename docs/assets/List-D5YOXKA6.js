import{r as h,j as e}from"./iframe-isOIMYbo.js";import{C as E}from"./Confirm-C5nQeKJC.js";import{P}from"./Pagination-BI5_XWxA.js";import{G as y}from"./Grid-DcCEaZI6.js";import{M as f}from"./Menu-BQbSIL22.js";import{B as g}from"./Button-CqXa-wVP.js";import{H as x}from"./Header-Bf1YOTBY.js";import{I as C}from"./Icon-DBxUlxMw.js";import{_ as u}from"./index-default-C0I3bBxV.js";import{i as l}from"./i18n-DkobdbHY.js";import{D as B}from"./DropdownButton-DJYIR63r.js";import{E as A}from"./EditModal-Kh6oP6Ht.js";import{L as w}from"./Label-vg6cGd_Q.js";import{o as D}from"./index.es28-DwD6OMJQ.js";import{F as L}from"./Form-BaAofpBB.js";import{I as N}from"./Input-kw8FuSsH.js";import{C as Q}from"./Checkbox-DzQdh1Bw.js";import{D as S}from"./Dropdown-D3HCXA6v.js";import{M as j}from"./Modal-BXLzsD-x.js";import{A as T}from"./AssociatedDropdown-DbTVcUSS.js";import{F as M}from"./FuzzyDate-9fisvRND.js";import{T as I}from"./Trans-FXWN6mRC.js";const c={boolean:"boolean",date:"date",integer:"integer",relationship:"relationship",select:"select",string:"string",text:"text"},a={equal:"equal",notEqual:"not_equal",contain:"contain",notContain:"not_contain",empty:"empty",notEmpty:"not_empty",greaterThan:"greater_than",lessThan:"less_than"},F=[{key:a.equal,value:a.equal,text:l.t("ListFilters.operators.equal")},{key:a.notEqual,value:a.notEqual,text:l.t("ListFilters.operators.notEqual")},{key:a.contain,value:a.contain,text:l.t("ListFilters.operators.contain")},{key:a.notContain,value:a.notContain,text:l.t("ListFilters.operators.notContain")},{key:a.empty,value:a.empty,text:l.t("ListFilters.operators.empty")},{key:a.notEmpty,value:a.notEmpty,text:l.t("ListFilters.operators.notEmpty")},{key:a.greaterThan,value:a.greaterThan,text:l.t("ListFilters.operators.greaterThan")},{key:a.lessThan,value:a.lessThan,text:l.t("ListFilters.operators.lessThan")}],_={[c.boolean]:[a.equal],[c.date]:[a.equal],[c.relationship]:[a.equal,a.notEqual,a.empty,a.notEmpty],[c.select]:[a.equal,a.notEqual,a.empty,a.notEmpty],[c.string]:[a.equal,a.notEqual,a.contain,a.notContain,a.empty,a.notEmpty],[c.text]:[a.contain,a.notContain,a.empty,a.notEmpty]},R=o=>{const n=h.useCallback(r=>{const s=_[r];return u.filter(F,d=>!s||u.contains(s,d.key))},[]),t=r=>r.label,i=h.useCallback(r=>{if(r.operator===a.empty||r.operator===a.notEmpty)return null;if(r.type===c.boolean)return e.jsx(Q,{onChange:()=>o.onSaveChildAssociation("filters",{...r,value:!r.value}),checked:r.value});if(r.type===c.string||r.type===c.text||r.type===c.integer)return e.jsx(N,{onChange:(s,{value:d})=>o.onSaveChildAssociation("filters",{...r,value:d}),value:r.value});if(r.type===c.date)return e.jsx(M,{date:r.value||{},description:!1,onChange:s=>{o.onSaveChildAssociation("filters",{...r,value:s})},title:r.label});if(r.type===c.select)return e.jsx(S,{onChange:(s,{value:d})=>o.onSaveChildAssociation("filters",{...r,value:d}),options:r.options,selectOnBlur:!1,selection:!0,value:r.value});if(r.type===c.relationship){const{collectionName:s,onSearch:d,renderOption:p,renderSearchQuery:k,searchQuery:v,value:b}=r;return s&&d&&p?e.jsx(T,{collectionName:s,onSearch:d,onSelection:q=>{o.onSaveChildAssociation("filters",{...r,searchQuery:k&&k(q),value:q.id})},renderOption:p,required:!0,searchQuery:v||"",value:b||null}):null}return null},[o.item.filters,o.onSaveChildAssociation]),m=h.useMemo(()=>u.sortBy(o.filters,o.item.onSort||t),[o.filters,o.item.onSort]);return h.useEffect(()=>{u.each(o.item.filters,r=>{const s=u.findWhere(o.filters,{key:r.key});r.type===c.boolean&&(s.value=!1),o.onSaveChildAssociation("filters",u.defaults(r,s))})},[]),e.jsx(D.Consumer,{children:r=>e.jsxs(j,{as:L,centered:!1,className:"list-filters-modal",mountNode:r,noValidate:!0,open:!0,size:"small",children:[e.jsx(j.Header,{children:e.jsxs(y,{columns:2,children:[e.jsx(y.Column,{verticalAlign:"middle",children:e.jsx(x,{content:l.t("ListFilters.title")})}),e.jsxs(y.Column,{textAlign:"right",children:[e.jsx(B,{color:"green",icon:"plus",options:u.map(m,s=>({key:s.key,value:s.key,text:s.label})),onChange:(s,{value:d})=>{const p=u.findWhere(o.filters,{key:d});o.onSaveChildAssociation("filters",o.onCreateFilter({...p,operator:a.equal}))},scrolling:!0,text:l.t("ListFilters.buttons.add"),value:""}),e.jsx(g,{color:"red",content:l.t("ListFilters.buttons.reset"),icon:"repeat",onClick:()=>o.onReset(),style:{marginLeft:"1em"}})]})]})}),e.jsx(j.Content,{children:!u.isEmpty(o.item.filters)&&e.jsx(y,{children:u.map(o.item.filters,s=>e.jsxs(y.Row,{columns:4,verticalAlign:"middle",children:[e.jsx(y.Column,{children:e.jsx(x,{content:s.label})}),e.jsx(y.Column,{width:5,children:e.jsx(S,{options:n(s.type),onChange:(d,{value:p})=>o.onSaveChildAssociation("filters",{...u.omit(s,"value"),operator:p}),selection:!0,value:s.operator})}),e.jsx(y.Column,{width:5,children:i(s)}),e.jsx(y.Column,{width:1,children:e.jsx(g,{basic:!0,icon:"times",onClick:()=>o.onDeleteChildAssociation("filters",s)})})]},s.key))})}),o.children]})})};R.__docgenInfo={description:"",methods:[],displayName:"ListFilters",props:{filters:{required:!0,flowType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  collectionName?: 'string',
  key: string,
  label: string,
  onSearch?: (search: string) => Promise<any>,
  operator: ?string,
  options?: Array<Option>,
  renderOption?: (item: any) => Option,
  renderSearchQuery?: (item: any) => Element<any> | string,
  searchQuery?: string,
  type: string,
  value: ?any
}`,signature:{properties:[{key:"collectionName",value:{name:"literal",value:"'string'",required:!1}},{key:"key",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"onSearch",value:{name:"signature",type:"function",raw:"(search: string) => Promise<any>",signature:{arguments:[{name:"search",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}},required:!1}},{key:"operator",value:{name:"string",nullable:!0,required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}],raw:"Array<Option>",required:!1}},{key:"renderOption",value:{name:"signature",type:"function",raw:"(item: any) => Option",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}},required:!1}},{key:"renderSearchQuery",value:{name:"signature",type:"function",raw:"(item: any) => Element<any> | string",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"union",raw:"Element<any> | string",elements:[{name:"Element",elements:[{name:"any"}],raw:"Element<any>"},{name:"string"}]}},required:!1}},{key:"searchQuery",value:{name:"string",required:!1}},{key:"type",value:{name:"string",required:!0}},{key:"value",value:{name:"any",nullable:!0,required:!0}}]}}],raw:"Array<Filter>"},description:""},item:{required:!0,flowType:{name:"signature",type:"object",raw:`{
  filters: Array<Filter>,
  onSort: (filter: Filter) => any
}`,signature:{properties:[{key:"filters",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  collectionName?: 'string',
  key: string,
  label: string,
  onSearch?: (search: string) => Promise<any>,
  operator: ?string,
  options?: Array<Option>,
  renderOption?: (item: any) => Option,
  renderSearchQuery?: (item: any) => Element<any> | string,
  searchQuery?: string,
  type: string,
  value: ?any
}`,signature:{properties:[{key:"collectionName",value:{name:"literal",value:"'string'",required:!1}},{key:"key",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"onSearch",value:{name:"signature",type:"function",raw:"(search: string) => Promise<any>",signature:{arguments:[{name:"search",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}},required:!1}},{key:"operator",value:{name:"string",nullable:!0,required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}],raw:"Array<Option>",required:!1}},{key:"renderOption",value:{name:"signature",type:"function",raw:"(item: any) => Option",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}},required:!1}},{key:"renderSearchQuery",value:{name:"signature",type:"function",raw:"(item: any) => Element<any> | string",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"union",raw:"Element<any> | string",elements:[{name:"Element",elements:[{name:"any"}],raw:"Element<any>"},{name:"string"}]}},required:!1}},{key:"searchQuery",value:{name:"string",required:!1}},{key:"type",value:{name:"string",required:!0}},{key:"value",value:{name:"any",nullable:!0,required:!0}}]}}],raw:"Array<Filter>",required:!0}},{key:"onSort",value:{name:"signature",type:"function",raw:"(filter: Filter) => any",signature:{arguments:[{name:"filter",type:{name:"signature",type:"object",raw:`{
  collectionName?: 'string',
  key: string,
  label: string,
  onSearch?: (search: string) => Promise<any>,
  operator: ?string,
  options?: Array<Option>,
  renderOption?: (item: any) => Option,
  renderSearchQuery?: (item: any) => Element<any> | string,
  searchQuery?: string,
  type: string,
  value: ?any
}`,signature:{properties:[{key:"collectionName",value:{name:"literal",value:"'string'",required:!1}},{key:"key",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"onSearch",value:{name:"signature",type:"function",raw:"(search: string) => Promise<any>",signature:{arguments:[{name:"search",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}},required:!1}},{key:"operator",value:{name:"string",nullable:!0,required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}],raw:"Array<Option>",required:!1}},{key:"renderOption",value:{name:"signature",type:"function",raw:"(item: any) => Option",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}},required:!1}},{key:"renderSearchQuery",value:{name:"signature",type:"function",raw:"(item: any) => Element<any> | string",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"union",raw:"Element<any> | string",elements:[{name:"Element",elements:[{name:"any"}],raw:"Element<any>"},{name:"string"}]}},required:!1}},{key:"searchQuery",value:{name:"string",required:!1}},{key:"type",value:{name:"string",required:!0}},{key:"value",value:{name:"any",nullable:!0,required:!0}}]}}}],return:{name:"any"}},required:!0}}]}},description:""},onCreateFilter:{required:!0,flowType:{name:"signature",type:"function",raw:"(filter: Filter) => any",signature:{arguments:[{name:"filter",type:{name:"signature",type:"object",raw:`{
  collectionName?: 'string',
  key: string,
  label: string,
  onSearch?: (search: string) => Promise<any>,
  operator: ?string,
  options?: Array<Option>,
  renderOption?: (item: any) => Option,
  renderSearchQuery?: (item: any) => Element<any> | string,
  searchQuery?: string,
  type: string,
  value: ?any
}`,signature:{properties:[{key:"collectionName",value:{name:"literal",value:"'string'",required:!1}},{key:"key",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"onSearch",value:{name:"signature",type:"function",raw:"(search: string) => Promise<any>",signature:{arguments:[{name:"search",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}},required:!1}},{key:"operator",value:{name:"string",nullable:!0,required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}],raw:"Array<Option>",required:!1}},{key:"renderOption",value:{name:"signature",type:"function",raw:"(item: any) => Option",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}},required:!1}},{key:"renderSearchQuery",value:{name:"signature",type:"function",raw:"(item: any) => Element<any> | string",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"union",raw:"Element<any> | string",elements:[{name:"Element",elements:[{name:"any"}],raw:"Element<any>"},{name:"string"}]}},required:!1}},{key:"searchQuery",value:{name:"string",required:!1}},{key:"type",value:{name:"string",required:!0}},{key:"value",value:{name:"any",nullable:!0,required:!0}}]}}}],return:{name:"any"}}},description:""}}};const O=o=>{const n=h.useCallback(t=>{const i=[t.label],m=u.findWhere(F,{key:t.operator});return m&&i.push(m.text),t.value&&i.push(`"${t.value}"`),i.join(" ")},[]);return e.jsxs(w.Group,{className:"filter-labels",children:[u.map(o.filters,t=>e.jsx(w,{basic:!0,content:n(t),onRemove:()=>o.onClick(t)})),o.onClear&&e.jsx(w,{as:g,color:"red",content:l.t("FilterLabels.buttons.clear"),icon:"times",onClick:o.onClear})]})};O.__docgenInfo={description:"",methods:[],displayName:"FilterLabels",props:{filters:{required:!0,flowType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  collectionName?: 'string',
  key: string,
  label: string,
  onSearch?: (search: string) => Promise<any>,
  operator: ?string,
  options?: Array<Option>,
  renderOption?: (item: any) => Option,
  renderSearchQuery?: (item: any) => Element<any> | string,
  searchQuery?: string,
  type: string,
  value: ?any
}`,signature:{properties:[{key:"collectionName",value:{name:"literal",value:"'string'",required:!1}},{key:"key",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"onSearch",value:{name:"signature",type:"function",raw:"(search: string) => Promise<any>",signature:{arguments:[{name:"search",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}},required:!1}},{key:"operator",value:{name:"string",nullable:!0,required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}],raw:"Array<Option>",required:!1}},{key:"renderOption",value:{name:"signature",type:"function",raw:"(item: any) => Option",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}},required:!1}},{key:"renderSearchQuery",value:{name:"signature",type:"function",raw:"(item: any) => Element<any> | string",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"union",raw:"Element<any> | string",elements:[{name:"Element",elements:[{name:"any"}],raw:"Element<any>"},{name:"string"}]}},required:!1}},{key:"searchQuery",value:{name:"string",required:!1}},{key:"type",value:{name:"string",required:!0}},{key:"value",value:{name:"any",nullable:!0,required:!0}}]}}],raw:"Array<Filter>"},description:""},onClear:{required:!1,flowType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onClick:{required:!0,flowType:{name:"signature",type:"function",raw:"(filter: Filter) => void",signature:{arguments:[{name:"filter",type:{name:"signature",type:"object",raw:`{
  collectionName?: 'string',
  key: string,
  label: string,
  onSearch?: (search: string) => Promise<any>,
  operator: ?string,
  options?: Array<Option>,
  renderOption?: (item: any) => Option,
  renderSearchQuery?: (item: any) => Element<any> | string,
  searchQuery?: string,
  type: string,
  value: ?any
}`,signature:{properties:[{key:"collectionName",value:{name:"literal",value:"'string'",required:!1}},{key:"key",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"onSearch",value:{name:"signature",type:"function",raw:"(search: string) => Promise<any>",signature:{arguments:[{name:"search",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}},required:!1}},{key:"operator",value:{name:"string",nullable:!0,required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}],raw:"Array<Option>",required:!1}},{key:"renderOption",value:{name:"signature",type:"function",raw:"(item: any) => Option",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"signature",type:"object",raw:`{
  key: string | number,
  icon?: string,
  text: string,
  value: any
}`,signature:{properties:[{key:"key",value:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}],required:!0}},{key:"icon",value:{name:"string",required:!1}},{key:"text",value:{name:"string",required:!0}},{key:"value",value:{name:"any",required:!0}}]}}},required:!1}},{key:"renderSearchQuery",value:{name:"signature",type:"function",raw:"(item: any) => Element<any> | string",signature:{arguments:[{name:"item",type:{name:"any"}}],return:{name:"union",raw:"Element<any> | string",elements:[{name:"Element",elements:[{name:"any"}],raw:"Element<any>"},{name:"string"}]}},required:!1}},{key:"searchQuery",value:{name:"string",required:!1}},{key:"type",value:{name:"string",required:!0}},{key:"value",value:{name:"any",nullable:!0,required:!0}}]}}}],return:{name:"void"}}},description:""}}};const $="add",H="csv-export",z="delete-all",ce=o=>class extends h.Component{static defaultProps={actions:[],addButton:{basic:!0,color:"green",location:"top"},buttons:[],className:"",csvExportButton:void 0,filters:void 0,modal:void 0,page:1,pages:1,onColumnClick:()=>{},onCopy:void 0,onPageChange:()=>{},renderDeleteModal:void 0,renderSearch:void 0,sortColumn:void 0,sortDirection:void 0};constructor(n){super(n),this.state={modalDelete:!1,modalDeleteAll:!1,modalEdit:!1,modalFilter:!1,selectedItem:null}}getButtons(n){const t=[],{addButton:i={},csvExportButton:m={},deleteButton:r={},modal:s}=this.props;return i.location===n&&(i.onClick||s)&&t.push({render:this.renderAddButton.bind(this)}),r.location===n&&this.props.onDeleteAll&&t.push({render:this.renderDeleteAllButton.bind(this)}),m.location===n&&t.push({render:this.renderCsvExportButton.bind(this)}),t.push(...u.filter(this.props.buttons,d=>{let p=!1;return((d.location||"top")===n||!d.location&&i&&i.location===n)&&(p=!0),p})),t}onAddButton(){return this.props.addButton&&this.props.addButton.onClick?this.props.addButton.onClick():this.setState({modalEdit:!0})}onCopyButton(n){const t=this.props.onCopy?this.props.onCopy(n):u.omit(n,"id","uid");this.setState({selectedItem:t,modalEdit:!0})}onCsvExportButton(){const n=u.filter(this.props.columns,m=>!m.hidden);let t=`${u.map(n,m=>`"${m.label}"`).join(",")}
`;u.each(this.props.items,m=>{t=t.concat(`${n.map(r=>r.resolve?`"${r.resolve(m)}"`:m[r.name]?`"${m[r.name]}"`:"").join(",")}
`)});const i=document.createElement("a");i.setAttribute("href",`data:text/plain;charset=utf-8,${encodeURIComponent(t)}`),i.setAttribute("download",`${this.props.collectionName||"table"}.csv`),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}onDelete(){const{selectedItem:n}=this.state;return this.setState({selectedItem:null,modalDelete:!1}),this.props.onDelete(n)}onDeleteAll(){return this.setState({modalDeleteAll:!1}),this.props.onDeleteAll&&this.props.onDeleteAll()}onDeleteAllButton(){this.setState({modalDeleteAll:!0})}onDeleteButton(n){this.setState({selectedItem:n,modalDelete:!0})}onEditButton(n){this.setState({selectedItem:n,modalEdit:!0})}onFilterButton(){this.setState({modalFilter:!0})}onRemoveFilter(n){const{onChange:t,props:{item:i}}=this.props.filters;return t({filters:u.filter(i.filters,m=>m.uid!==n.uid)})}onSave(n){return this.props.onSave(n).then(()=>this.setState({modalEdit:!1,selectedItem:null}))}onSaveFilter(n){return this.props.filters?this.props.filters.onChange(n).then(()=>this.setState({modalFilter:!1})):null}render(){return e.jsxs("div",{className:`list ${this.props.className}`,children:[this.renderHeader(),e.jsx(o,{...this.props,actions:this.getActions(),renderEmptyMessage:this.renderEmptyMessage.bind(this)}),this.renderFooter(),this.renderEditModal(),this.renderDeleteModal(),this.renderDeleteAllModal(),this.renderFilterModal()]})}getActions(){return u.map(this.props.actions,n=>{let t={};return n.name==="edit"?t={icon:"edit outline",onClick:this.onEditButton.bind(this),popup:{title:l.t("Common.actions.edit.title"),content:l.t("Common.actions.edit.content")}}:n.name==="copy"?t={icon:"copy outline",onClick:this.onCopyButton.bind(this),popup:{title:l.t("Common.actions.copy.title"),content:l.t("Common.actions.copy.content")}}:n.name==="delete"&&(t={icon:"times circle outline",onClick:this.onDeleteButton.bind(this),popup:{title:l.t("Common.actions.delete.title"),content:l.t("Common.actions.delete.content")}}),u.defaults(n,t)})}renderAddButton(){return this.props.addButton?e.jsxs(g,{basic:this.props.addButton.basic!==!1,color:this.props.addButton.color,inverted:this.props.addButton.inverted,onClick:this.onAddButton.bind(this),secondary:this.props.addButton.secondary,children:[e.jsx(C,{name:"plus"}),this.props.addButton.content||l.t("List.buttons.add")]},$):null}renderButton(n,t){return n.render?n.render(t):n.accept&&!n.accept()?null:e.jsx(g,{...u.omit(n,"accept")},t)}renderCsvExportButton(){return this.props.csvExportButton?e.jsxs(g,{basic:this.props.csvExportButton.basic,color:this.props.csvExportButton.color,onClick:this.onCsvExportButton.bind(this),children:[e.jsx(C,{name:"download"}),l.t("List.buttons.csvExport")]},H):null}renderDeleteAllButton(){return this.props.deleteButton?e.jsxs(g,{basic:!0,color:this.props.deleteButton.color,onClick:this.onDeleteAllButton.bind(this),children:[e.jsx(C,{name:"times"}),l.t("List.buttons.deleteAll")]},z):null}renderDeleteAllModal(){return this.state.modalDeleteAll?e.jsx(E,{content:l.t("List.deleteAllContent"),header:e.jsx(x,{icon:"trash alternate outline",content:l.t("List.deleteAllHeader")}),onCancel:()=>this.setState({modalDeleteAll:!1}),onConfirm:this.onDeleteAll.bind(this),open:!0}):null}renderDeleteModal(){if(!this.state.modalDelete)return null;const{selectedItem:n}=this.state,t=()=>this.setState({selectedItem:null,modalDelete:!1}),i=this.onDelete.bind(this);return this.props.renderDeleteModal?this.props.renderDeleteModal({selectedItem:n,onConfirm:i,onCancel:t}):e.jsx(E,{content:l.t("List.deleteContent"),header:e.jsx(x,{icon:"trash alternate outline",content:l.t("List.deleteHeader")}),onCancel:t,onConfirm:i,open:!0})}renderEditModal(){if(!this.props.modal||!this.state.modalEdit)return null;const{component:n,props:t}=this.props.modal;return e.jsx(A,{component:n,onClose:()=>this.setState({selectedItem:null,modalEdit:!1}),onSave:this.onSave.bind(this),item:this.state.selectedItem,...t})}renderEmptyMessage(){const{addButton:n={},modal:t}=this.props;return n.onClick||t?e.jsxs(I,{i18nKey:"List.emptyListAdd",children:["You haven't added any yet. Click",e.jsx("div",{className:"empty-button",children:this.renderAddButton()}),"to get started."]}):l.t("List.emptyList")}renderFilterButton(){return this.props.filters&&this.props.filters.component?e.jsx(g,{active:this.props.filters.active,"aria-label":"Filter",basic:!0,icon:"filter",onClick:this.onFilterButton.bind(this)}):null}renderFilterModal(){if(!this.props.filters||!this.state.modalFilter)return null;const{component:n,props:t}=this.props.filters;return e.jsx(A,{...t,component:n,onClose:()=>this.setState({modalFilter:!1}),onSave:this.onSaveFilter.bind(this)})}renderFooter(){let n=!1;const t=this.getButtons("bottom");t&&t.length&&(n=!0);const i=this.props.pages&&this.props.pages>1;i&&(n=!0);const m=this.props.count&&this.props.showRecordCount;return m&&(n=!0),n?e.jsx("div",{className:"footer",children:e.jsxs(y,{columns:2,children:[e.jsxs(y.Column,{textAlign:"left",children:[m?this.renderRecordCount():"",u.map(t,(r,s)=>r.render(s))]}),e.jsx(y.Column,{textAlign:"right",children:i?this.renderPagination():""})]})}):null}renderHeader(){let n=!1;const t=this.getButtons("top");t&&t.length&&(n=!0);const{filters:i,perPageOptions:m,renderListHeader:r,renderSearch:s,searchable:d}=this.props,p=i&&i.component,k=d&&s,v=r&&r();(p||m||v||k)&&(n=!0);const b=i&&i.showLabels&&!u.isEmpty(i.props.item.filters);return n?e.jsx("div",{className:"header",children:e.jsxs(y,{className:b?"filter-labels":void 0,verticalAlign:"top",children:[e.jsxs(y.Row,{columns:2,children:[e.jsx(y.Column,{textAlign:"left",children:u.map(t,this.renderButton.bind(this))}),e.jsx(y.Column,{textAlign:"right",children:e.jsxs(f,{compact:!0,borderless:!0,secondary:!0,className:"flex-end-menu",children:[v&&e.jsx(f.Menu,{className:"list-header-menu",children:v}),e.jsx(f.Menu,{children:i&&this.renderFilterButton()}),m&&e.jsx(f.Menu,{className:"per-page-menu",children:this.renderPerPage()}),e.jsx(f.Menu,{children:s&&s()})]})})]}),b&&e.jsx(y.Row,{columns:1,children:e.jsx(y.Column,{children:e.jsx(O,{filters:i.props.item.filters,onClear:()=>i.onChange({filters:[]}),onClick:q=>this.onRemoveFilter(q)})})})]})}):null}renderPagination(){return e.jsx(P,{activePage:this.props.page,firstItem:null,lastItem:null,onPageChange:this.props.onPageChange.bind(this),size:"mini",totalPages:this.props.pages})}renderPerPage(){const{perPage:n}=this.props;return e.jsx(B,{basic:!0,icon:"list",onChange:this.props.onPerPageChange.bind(this),options:u.map(this.props.perPageOptions,t=>({key:t,value:t,text:t})),text:l.t("List.labels.perPage",{perPage:n}),value:n})}renderRecordCount(){const{count:n}=this.props;return e.jsx("p",{className:"record-count",children:`${Number(n).toLocaleString()} ${l.t("List.record",{count:n})}`})}};export{c as F,R as L,a,ce as u};
